
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Global Chat</title>
  <style>

/* Base Reset & Typography */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}
html, body {
    overflow: hidden;
    height: 100%;
    width: 100%;
}

:root {
    --primary-color: #626262;
    --primary-light: #f0f0f0;
    --primary-dark: #3a3a3a;
    --text-primary: #333;
    --text-secondary: #666;
    --background-light: #f9f9f9;
    --background-white: #ffffff;
    --border-light: #e0e0e0;
    --border-radius-sm: 8px;
    --border-radius-md: 16px;
    --border-radius-lg: 24px;
    --transition-speed: 0.25s;
    --box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    --luxury-gradient: linear-gradient(
        135deg,  
        #0f0f0f 0%,  
        #1c1c1c 15%,  
        #3a3a3a 30%,  
        #4d4d4d 45%,  
        #626262 60%,  
        #787878 75%,  
        #8f8f8f 90%,  
        #a6a6a6 100%
    );
    --border-color: #dadada;
}

/* Prevent scrolling while maintaining accessibility */
html, body {
    overflow: hidden;
    height: 100%;
    font-size: 16px;
    color: var(--text-primary);
}

body {
    display: flex;
    flex-direction: column;
    background-color: var(--background-light);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='360' height='360' viewBox='0 0 360 360'%3E%3Cpath fill='%239C92AC' fill-opacity='0.4' d='M0 85.02l4.62-4.27a49.09 49.09 0 0 0 7.33 3.74l-1.2 10.24 2.66.87 5.05-9c2.62.65 5.34 1.08 8.12 1.28L28.6 98h2.8l2.02-10.12c2.74-.2 5.46-.62 8.12-1.28l5.05 8.99 2.66-.86-1.2-10.24c2.55-1.03 5-2.29 7.33-3.74l7.58 7 2.26-1.65-4.3-9.38a48.3 48.3 0 0 0 5.8-5.8l9.38 4.3 1.65-2.26-7-7.58a49.09 49.09 0 0 0 3.74-7.33l10.24 1.2.87-2.66-9-5.05a48.07 48.07 0 0 0 1.28-8.12L88 41.4v-2.8l-10.12-2.02c-.2-2.74-.62-5.46-1.28-8.12l8.99-5.05-.86-2.66-10.24 1.2c-1.03-2.55-2.29-5-3.74-7.33l7-7.58-1.65-2.26-9.38 4.3a48.3 48.3 0 0 0-5.8-5.8L62.42 0h2.16l-1.25 2.72a50.31 50.31 0 0 1 3.95 3.95l9.5-4.36 3.52 4.85-7.08 7.68c.94 1.6 1.79 3.27 2.54 4.98l10.38-1.21 1.85 5.7-9.11 5.12c.39 1.8.68 3.65.87 5.52L90 37v6l-10.25 2.05a49.9 49.9 0 0 1-.87 5.52l9.11 5.12-1.85 5.7-10.38-1.21c-.75 1.7-1.6 3.37-2.54 4.98l7.08 7.68-3.52 4.85-9.5-4.36a50.31 50.31 0 0 1-3.95 3.95l4.36 9.5-4.85 3.52-7.68-7.08c-1.6.94-3.27 1.79-4.98 2.54l1.21 10.38-5.7 1.85-5.12-9.11c-1.8.39-3.65.68-5.52.87L33 100h-6l-2.05-10.25a49.9 49.9 0 0 1-5.52-.87l-5.12 9.11-5.7-1.85 1.21-10.38c-1.7-.75-3.37-1.6-4.98-2.54L0 87.68v-2.66zM0 52.7V27.3l8.38 4.84a22.96 22.96 0 0 0 0 15.72L0 52.7zm0-39.16A39.91 39.91 0 0 1 26 .2v17.15a22.98 22.98 0 0 0-13.62 7.86L0 18.06v-4.52zm0 52.92v-4.52l12.38-7.15A22.98 22.98 0 0 0 26 62.65V79.8A39.91 39.91 0 0 1 0 66.46zM34 79.8V62.65a22.98 22.98 0 0 0 13.62-7.86l14.85 8.58A39.97 39.97 0 0 1 34 79.8zm32.48-23.36l-14.86-8.58a22.96 22.96 0 0 0 0-15.72l14.86-8.58A39.86 39.86 0 0 1 70 40a39.9 39.9 0 0 1-3.52 16.44zm-4.01-39.8L47.62 25.2A22.98 22.98 0 0 0 34 17.35V.2a39.97 39.97 0 0 1 28.47 16.43v.01zM0 50.38l5.98-3.45a25.01 25.01 0 0 1 0-13.88L0 29.6v20.78zm.5-34.35l11.48 6.63c3.27-3.4 7.44-5.8 12.02-6.94V2.47A37.96 37.96 0 0 0 .5 16.04v-.01zm0 47.92A37.96 37.96 0 0 0 24 77.53V64.28a24.97 24.97 0 0 1-12.02-6.95L.5 63.96v-.01zM36 77.53a37.96 37.96 0 0 0 23.5-13.57l-11.48-6.63A24.97 24.97 0 0 1 36 64.28v13.25zm29.5-23.96a37.91 37.91 0 0 0 0-27.14l-11.48 6.63a25.01 25.01 0 0 1 0 13.88l11.49 6.63h-.01zm-6-37.53A37.96 37.96 0 0 0 36 2.47v13.25c4.66 1.15 8.8 3.6 12.02 6.95l11.48-6.63zM30 54a14 14 0 1 1 0-28 14 14 0 0 1 0 28zm0-2a12 12 0 1 0 0-24 12 12 0 0 0 0 24zm0-2a10 10 0 1 1 0-20 10 10 0 0 1 0 20zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm77.47 45.17l-1.62-5.97 5.67-2.06 2.61 5.64c1.09-.25 2.2-.44 3.33-.58l.52-6.2h6.04l.52 6.2c1.13.14 2.24.33 3.33.58l2.6-5.64 5.68 2.06-1.62 5.97c1.02.51 2 1.07 2.95 1.69l4.35-4.38 4.62 3.88-3.53 5c.8.84 1.53 1.71 2.23 2.62l5.52-2.6 3.02 5.23-4.98 3.46c.46 1.06.86 2.14 1.2 3.25l6.02-.54 1.05 5.94-5.84 1.54c.07 1.16.07 2.32 0 3.48l5.84 1.54-1.05 5.94-6.02-.54c-.34 1.1-.74 2.2-1.2 3.25l4.98 3.46-3.02 5.22-5.52-2.6c-.7.92-1.44 1.8-2.23 2.62l3.53 5-4.62 3.89-4.35-4.38a30.2 30.2 0 0 1-2.95 1.69l1.62 5.97-5.67 2.06-2.61-5.64c-1.09.25-2.2.44-3.33.58l-.52 6.2h-6.04l-.52-6.2a30.27 30.27 0 0 1-3.33-.58l-2.6 5.64-5.68-2.06 1.62-5.97c-1.01-.5-2-1.07-2.95-1.69l-4.35 4.38-4.62-3.88 3.53-5a32.5 32.5 0 0 1-2.23-2.62l-5.52 2.6-3.02-5.23 4.98-3.46a29.66 29.66 0 0 1-1.2-3.25l-6.02.54-1.05-5.94 5.84-1.54a30.28 30.28 0 0 1 0-3.48l-5.84-1.54 1.05-5.94 6.02.54c.34-1.1.74-2.2 1.2-3.25l-4.98-3.46 3.02-5.22 5.52 2.6c.7-.92 1.44-1.8 2.23-2.62l-3.53-5 4.62-3.89 4.35 4.38a30.2 30.2 0 0 1 2.95-1.69zm15.2-1.12l-.5-6.05h-2.34l-.5 6.05c-2.18.13-4.3.5-6.32 1.1l-2.54-5.5-2.2.8 1.6 5.85a27.97 27.97 0 0 0-5.56 3.21l-4.27-4.3-1.79 1.5 3.5 4.95a28.14 28.14 0 0 0-4.12 4.92l-5.5-2.59-1.16 2.02 4.98 3.46a27.8 27.8 0 0 0-2.2 6.03l-6.03-.55-.4 2.3 5.86 1.54a28.3 28.3 0 0 0 0 6.42l-5.87 1.55.4 2.3 6.05-.56a27.8 27.8 0 0 0 2.2 6.03l-5 3.47 1.17 2.02 5.49-2.59a28.14 28.14 0 0 0 4.12 4.92l-3.5 4.96 1.79 1.5 4.27-4.31a27.97 27.97 0 0 0 5.56 3.21l-1.6 5.85 2.2.8 2.54-5.5c2.02.6 4.14.97 6.32 1.1l.5 6.05h2.34l.5-6.05c2.18-.13 4.3-.5 6.32-1.1l2.54 5.5 2.2-.8-1.6-5.85a27.97 27.97 0 0 0 5.56-3.21l4.27 4.3 1.79-1.5-3.5-4.95a28.14 28.14 0 0 0 4.12-4.92l5.5 2.59 1.16-2.02-4.98-3.46a27.8 27.8 0 0 0 2.2-6.03l6.03.55.4-2.3-5.86-1.54a28.3 28.3 0 0 0 0-6.42l5.87-1.55-.4-2.3-6.05.56a27.8 27.8 0 0 0-2.2-6.03l4.99-3.46-1.17-2.02-5.49 2.59a28.14 28.14 0 0 0-4.12-4.92l3.5-4.96-1.79-1.5-4.27 4.31a27.97 27.97 0 0 0-5.56-3.21l1.6-5.85-2.2-.8-2.54 5.5c-2.02-.6-4.14-.97-6.32-1.1l.01-.01zM121 128a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-2a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm0-18a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm8.49 3.51a5 5 0 1 1 6.95-7.2 5 5 0 0 1-6.95 7.2zM133 120a5 5 0 1 1 10 0 5 5 0 0 1-10 0zm-3.51 8.49a5 5 0 1 1 7.2 6.95 5 5 0 0 1-7.2-6.95zM121 132a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm-8.49-3.51a5 5 0 1 1-6.95 7.2 5 5 0 0 1 6.95-7.2zM109 120a5 5 0 1 1-10 0 5 5 0 0 1 10 0zm3.51-8.49a5 5 0 1 1-7.2-6.95 5 5 0 0 1 7.2 6.95zM121 106a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm9.9 4.1a3 3 0 1 0 4.39-4.09 3 3 0 0 0-4.39 4.09zm4.1 9.9a3 3 0 1 0 6 0 3 3 0 0 0-6 0zm-4.1 9.9a3 3 0 1 0 4.09 4.39 3 3 0 0 0-4.09-4.39zM121 134a3 3 0 1 0 0 6 3 3 0 0 0 0-6zm-9.9-4.1a3 3 0 1 0-4.39 4.09 3 3 0 0 0 4.39-4.09zM107 120a3 3 0 1 0-6 0 3 3 0 0 0 6 0zm4.1-9.9a3 3 0 1 0-4.09-4.39 3 3 0 0 0 4.09 4.39zm129.42-6.95v.01c.87.07 1.74.17 2.6.3l1.5-3.91 1.94-3.64 3.89.97v4.13l-.5 4.13c.83.28 1.64.59 2.44.93l2.42-3.43 2.76-3.07 3.54 1.88-1 4-1.49 3.89c.73.47 1.45.97 2.15 1.49l3.19-2.76 3.42-2.3 2.97 2.67-1.93 3.65-2.38 3.4c.6.64 1.2 1.3 1.76 1.99l3.68-1.94 3.85-1.48 2.29 3.28-2.7 3.11-3.12 2.82c.43.76.84 1.53 1.22 2.32l4.04-1 4.1-.5 1.43 3.73-3.37 2.37-3.7 1.98c.23.84.44 1.68.62 2.54l4.17.01 4.1.5.48 3.97-3.85 1.48-4.06 1.02c.03.87.03 1.75 0 2.62l4.06 1.02 3.85 1.48-.48 3.97-4.1.51h-4.17c-.18.86-.39 1.71-.63 2.54l3.7 1.98 3.38 2.37-1.43 3.73-4.1-.5-4.04-1c-.38.79-.79 1.56-1.22 2.32l3.13 2.82 2.7 3.11-2.3 3.28-3.85-1.48-3.68-1.95a37 37 0 0 1-1.76 2l2.38 3.41 1.93 3.64-2.97 2.67-3.42-2.3-3.19-2.76a40.1 40.1 0 0 1-2.15 1.48l1.48 3.9 1 4-3.53 1.88-2.76-3.07-2.42-3.43c-.8.33-1.61.65-2.45.93l.5 4.13v4.13l-3.88.97-1.94-3.65-1.5-3.9c-.86.13-1.73.23-2.6.31L240 187l-1 4h-4l-1-4-.52-4.16a37.6 37.6 0 0 1-2.6-.3l-1.5 3.91-1.94 3.64-3.89-.97v-4.13l.5-4.13c-.83-.28-1.64-.59-2.44-.93l-2.42 3.43-2.76 3.07-3.54-1.88 1-4 1.49-3.89c-.74-.47-1.45-.97-2.15-1.49l-3.19 2.76-3.42 2.3-2.97-2.67 1.93-3.65 2.38-3.4c-.61-.65-1.2-1.31-1.76-1.99l-3.68 1.94-3.85 1.48-2.29-3.28 2.7-3.11 3.12-2.82c-.43-.76-.84-1.53-1.22-2.32l-4.04 1-4.1.5-1.43-3.73 3.37-2.37 3.7-1.98c-.23-.84-.44-1.68-.62-2.54l-4.17-.01-4.1-.5-.48-3.97 3.85-1.48 4.06-1.02c-.03-.87-.03-1.75 0-2.62l-4.06-1.02-3.85-1.48.48-3.97 4.1-.51h4.17c.18-.86.39-1.71.63-2.54l-3.7-1.98-3.38-2.37 1.43-3.73 4.1.5 4.04 1c.38-.79.79-1.56 1.22-2.32l-3.13-2.82-2.7-3.11 2.3-3.28 3.85 1.48 3.68 1.95a37 37 0 0 1 1.76-2l-2.38-3.41-1.93-3.64 2.97-2.67 3.42 2.3 3.19 2.76c.7-.52 1.41-1.02 2.15-1.48l-1.48-3.9-1-4 3.53-1.88 2.76 3.07 2.42 3.43c.8-.33 1.61-.65 2.45-.93l-.5-4.13v-4.13l3.88-.97 1.94 3.65 1.5 3.9c.86-.13 1.73-.23 2.6-.31L234 99l1-4h4l1 4 .52 4.15zm-14.3 3.4c-1.83.54-3.6 1.21-5.3 2l-3.5-4.97-1.38-1.53-.88.47.5 2 2.16 5.67a38.09 38.09 0 0 0-4.66 3.22l-4.61-4-1.71-1.15-.75.67.97 1.82 3.47 4.98a38.22 38.22 0 0 0-3.79 4.28l-5.37-2.84-1.92-.74-.57.82 1.35 1.56 4.52 4.09a37.9 37.9 0 0 0-2.64 5l-5.89-1.45-2.04-.25-.36.94 1.69 1.18 5.36 2.87a37.74 37.74 0 0 0-1.35 5.5l-6.08.01-2.04.25-.12 1 1.92.73 5.9 1.5a38.54 38.54 0 0 0 0 5.65l-5.9 1.49-1.92.74.12.99 2.04.25 6.08.01c.31 1.86.77 3.7 1.35 5.5l-5.36 2.87-1.7 1.18.37.94 2.04-.25 5.9-1.46a37.9 37.9 0 0 0 2.63 5.01l-4.52 4.1-1.35 1.55.57.82 1.92-.74 5.37-2.84a38.22 38.22 0 0 0 3.8 4.28l-3.48 4.98-.97 1.82.75.67 1.7-1.15 4.62-4a38.09 38.09 0 0 0 4.66 3.22l-2.17 5.67-.5 2 .89.47 1.38-1.53 3.5-4.98c1.7.8 3.47 1.47 5.3 2l-.73 6.04v2.06l.97.24.97-1.82 2.2-5.68c1.83.36 3.7.6 5.62.68L236 187l.5 2h1l.5-2 .75-6.04a38.2 38.2 0 0 0 5.62-.68l2.2 5.68.97 1.82.97-.24v-2.06l-.73-6.03c1.83-.54 3.6-1.21 5.3-2l3.5 4.97 1.38 1.53.88-.47-.5-2-2.16-5.67a38.09 38.09 0 0 0 4.66-3.22l4.61 4 1.71 1.15.75-.67-.97-1.82-3.47-4.98a38.22 38.22 0 0 0 3.79-4.28l5.37 2.84 1.92.74.57-.82-1.35-1.56-4.52-4.09c1-1.6 1.88-3.27 2.64-5l5.89 1.45 2.04.25.36-.94-1.69-1.18-5.36-2.87a37.4 37.4 0 0 0 1.35-5.5l6.08-.01 2.04-.25.12-1-1.92-.73-5.9-1.5c.14-1.88.14-3.77 0-5.65l5.9-1.49 1.92-.74-.12-.99-2.04-.25-6.08-.01a37.4 37.4 0 0 0-1.35-5.5l5.36-2.87 1.7-1.18-.37-.94-2.04.25-5.9 1.46a37.9 37.9 0 0 0-2.63-5.01l4.52-4.1 1.35-1.55-.57-.82-1.92.74-5.37 2.84a38.22 38.22 0 0 0-3.8-4.28l3.48-4.98.97-1.82-.75-.67-1.7 1.15-4.62 4a38.09 38.09 0 0 0-4.66-3.22l2.17-5.67.5-2-.89-.47-1.38 1.53-3.5 4.98c-1.7-.8-3.47-1.47-5.3-2l.73-6.04v-2.06l-.97-.24-.97 1.82-2.2 5.68c-1.83-.36-3.7-.6-5.62-.68L238 99l-.5-2h-1l-.5 2-.75 6.04c-1.92.09-3.8.32-5.62.68l-2.2-5.68-.97-1.82-.97.24v2.06l.73 6.03zm-5.85 5.65A34.82 34.82 0 0 1 236 108v6a28.8 28.8 0 0 0-12.63 3.39l-3-5.2v.01zm2.8.83l1 1.74a30.8 30.8 0 0 1 9.83-2.63v-2.01a32.8 32.8 0 0 0-10.83 2.9zm-4.53.17l3 5.2a29.12 29.12 0 0 0-9.24 9.24l-5.2-3a35.18 35.18 0 0 1 11.44-11.44zm-.67 2.84a33.19 33.19 0 0 0-7.93 7.93l1.74 1a31.18 31.18 0 0 1 7.2-7.2l-1.01-1.73zm-11.77 10.33h-.01l5.2 3A28.8 28.8 0 0 0 208 142h-6a34.82 34.82 0 0 1 4.2-15.63zm.83 2.8a32.8 32.8 0 0 0-2.9 10.83h2.01a30.8 30.8 0 0 1 2.63-9.83l-1.74-1zM202.01 144h6.01c.15 4.41 1.3 8.73 3.38 12.63l-5.2 3a34.82 34.82 0 0 1-4.19-15.63zm2.12 2a32.8 32.8 0 0 0 2.9 10.84l1.74-1a30.8 30.8 0 0 1-2.63-9.84h-2.01zm3.07 15.36l5.2-3c2.34 3.74 5.5 6.9 9.24 9.24l-3 5.2a35.18 35.18 0 0 1-11.44-11.44zm2.84.67a33.19 33.19 0 0 0 7.93 7.93l1-1.74a31.18 31.18 0 0 1-7.2-7.2l-1.73 1.01zm10.33 11.77v.01l3-5.2A28.85 28.85 0 0 0 236 172v6a34.82 34.82 0 0 1-15.63-4.2zm2.8-.83a32.8 32.8 0 0 0 10.83 2.9v-2.01a30.8 30.8 0 0 1-9.83-2.63l-1 1.74zm14.83 5.02v-6.01c4.41-.15 8.73-1.3 12.63-3.38l3 5.2a34.82 34.82 0 0 1-15.63 4.19zm2-2.12a32.8 32.8 0 0 0 10.84-2.9l-1-1.74a30.8 30.8 0 0 1-9.84 2.63v2.01zm15.36-3.07l-3-5.2c3.74-2.34 6.9-5.5 9.24-9.24l5.2 3a35.18 35.18 0 0 1-11.44 11.44zm.67-2.84a33.19 33.19 0 0 0 7.93-7.93l-1.74-1a31.18 31.18 0 0 1-7.2 7.2l1.01 1.73zm11.77-10.33h.01l-5.2-3A28.85 28.85 0 0 0 266 144h6a34.82 34.82 0 0 1-4.2 15.63zm-.83-2.8a32.8 32.8 0 0 0 2.9-10.83h-2.01a30.8 30.8 0 0 1-2.63 9.83l1.74 1zm5.02-14.83h-6.01a28.85 28.85 0 0 0-3.38-12.63l5.2-3a34.82 34.82 0 0 1 4.19 15.63zm-2.12-2a32.8 32.8 0 0 0-2.9-10.84l-1.74 1a30.8 30.8 0 0 1 2.63 9.84h2.01zm-3.07-15.36l-5.2 3a29.12 29.12 0 0 0-9.24-9.24l3-5.2a35.18 35.18 0 0 1 11.44 11.44zm-2.84-.67a33.19 33.19 0 0 0-7.93-7.93l-1 1.74a31.18 31.18 0 0 1 7.2 7.2l1.73-1.01zM238 108a34.82 34.82 0 0 1 15.63 4.19l-3 5.2a28.85 28.85 0 0 0-12.63-3.38V108zm12.84 5.02a32.8 32.8 0 0 0-10.84-2.9v2.01a30.8 30.8 0 0 1 9.83 2.63l1-1.74h.01zM237 156a13 13 0 1 1 0-26 13 13 0 0 1 0 26zm0-2a11 11 0 1 0 0-22 11 11 0 0 0 0 22zM137.54 0h56.92l-.74 1.03c.57.7 1.12 1.4 1.64 2.14l7.75-2.9 2 3.46-6.38 5.25c.37.82.72 1.65 1.03 2.5l8.22-.8 1.04 3.86-7.52 3.43c.15.88.26 1.77.35 2.67L210 22v4l-8.15 1.36c-.09.9-.2 1.8-.35 2.67l7.52 3.43-1.04 3.86-8.22-.8c-.31.85-.66 1.68-1.03 2.5l6.38 5.25-2 3.46-7.75-2.9c-.52.74-1.07 1.45-1.64 2.14l4.8 6.73-2.82 2.83-6.73-4.8c-.7.56-1.4 1.11-2.14 1.63l2.9 7.75-3.46 2-5.25-6.38c-.82.37-1.65.72-2.5 1.03l.8 8.22-3.86 1.04-3.43-7.52c-.88.15-1.77.26-2.67.35L168 68h-4l-1.36-8.15c-.9-.09-1.8-.2-2.67-.35l-3.43 7.52-3.86-1.04.8-8.22c-.85-.31-1.68-.66-2.5-1.03l-5.25 6.38-3.46-2 2.9-7.75a36.15 36.15 0 0 1-2.14-1.64l-6.73 4.8-2.83-2.82 4.8-6.73c-.56-.7-1.11-1.4-1.63-2.14l-7.75 2.9-2-3.46 6.38-5.25c-.37-.82-.72-1.65-1.03-2.5l-8.22.8-1.04-3.86 7.52-3.43c-.15-.88-.26-1.77-.35-2.67L122 26v-4l8.15-1.36c.09-.9.2-1.8.35-2.67l-7.52-3.43 1.04-3.86 8.22.8c.31-.85.66-1.68 1.03-2.5l-6.38-5.25 2-3.46 7.75 2.9c.52-.74 1.07-1.45 1.64-2.14L137.54 0zm2.43 0l.83 1.17a34.14 34.14 0 0 0-3.38 4.4l-7.63-2.86-.33.58 6.29 5.18a33.79 33.79 0 0 0-2.13 5.12l-8.1-.78-.18.64 7.42 3.37a34.02 34.02 0 0 0-.72 5.5L124 23.68v.66l8.04 1.34c.1 1.88.33 3.72.72 5.5l-7.42 3.38.18.64 8.1-.78a33.88 33.88 0 0 0 2.13 5.12l-6.29 5.18.33.58 7.63-2.86c1 1.56 2.14 3.03 3.38 4.4l-4.73 6.63.47.47 6.63-4.73a34.14 34.14 0 0 0 4.4 3.38l-2.86 7.63.58.33 5.18-6.29c1.63.84 3.35 1.56 5.12 2.13l-.78 8.1.64.18 3.37-7.42c1.79.39 3.63.63 5.5.72l1.35 8.04h.66l1.34-8.04c1.88-.1 3.72-.33 5.5-.72l3.38 7.42.64-.18-.78-8.1a33.88 33.88 0 0 0 5.12-2.13l5.18 6.29.58-.33-2.86-7.63c1.56-1 3.03-2.14 4.4-3.38l6.63 4.73.47-.47-4.73-6.63a34.14 34.14 0 0 0 3.38-4.4l7.63 2.86.33-.58-6.29-5.18a33.79 33.79 0 0 0 2.13-5.12l8.1.78.18-.64-7.42-3.37c.39-1.79.63-3.63.72-5.5l8.04-1.35v-.66l-8.04-1.34c-.1-1.88-.33-3.72-.72-5.5l7.42-3.38-.18-.64-8.1.78a33.79 33.79 0 0 0-2.13-5.12l6.29-5.18-.33-.58-7.63 2.86c-1-1.56-2.14-3.03-3.38-4.4l.83-1.17h-52.06V0zm-2.82 27h14.15A15.02 15.02 0 0 0 163 38.7v14.15A29.01 29.01 0 0 1 137.15 27zm12.57-27H163v9.3A15.02 15.02 0 0 0 151.3 21h-14.15a28.99 28.99 0 0 1 12.57-21zM169 52.85V38.7A15.02 15.02 0 0 0 180.7 27h14.15A29.01 29.01 0 0 1 169 52.85zM182.28 0a28.99 28.99 0 0 1 12.57 21H180.7A15.02 15.02 0 0 0 169 9.3V0h13.28zm-42.82 29A27.03 27.03 0 0 0 161 50.54V40.25A17.04 17.04 0 0 1 149.75 29h-10.29zm14.16-29a27.04 27.04 0 0 0-14.16 19h10.29A17.04 17.04 0 0 1 161 7.75V0h-7.38zM171 50.54A27.03 27.03 0 0 0 192.54 29h-10.29A17.04 17.04 0 0 1 171 40.25v10.29zM178.38 0H171v7.75A17.04 17.04 0 0 1 182.25 19h10.29a27.04 27.04 0 0 0-14.16-19zM166 34a10 10 0 1 1 0-20 10 10 0 0 1 0 20zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm-39.51 176.15l-10.67-7.95 6-10.4 12.23 5.27a23.97 23.97 0 0 1 8.4-4.86L144 177h12l1.55 13.21a23.97 23.97 0 0 1 8.4 4.86l12.23-5.27 6 10.4-10.67 7.95a24 24 0 0 1 0 9.7l10.67 7.95-6 10.4-12.23-5.27a23.97 23.97 0 0 1-8.4 4.86L156 249h-12l-1.55-13.21a23.97 23.97 0 0 1-8.4-4.86l-12.23 5.27-6-10.4 10.67-7.95a24.1 24.1 0 0 1 0-9.7zm29.25-16.4l-1.5-12.75h-8.48l-1.5 12.76c-3.75 1-7.1 2.99-9.79 5.65l-11.8-5.08-4.23 7.34 10.3 7.68c-.98 3.7-.98 7.6 0 11.3l-10.3 7.68 4.23 7.34 11.8-5.08a22.1 22.1 0 0 0 9.8 5.65l1.5 12.76h8.47l1.5-12.76c3.75-1 7.1-2.99 9.79-5.65l11.8 5.08 4.23-7.34-10.3-7.68c.98-3.7.98-7.6 0-11.3l10.3-7.68-4.23-7.34-11.8 5.08a21.98 21.98 0 0 0-9.8-5.65l.01-.01zM150 225a12 12 0 1 1 0-24 12 12 0 0 1 0 24zm0-2a10 10 0 1 0 0-20 10 10 0 0 0 0 20zm3.53 67.72l4.26.07.51 1.93-3.65 2.19c.11.63.2 1.27.25 1.92L159 298v2l-4.1 1.17c-.05.65-.14 1.29-.25 1.92l3.65 2.2-.51 1.92-4.26.07c-.22.61-.47 1.21-.74 1.8l2.96 3.05-1 1.74-4.13-1.04a24.1 24.1 0 0 1-1.18 1.54l2.07 3.72-1.42 1.42-3.72-2.07c-.5.41-1.01.8-1.54 1.18l1.04 4.13-1.74 1-3.05-2.96c-.59.27-1.19.52-1.8.74l-.07 4.26-1.93.51-2.19-3.65c-.63.11-1.27.2-1.92.25L132 327h-2l-1.17-4.1c-.65-.05-1.29-.14-1.92-.25l-2.2 3.65-1.92-.51-.07-4.26c-.61-.22-1.21-.47-1.8-.74l-3.05 2.96-1.74-1 1.04-4.13a24.1 24.1 0 0 1-1.54-1.18l-3.72 2.07-1.42-1.42 2.07-3.72c-.41-.5-.8-1.01-1.18-1.54l-4.13 1.04-1-1.74 2.96-3.05c-.27-.59-.52-1.19-.74-1.8l-4.26-.07-.51-1.93 3.65-2.19c-.11-.63-.2-1.27-.25-1.92L103 300v-2l4.1-1.17c.05-.65.14-1.29.25-1.92l-3.65-2.2.51-1.92 4.26-.07c.22-.61.47-1.21.74-1.8l-2.96-3.05 1-1.74 4.13 1.04c.38-.53.77-1.04 1.18-1.54l-2.07-3.72 1.42-1.42 3.72 2.07c.5-.41 1.01-.8 1.54-1.18l-1.04-4.13 1.74-1 3.05 2.96c.59-.27 1.19-.52 1.8-.74l.07-4.26 1.93-.51 2.19 3.65c.63-.11 1.27-.2 1.92-.25L130 271h2l1.17 4.1c.65.05 1.29.14 1.92.25l2.2-3.65 1.92.51.07 4.26c.61.22 1.21.47 1.8.74l3.05-2.96 1.74 1-1.04 4.13c.53.38 1.04.77 1.54 1.18l3.72-2.07 1.42 1.42-2.07 3.72c.41.5.8 1.01 1.18 1.54l4.13-1.04 1 1.74-2.96 3.05c.27.59.52 1.19.74 1.8zM109 299a22 22 0 1 0 44 0 22 22 0 0 0-44 0zm27.11-10.86l-3 5.22a6 6 0 0 0-4.21 0l-3.01-5.22a11.95 11.95 0 0 1 10.22 0zm1.74 1a12 12 0 0 1 5.1 8.86h-6.01a6.01 6.01 0 0 0-2.1-3.64l3-5.22h.01zm-13.7 0l3.02 5.22a6.01 6.01 0 0 0-2.1 3.64h-6.03a12 12 0 0 1 5.11-8.86zm-5.1 10.86h6.01a6.01 6.01 0 0 0 2.1 3.64l-3 5.22a12 12 0 0 1-5.12-8.86h.01zm6.84 9.86l3-5.22a6 6 0 0 0 4.21 0l3.01 5.22a11.95 11.95 0 0 1-10.22 0zm11.96-1l-3.02-5.22a6.01 6.01 0 0 0 2.1-3.64h6.03a12 12 0 0 1-5.11 8.86zm-4.68-19.62a10.04 10.04 0 0 0-4.34 0l1.05 1.82c.74-.1 1.5-.1 2.24 0l1.05-1.82zm5.2 3l-1.05 1.82c.46.59.84 1.24 1.12 1.94h2.1a9.99 9.99 0 0 0-2.17-3.76zm-14.74 0a9.99 9.99 0 0 0-2.17 3.76h2.1c.28-.7.66-1.35 1.12-1.94l-1.05-1.82zm-2.17 9.76a9.99 9.99 0 0 0 2.17 3.76l1.05-1.82a8.01 8.01 0 0 1-1.12-1.94h-2.1zm7.37 6.76c1.43.32 2.91.32 4.34 0l-1.05-1.82c-.74.1-1.5.1-2.24 0l-1.05 1.82zm9.54-3a9.99 9.99 0 0 0 2.17-3.76h-2.1c-.28.7-.66 1.35-1.12 1.94l1.05 1.82zM127 299a4 4 0 1 1 8 0 4 4 0 0 1-8 0zm2 0a2 2 0 1 0 4 0 2 2 0 0 0-4 0zm15 0a4 4 0 1 1 8 0 4 4 0 0 1-8 0zm-6.5 11.26a4 4 0 1 1 4 6.93 4 4 0 0 1-4-6.93zm-13 0a4 4 0 1 1-4 6.93 4 4 0 0 1 4-6.93zM118 299a4 4 0 1 1-8 0 4 4 0 0 1 8 0zm6.5-11.26a4 4 0 1 1-4-6.93 4 4 0 0 1 4 6.93zm13 0a4 4 0 1 1 4-6.93 4 4 0 0 1-4 6.93zM146 299a2 2 0 1 0 4 0 2 2 0 0 0-4 0zm-7.5 12.99a2 2 0 1 0 1.66 3.64 2 2 0 0 0-1.66-3.64zm-15 0a2 2 0 1 0-2.15 3.38 2 2 0 0 0 2.15-3.38zM116 299a2 2 0 1 0-4 0 2 2 0 0 0 4 0zm7.5-12.99a2 2 0 1 0-1.66-3.64 2 2 0 0 0 1.66 3.64zm15 0a2 2 0 1 0 2.15-3.38 2 2 0 0 0-2.15 3.38zm103.8-61.7l-.8-8.22 5.8-1.55 3.42 7.52c2.26-.43 4.57-.74 6.92-.9L259 213h6l1.36 8.16c2.35.16 4.66.47 6.92.9l3.42-7.52 5.8 1.55-.8 8.22c2.21.77 4.37 1.66 6.45 2.68l5.25-6.38 5.2 3-2.9 7.74a60.25 60.25 0 0 1 5.53 4.25l6.73-4.8 4.24 4.24-4.8 6.73a60.25 60.25 0 0 1 4.25 5.53l7.74-2.9 3 5.2-6.38 5.25a59.62 59.62 0 0 1 2.68 6.45l8.22-.8 1.55 5.8-7.52 3.42c.43 2.26.74 4.57.9 6.92L330 278v6l-8.16 1.36a60.03 60.03 0 0 1-.9 6.92l7.52 3.42-1.55 5.8-8.22-.8a59.62 59.62 0 0 1-2.68 6.45l6.38 5.25-3 5.2-7.74-2.9a60.25 60.25 0 0 1-4.25 5.53l4.8 6.73-4.24 4.24-6.73-4.8a60.25 60.25 0 0 1-5.53 4.25l2.9 7.74-5.2 3-5.25-6.38a59.62 59.62 0 0 1-6.45 2.68l.8 8.22-5.8 1.55-3.42-7.52c-2.26.43-4.57.74-6.92.9L265 349h-6l-1.36-8.16a60.03 60.03 0 0 1-6.92-.9l-3.42 7.52-5.8-1.55.8-8.22a59.62 59.62 0 0 1-6.45-2.68l-5.25 6.38-5.2-3 2.9-7.74a60.25 60.25 0 0 1-5.53-4.25l-6.73 4.8-4.24-4.24 4.8-6.73a60.25 60.25 0 0 1-4.25-5.53l-7.74 2.9-3-5.2 6.38-5.25a59.62 59.62 0 0 1-2.68-6.45l-8.22.8-1.55-5.8 7.52-3.42c-.43-2.29-.73-4.6-.9-6.92L194 284v-6l8.16-1.36c.16-2.35.47-4.66.9-6.92l-7.52-3.42 1.55-5.8 8.22.8c.77-2.2 1.66-4.35 2.68-6.45l-6.38-5.25 3-5.2 7.74 2.9a60.25 60.25 0 0 1 4.25-5.53l-4.8-6.73 4.24-4.24 6.73 4.8a60.25 60.25 0 0 1 5.53-4.25l-2.9-7.74 5.2-3 5.25 6.38a59.62 59.62 0 0 1 6.45-2.68zm2.12 1.4c-3.15 1-6.19 2.27-9.08 3.77l-5.19-6.3-2.3 1.33 2.86 7.65a58.24 58.24 0 0 0-7.79 5.98l-6.65-4.75-1.88 1.88 4.75 6.65a58.24 58.24 0 0 0-5.98 7.79l-7.65-2.86-1.33 2.3 6.3 5.2a57.64 57.64 0 0 0-3.77 9.07l-8.12-.79-.69 2.58 7.43 3.38a58 58 0 0 0-1.27 9.73l-8.06 1.35v2.66l8.06 1.35c.15 3.32.58 6.58 1.27 9.73l-7.43 3.38.7 2.58 8.11-.79c1 3.15 2.27 6.19 3.77 9.08l-6.3 5.19 1.33 2.3 7.65-2.86a58.24 58.24 0 0 0 5.98 7.79l-4.75 6.65 1.88 1.88 6.65-4.75a60.3 60.3 0 0 0 7.79 5.98l-2.86 7.65 2.3 1.33 5.2-6.3a56.99 56.99 0 0 0 9.07 3.77l-.79 8.12 2.58.69 3.38-7.43c3.15.69 6.4 1.12 9.73 1.27l1.35 8.06h2.66l1.35-8.06c3.32-.15 6.58-.58 9.73-1.27l3.38 7.43 2.58-.7-.79-8.11c3.15-1 6.19-2.27 9.08-3.77l5.19 6.3 2.3-1.33-2.86-7.65a58.24 58.24 0 0 0 7.79-5.98l6.65 4.75 1.88-1.88-4.75-6.65a60.3 60.3 0 0 0 5.98-7.79l7.65 2.86 1.33-2.3-6.3-5.2a56.99 56.99 0 0 0 3.77-9.07l8.12.79.69-2.58-7.43-3.38a58 58 0 0 0 1.27-9.73l8.06-1.35v-2.66l-8.06-1.35a58.04 58.04 0 0 0-1.27-9.73l7.43-3.38-.7-2.58-8.11.79c-1-3.15-2.27-6.19-3.77-9.08l6.3-5.19-1.33-2.3-7.65 2.86a58.24 58.24 0 0 0-5.98-7.79l4.75-6.65-1.88-1.88-6.65 4.75a58.24 58.24 0 0 0-7.79-5.98l2.86-7.65-2.3-1.33-5.2 6.3a57.64 57.64 0 0 0-9.07-3.77l.79-8.12-2.58-.69-3.38 7.43a58 58 0 0 0-9.73-1.27l-1.35-8.06h-2.66l-1.35 8.06c-3.32.15-6.58.58-9.73 1.27l-3.38-7.43-2.58.7.79 8.11zm4.58 50.1a13.96 13.96 0 0 0 0 10.39l-33.88 19.55A52.77 52.77 0 0 1 209 281c0-8.94 2.21-17.37 6.12-24.75L249 275.8v.01zm2-3.47l-33.87-19.56A52.97 52.97 0 0 1 260 228.04v39.1a13.99 13.99 0 0 0-9 5.2zm0 17.32a13.99 13.99 0 0 0 9 5.2v39.1a52.97 52.97 0 0 1-42.87-24.74L251 289.66zm13 5.2a13.99 13.99 0 0 0 9-5.2l33.87 19.56A52.97 52.97 0 0 1 264 333.96v-39.1zm11-8.66a13.96 13.96 0 0 0 0-10.4l33.88-19.55A52.77 52.77 0 0 1 315 281c0 8.94-2.21 17.37-6.12 24.75L275 286.2zm-2-13.86a13.99 13.99 0 0 0-9-5.2v-39.1a52.97 52.97 0 0 1 42.87 24.74L273 272.34zm-57.04-13.3A50.8 50.8 0 0 0 211 281a50.8 50.8 0 0 0 4.96 21.96l30.62-17.68c-.78-2.8-.78-5.76 0-8.56l-30.62-17.68zm4-6.93l30.62 17.68a16.08 16.08 0 0 1 7.42-4.29v-35.35a50.96 50.96 0 0 0-38.04 21.96zm0 57.78A50.96 50.96 0 0 0 258 331.85V296.5a15.98 15.98 0 0 1-7.42-4.29l-30.62 17.68zM266 331.85a50.96 50.96 0 0 0 38.04-21.96l-30.62-17.68a16.08 16.08 0 0 1-7.42 4.29v35.35zm42.04-28.89A50.8 50.8 0 0 0 313 281a50.8 50.8 0 0 0-4.96-21.96l-30.62 17.68c.78 2.8.78 5.76 0 8.56l30.62 17.68zm-4-50.85A50.96 50.96 0 0 0 266 230.15v35.35c2.86.74 5.41 2.25 7.42 4.29l30.62-17.68zM262 290a9 9 0 1 1 0-18 9 9 0 0 1 0 18zm0-2a7 7 0 1 0 0-14 7 7 0 0 0 0 14zM0 242.64l2.76.4 4.75 2.27a38.2 38.2 0 0 1 2.85-3.4l-3.06-4.28-1.69-5.11 3.07-2.58 4.74 2.55 3.69 3.76a37.96 37.96 0 0 1 3.84-2.22l-1.42-5.07.17-5.38 3.76-1.37 3.6 4.02 2.17 4.79c1.42-.34 2.88-.6 4.37-.77L34 225l2-5h4l2 5 .4 5.25c1.49.17 2.95.43 4.37.77l2.18-4.8 3.59-4 3.76 1.36.17 5.38-1.42 5.07c1.33.67 2.6 1.41 3.84 2.22l3.69-3.76 4.74-2.55 3.07 2.58-1.69 5.11-3.06 4.29a38.2 38.2 0 0 1 2.85 3.4l4.75-2.28 5.33-.77 2 3.46-3.33 4.23-4.34 2.98c.59 1.36 1.1 2.75 1.52 4.17l5.23-.52 5.27 1.1.7 3.94-4.58 2.84-5.1 1.31a38.6 38.6 0 0 1 0 4.44l5.1 1.3 4.58 2.85-.7 3.93-5.27 1.1-5.23-.5a36.3 36.3 0 0 1-1.52 4.16l4.34 2.98 3.33 4.23-2 3.46-5.33-.77-4.75-2.27a38.2 38.2 0 0 1-2.85 3.4l3.06 4.28 1.69 5.11-3.07 2.58-4.74-2.55-3.69-3.76a37.96 37.96 0 0 1-3.84 2.22l1.42 5.07-.17 5.38-3.76 1.37-3.6-4.02-2.17-4.79c-1.42.34-2.88.6-4.37.77L42 311l-2 5h-4l-2-5-.4-5.25a37.87 37.87 0 0 1-4.37-.77l-2.18 4.8-3.59 4-3.76-1.36-.17-5.38 1.42-5.07c-1.32-.66-2.6-1.4-3.84-2.22l-3.69 3.76-4.74 2.55-3.07-2.58 1.69-5.11 3.06-4.29a38.2 38.2 0 0 1-2.85-3.4l-4.75 2.28-2.76.4v-8.17l3.1-2.13a37.72 37.72 0 0 1-1.52-4.17l-1.58.16v-8.82l.06-.01a38.6 38.6 0 0 1 0-4.44l-.06-.01v-8.82l1.58.16c.43-1.43.94-2.82 1.52-4.17L0 250.8v-8.17.01zm0 1.87v3.89l5.62 3.84a35.74 35.74 0 0 0-2.55 7.02l-3.07-.3v4.75l2.2.56a36.42 36.42 0 0 0 0 7.46l-2.2.56v4.75l3.07-.3a35.2 35.2 0 0 0 2.55 7.02L0 287.6v3.89l1.76-.26 6.41-3.07c1.4 2.06 3 3.98 4.8 5.71l-4.14 5.78-1.01 3.07 1.22 1.03 2.85-1.52 4.98-5.08c2 1.45 4.16 2.7 6.45 3.73l-1.9 6.84.1 3.23 1.5.55 2.15-2.4 2.94-6.48a35.9 35.9 0 0 0 7.34 1.3L36 311l1.2 3h1.6l1.2-3 .55-7.09a35.9 35.9 0 0 0 7.34-1.29l2.94 6.47 2.15 2.4 1.5-.54.1-3.23-1.9-6.84a35.96 35.96 0 0 0 6.45-3.73l4.98 5.08 2.85 1.52 1.22-1.03-1-3.07-4.15-5.78a35.8 35.8 0 0 0 4.8-5.7l6.4 3.06 3.2.46.8-1.38-2-2.54-5.85-4.01c1.1-2.24 1.95-4.6 2.55-7.02l7.07.7 3.16-.66.28-1.58-2.75-1.7-6.88-1.77c.26-2.48.26-4.98 0-7.46l6.88-1.77 2.75-1.7-.28-1.58-3.16-.66-7.07.7a35.74 35.74 0 0 0-2.55-7.02l5.86-4 2-2.55-.8-1.38-3.2.46-6.41 3.07c-1.4-2.06-3-3.98-4.8-5.71l4.14-5.78 1.01-3.07-1.22-1.03-2.85 1.52-4.98 5.08c-2-1.45-4.16-2.7-6.45-3.73l1.9-6.84-.1-3.23-1.5-.55-2.15 2.4-2.94 6.48a35.9 35.9 0 0 0-7.34-1.3L40 225l-1.2-3h-1.6l-1.2 3-.55 7.09c-2.48.17-4.94.6-7.34 1.29l-2.94-6.47-2.15-2.4-1.5.54-.1 3.23 1.9 6.84a35.96 35.96 0 0 0-6.45 3.73l-4.98-5.08-2.85-1.52-1.22 1.03 1 3.07 4.15 5.78a36.18 36.18 0 0 0-4.8 5.7l-6.4-3.06L0 244.5v.01zM38 272a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-2a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0-26a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm24 24a4 4 0 1 1 8 0 4 4 0 0 1-8 0zm-24 24a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm-24-24a4 4 0 1 1-8 0 4 4 0 0 1 8 0zm24-26a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm26 26a2 2 0 1 0 4 0 2 2 0 0 0-4 0zm-26 26a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-26-26a2 2 0 1 0-4 0 2 2 0 0 0 4 0zm3.37 22.63a12 12 0 1 1 16.17-17.74 12 12 0 0 1-16.17 17.74zm0-45.26a12 12 0 1 1 17.74 16.17 12 12 0 0 1-17.74-16.17zm45.26 0a12 12 0 1 1-16.17 17.74 12 12 0 0 1 16.17-17.74zm0 45.26a12 12 0 1 1-17.74-16.17 12 12 0 0 1 17.74 16.17zm-15.56-29.7a10 10 0 1 0 14.39-13.9 10 10 0 0 0-14.39 13.9zm0 14.14a10 10 0 1 0 13.9 14.39 10 10 0 0 0-13.9-14.39zm-14.14 0a10 10 0 1 0-14.39 13.9 10 10 0 0 0 14.39-13.9zm0-14.14a10 10 0 1 0-13.9-14.39 10 10 0 0 0 13.9 14.39zm230.9-245.4l-.08-4.18 1.93-.52 2.04 3.67c1.07-.2 2.16-.35 3.26-.43L270 10h2l1.02 4.07c1.1.08 2.2.22 3.26.43l2.04-3.67 1.93.52-.07 4.19a27 27 0 0 1 3.04 1.26l2.91-3.01 1.74 1-1.16 4.03c.91.62 1.78 1.29 2.61 2l3.6-2.15 1.41 1.41-2.16 3.6c.72.83 1.4 1.7 2 2.6l4.04-1.15 1 1.74-3.01 2.91c.48.98.9 2 1.26 3.04l4.2-.07.5 1.93-3.66 2.04c.2 1.07.35 2.16.43 3.26L303 41v2l-4.07 1.02a26.9 26.9 0 0 1-.43 3.26l3.67 2.04-.52 1.93-4.19-.07a27.82 27.82 0 0 1-1.26 3.04l3.01 2.91-1 1.74-4.03-1.16c-.62.91-1.29 1.78-2 2.61l2.15 3.6-1.41 1.41-3.6-2.16c-.83.72-1.7 1.4-2.6 2l1.15 4.04-1.74 1-2.91-3.01a27 27 0 0 1-3.04 1.26l.07 4.2-1.93.5-2.04-3.66c-1.07.2-2.16.35-3.26.43L272 74h-2l-1.02-4.07a26.9 26.9 0 0 1-3.26-.43l-2.04 3.67-1.93-.52.07-4.19a27.82 27.82 0 0 1-3.04-1.26l-2.91 3.01-1.74-1 1.16-4.03c-.9-.62-1.78-1.29-2.61-2l-3.6 2.15-1.41-1.41 2.16-3.6c-.72-.83-1.4-1.7-2-2.6l-4.04 1.15-1-1.74 3.01-2.91a27 27 0 0 1-1.26-3.04l-4.2.07-.5-1.93 3.66-2.04c-.2-1.07-.35-2.16-.43-3.26L239 43v-2l4.07-1.02c.08-1.1.22-2.2.43-3.26l-3.67-2.04.52-1.93 4.19.07a27 27 0 0 1 1.26-3.04l-3.01-2.91 1-1.74 4.03 1.16c.62-.91 1.29-1.78 2-2.61l-2.15-3.6 1.41-1.41 3.6 2.16c.83-.72 1.7-1.4 2.6-2l-1.15-4.04 1.74-1 2.91 3.01a27 27 0 0 1 3.04-1.26l.01-.01zM271 68a26 26 0 1 0 0-52 26 26 0 0 0 0 52zm0-9a17 17 0 1 1 0-34 17 17 0 0 1 0 34zm0-2a15 15 0 1 0 0-30 15 15 0 0 0 0 30zm0-8a7 7 0 1 1 0-14 7 7 0 0 1 0 14zm0-2a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm0-14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm9 9a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm-9 9a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm-9-9a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm47.93 53.79l-1.8-3.91 1.63-1.18 3.15 2.92c.4-.17.82-.3 1.25-.4L315 89h2l.84 4.21c.43.1.85.24 1.25.4l3.15-2.9 1.62 1.17-1.8 3.9c.3.33.55.69.78 1.06l4.26-.5.62 1.9-3.75 2.1c.04.44.04.87 0 1.31l3.75 2.1-.62 1.9-4.26-.5c-.23.38-.49.74-.77 1.06l1.8 3.91-1.63 1.18-3.15-2.92c-.4.17-.82.3-1.25.4L317 113h-2l-.84-4.21c-.43-.1-.85-.24-1.25-.4l-3.15 2.9-1.62-1.17 1.8-3.9a8.03 8.03 0 0 1-.78-1.06l-4.26.5-.62-1.9 3.75-2.1a8.1 8.1 0 0 1 0-1.31l-3.75-2.1.62-1.9 4.26.5c.23-.38.49-.74.77-1.06zM316 106a5 5 0 1 0 0-10 5 5 0 0 0 0 10zM75.73 179.2l-.6-2.1 1.74-1 1.51 1.57a9.93 9.93 0 0 1 2.1-.55L81 175h2l.53 2.12c.72.1 1.42.3 2.09.55l1.51-1.56 1.74 1-.6 2.1c.56.45 1.07.96 1.52 1.52l2.1-.6 1 1.74-1.56 1.51c.25.67.44 1.37.55 2.1L94 186v2l-2.12.53a9.9 9.9 0 0 1-.55 2.09l1.56 1.51-1 1.74-2.1-.6a9.93 9.93 0 0 1-1.52 1.52l.6 2.1-1.74 1-1.51-1.56c-.67.25-1.37.44-2.1.55L83 199h-2l-.53-2.12c-.71-.1-1.42-.3-2.09-.55l-1.51 1.56-1.74-1 .6-2.1a9.93 9.93 0 0 1-1.52-1.52l-2.1.6-1-1.74 1.56-1.51a9.93 9.93 0 0 1-.55-2.1L70 188v-2l2.12-.53c.1-.72.3-1.42.55-2.09l-1.56-1.51 1-1.74 2.1.6c.45-.56.96-1.07 1.52-1.52v-.01zm2.15.94a8.04 8.04 0 0 0-2.74 2.74l-.14.25a7.96 7.96 0 0 0 0 7.74l.14.25a8.04 8.04 0 0 0 2.74 2.74l.25.14a7.96 7.96 0 0 0 7.74 0l.25-.14a8.04 8.04 0 0 0 2.74-2.74l.14-.25a7.96 7.96 0 0 0 0-7.74l-.14-.25a8.04 8.04 0 0 0-2.74-2.74l-.25-.14a7.96 7.96 0 0 0-7.74 0l-.25.14zM82 193a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm278 3.18l-3.8 5.6-7.18-3.51 2.6-8.07a32.15 32.15 0 0 1-3.07-2.46l-7.27 4.35-5.04-6.22 5.82-6.26c-.64-1.13-1.2-2.3-1.7-3.52l-8.45.73-1.8-7.8 7.95-3.07a32.5 32.5 0 0 1 0-3.9l-7.95-3.07 1.8-7.8 8.45.73a31.7 31.7 0 0 1 1.7-3.52l-5.82-6.26 5.04-6.22 7.27 4.35c.97-.88 2-1.7 3.07-2.46l-2.6-8.07 7.19-3.5 3.79 5.59v64.36zm0-3.53v-57.3l-4.46-6.58-4.1 2 2.53 7.87a30.14 30.14 0 0 0-5.13 4.1l-7.08-4.24-2.88 3.55 5.65 6.09a29.87 29.87 0 0 0-2.82 5.86l-8.24-.7-1.03 4.46 7.73 2.99a30.34 30.34 0 0 0 0 6.5l-7.73 3 1.03 4.45 8.24-.7a29.87 29.87 0 0 0 2.82 5.86l-5.65 6.1 2.88 3.54 7.08-4.23a30.14 30.14 0 0 0 5.13 4.09l-2.54 7.86 4.11 2 4.46-6.57zm0-51.57v5.71l-3.56-3.8a24.94 24.94 0 0 1 3.56-1.91zm0 22.68l-14.17 6.64c-2.5-9.5.77-19.57 8.38-25.78l5.79 10.5v8.64zm0 23.16a25.08 25.08 0 0 1-13.32-13.9l13.32-2.55v16.45zm0-43.64l-.39.2.39.4v-.6zm0 18.29v-2.35l-6.3-11.44a22.93 22.93 0 0 0-6.43 19.76l12.73-5.97zm0 23.15v-12.23l-10.47 2.01A23.1 23.1 0 0 0 360 182.72zM0 129.82l1 1.46a31.8 31.8 0 0 1 3.8-.86L6 122h8l1.2 8.42c1.3.21 2.57.5 3.8.86l4.8-7.06 7.18 3.51-2.6 8.07c1.07.76 2.1 1.58 3.07 2.46l7.27-4.35 5.04 6.22-5.82 6.26c.64 1.13 1.2 2.3 1.7 3.52l8.45-.73 1.8 7.8-7.95 3.07c.08 1.3.08 2.6 0 3.9l7.95 3.07-1.8 7.8-8.45-.73a33.5 33.5 0 0 1-1.7 3.52l5.82 6.26-5.04 6.22-7.27-4.35c-.97.88-2 1.7-3.07 2.46l2.6 8.07-7.19 3.5-4.78-7.05c-1.24.36-2.51.65-3.8.86L14 202H6l-1.2-8.42a31.8 31.8 0 0 1-3.8-.86l-1 1.46v-64.36zm0 3.53v57.3l.2-.29c2.02.7 4.15 1.2 6.34 1.44l1.17 8.2h4.58l1.17-8.2c2.2-.25 4.32-.74 6.35-1.44l4.65 6.87 4.1-2-2.53-7.87a30.14 30.14 0 0 0 5.13-4.1l7.08 4.24 2.88-3.55-5.65-6.09c1.14-1.83 2.1-3.8 2.82-5.86l8.24.7 1.03-4.46-7.73-2.99a30.7 30.7 0 0 0 0-6.5l7.73-3-1.03-4.45-8.24.7a29.87 29.87 0 0 0-2.82-5.86l5.65-6.1-2.88-3.54-7.08 4.23a30.14 30.14 0 0 0-5.13-4.09l2.54-7.86-4.11-2-4.65 6.86a29.82 29.82 0 0 0-6.35-1.44l-1.17-8.2H7.7l-1.17 8.2c-2.2.25-4.32.74-6.35 1.44l-.19-.29H0zm34.17 35.05l-16.26-7.62a7.94 7.94 0 0 0-.8-2.44l8.68-15.72a24.95 24.95 0 0 1 8.38 25.78zm-.85 2.63a25.01 25.01 0 0 1-21.94 15.93l2.23-17.82a8.3 8.3 0 0 0 2.07-1.5l17.64 3.39zM0 139.08A24.92 24.92 0 0 1 10 137c5 0 9.65 1.47 13.56 4l-12.28 13.1a8.06 8.06 0 0 0-2.56 0L0 144.8v-5.72zm0 22.68v-8.65l2.88 5.23c-.4.77-.66 1.59-.79 2.44l-2.09.98zm0 23.16v-16.45l4.32-.83c.6.6 1.3 1.11 2.07 1.5l2.23 17.82c-2.97-.16-5.9-.85-8.62-2.04zM10 156a6 6 0 1 1 0 12 6 6 0 0 1 0-12zm0 2a4 4 0 1 0 0 8 4 4 0 0 0 0-8zM0 141.28v.6l9.48 10.13c.35-.02.7-.02 1.04 0l9.87-10.54A22.9 22.9 0 0 0 10 139c-3.58 0-6.98.82-10 2.28zm0 18.29l.34-.16c.09-.34.2-.67.32-.99l-.66-1.2v2.35zm0 23.15c1.97.95 4.1 1.63 6.34 1.99l-1.8-14.33a11.6 11.6 0 0 1-.83-.6l-3.71.7v12.24zm13.66 1.99a23.03 23.03 0 0 0 16.8-12.21l-14.17-2.72c-.27.21-.55.42-.84.6l-1.79 14.33zm19.07-19.17a22.93 22.93 0 0 0-6.42-19.75l-6.97 12.63c.12.32.23.65.32.99l13.07 6.13zM137.54 360l-4.07-5.7 2.83-2.83 6.73 4.8c.7-.56 1.4-1.11 2.14-1.63l-2.9-7.75 3.46-2 5.25 6.38c.82-.37 1.65-.72 2.5-1.03l-.8-8.22 3.86-1.04 3.43 7.52c.88-.15 1.77-.26 2.67-.35L164 340h4l1.36 8.15c.9.09 1.8.2 2.67.35l3.43-7.52 3.86 1.04-.8 8.22c.85.31 1.68.66 2.5 1.03l5.25-6.38 3.46 2-2.9 7.75c.74.52 1.45 1.07 2.14 1.64l6.73-4.8 2.83 2.82-4.07 5.7h-56.92zm2.43 0h52.06l3.9-5.46-.47-.47-6.63 4.73a34.14 34.14 0 0 0-4.4-3.38l2.86-7.63-.58-.33-5.18 6.29a33.79 33.79 0 0 0-5.12-2.13l.78-8.1-.64-.18-3.37 7.42a34.02 34.02 0 0 0-5.5-.72l-1.35-8.04h-.66l-1.34 8.04c-1.88.1-3.72.33-5.5.72l-3.38-7.42-.64.18.78 8.1a33.88 33.88 0 0 0-5.12 2.13l-5.18-6.29-.58.33 2.86 7.63c-1.56 1-3.03 2.14-4.4 3.38l-6.63-4.73-.47.47 3.9 5.46zm9.75 0a28.83 28.83 0 0 1 13.28-4.85V360h-13.28zm32.56 0H169v-4.85c4.9.5 9.42 2.22 13.28 4.85zm-28.66 0H161v-2.54a26.8 26.8 0 0 0-7.38 2.54zm24.76 0a26.8 26.8 0 0 0-7.38-2.54V360h7.38zM358.79 0h-1.21l1.5 3.28a48.3 48.3 0 0 0-5.8 5.8l-9.38-4.3-1.65 2.26 7 7.58a47.84 47.84 0 0 0-3.74 7.33l-10.24-1.2-.86 2.66 8.99 5.05a47.91 47.91 0 0 0-1.28 8.12L332 38.6v2.8l10.12 2.02c.2 2.78.63 5.5 1.28 8.12l-9 5.05.87 2.66 10.24-1.2c1.04 2.54 2.29 5 3.74 7.33l-7 7.58 1.65 2.26 9.38-4.3a48.3 48.3 0 0 0 5.8 5.8l-4.3 9.38 2.26 1.65 2.96-2.73v2.66l-2.84 2.62-4.85-3.52 4.36-9.5a50.31 50.31 0 0 1-3.95-3.95l-9.5 4.36-3.52-4.85 7.08-7.68a49.83 49.83 0 0 1-2.54-4.98l-10.38 1.21-1.85-5.7 9.11-5.12a49.9 49.9 0 0 1-.87-5.52L330 43v-6l10.25-2.05c.19-1.87.48-3.72.87-5.52l-9.11-5.12 1.85-5.7 10.38 1.21c.75-1.71 1.6-3.37 2.54-4.98l-7.08-7.68 3.52-4.85 9.5 4.36a50.31 50.31 0 0 1 3.95-3.95L355.42 0h3.37zM360 52.7l-6.48 3.74A39.86 39.86 0 0 1 350 40a39.9 39.9 0 0 1 3.52-16.44L360 27.3v25.4zm0-39.16v4.52l-2.47-1.43c.77-1.07 1.6-2.1 2.47-3.09zm0 52.92c-.87-.99-1.7-2.02-2.47-3.1l2.47-1.42v4.52zm0-16.07V29.61l-5.5-3.18a37.91 37.91 0 0 0 0 27.14l5.5-3.18zM62.42 360h2.16l3.11-6.78-4.85-3.52-7.68 7.08a49.83 49.83 0 0 0-4.98-2.54l1.21-10.38-5.7-1.85-5.12 9.11a49.9 49.9 0 0 0-5.52-.87L33 340h-6l-2.05 10.25c-1.85.19-3.7.48-5.52.87l-5.12-9.11-5.7 1.85 1.21 10.38c-1.71.75-3.37 1.6-4.98 2.54L0 352.32v5.17-2.5l4.62 4.26a47.84 47.84 0 0 1 7.33-3.74l-1.2-10.24 2.66-.86 5.05 8.99a47.91 47.91 0 0 1 8.12-1.28L28.6 342h2.8l2.02 10.12c2.78.2 5.5.63 8.12 1.28l5.05-9 2.66.87-1.2 10.24c2.54 1.04 5 2.29 7.33 3.74l7.58-7 2.26 1.65-2.8 6.1zM360 244.51l-1.44-.2-.8 1.38 2 2.54.24.17v-3.89zm0 14.45l-4-.4-3.16.66-.28 1.58 2.75 1.7 4.69 1.2v-4.74zm0 13.33l-4.7 1.2-2.74 1.71.28 1.58 3.16.66 4-.4v-4.75zm0 15.31l-.24.17-2 2.54.8 1.38 1.44-.2v-3.89zm0 5.76l-2.57.37-2-3.46 3.33-4.23 1.24-.85v8.17zm0-14.31l-3.65.36-5.27-1.1-.7-3.94 4.58-2.84 5.04-1.3v8.82zm0-13.28l-5.04-1.3-4.58-2.84.7-3.93 5.27-1.1 3.65.35v8.82zm0-14.96l-1.24-.85-3.33-4.23 2-3.46 2.57.37v8.17zm0 101.5V360h-4.58l-3.11-6.78 4.85-3.52 2.84 2.62v-.01zm0 2.67l-2.96-2.73-2.26 1.65 2.8 6.1H360v-5.02z'%3E%3C/path%3E%3C/svg%3E");
}

/* Improved Scrollbar */
.chat-container {
    flex: 1;
    overflow-y: auto;
    

    
}

.chat-container::-webkit-scrollbar {
    width: 6px;
}

.chat-container::-webkit-scrollbar-track {
    background: var(--background-light);
}

.chat-container::-webkit-scrollbar-thumb {
    background: var(--primary-light);
    border-radius: 3px;
    transition: background var(--transition-speed);
}

.chat-container::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color);
}

/* Message Component - Enhanced Style */
.message {
    display: flex;
    margin-bottom: 16px;
    position: relative;
    clear: both;
    transition: opacity 0.3s ease;
}

.message.incoming {
    align-self: flex-start;
}

.message.outgoing {
    align-self: flex-end;
    justify-content: flex-end;
    margin-left: auto;
}

/* Diamond Message Indicator - Removed pop animation */
.message.incoming .message-content:before {
    display: none;
}

.message.outgoing .message-content:before {
    display: none;
}

.profile-image {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    margin-right: 12px;
    flex-shrink: 0;
    object-fit: cover;
    align-self: flex-start;
    border: 2px solid var(--primary-light);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.profile-image:hover {
    transform: scale(1.05);
}

.message.outgoing .profile-image {
    display: none;
}

.message-content {
    max-width: 450px;
    min-width: 180px;
    background-color: var(--background-white);
    border-radius: var(--border-radius-md);
    padding: 12px 16px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
    position: relative;
    overflow: hidden;
    transition: background-color 0.2s ease;
    border: 1px solid var(--border-color);
}

.message-content:hover {
    background-color: #f8f8f8;
}

.message.outgoing .message-content {
    background-color: var(--primary-light);
    border: 1px solid #e5e5e5;
}

/* Message Header & Metadata */
.user-name {
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 4px;
    display: block;
    font-size: 1rem;
}

.message-text {
    margin-bottom: 6px;
    word-wrap: break-word;
    line-height: 1.5;
    font-size: 1rem;
}

.message-time {
    color: var(--text-secondary);
    font-size: 0.75rem;
    text-align: right;
    display: inline-block;
    margin-left: 8px;
    float: right;
    margin-top: 4px;
}

/* Media Content */
.media-container {
    margin: 8px 0;
    max-width: 100%;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    border: 1px solid var(--border-color);
}

.message-image {
    max-width: 100%;
    max-height: 350px;
    object-fit: contain;
    border-radius: 8px;
    cursor: pointer;
    display: block;
    transition: filter 0.3s ease;
}

.message-image:hover {
    filter: brightness(1.05);
}

.message-video {
    max-width: 100%;
    max-height: 350px;
    border-radius: 8px;
    background: #000;
    display: block;
    border: 1px solid var(--border-color);
}

/* Message Groups - Consecutive messages from same sender */
.message-group {
    margin-bottom: 16px;
}

.message-group .message {
    margin-bottom: 4px;
}

.message-group .message:not(:last-child) .message-content {
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
}

.message-group .message:not(:first-child) .profile-image {
    visibility: hidden;
}

.message-group .message:not(:first-child) .user-name {
    display: none;
}

/* Interactive Action Buttons */
.action-buttons {
    display: flex;
    margin-top: 10px;
}

.action-button {
    display: flex;
    align-items: center;
    margin-right: 24px;
    color: var(--text-secondary);
    background: none;
    border: none;
    cursor: pointer;
    font-size: 0.95rem;
    transition: color var(--transition-speed);
    padding: 6px;
}

.action-button:hover {
    color: var(--primary-color);
}

.action-button svg {
    width: 18px;
    height: 18px;
    margin-right: 8px;
    fill: currentColor;
    transition: color var(--transition-speed);
}

.action-button:hover svg {
    color: var(--primary-dark);
}

/* Input Area - UPDATED */
.input-container {
    display: flex;
    flex-direction: column;
    padding: 16px 20px;
    border-top: 1px solid var(--border-light);
    background-color: var(--background-white);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.04);
    z-index: 10;
}

.media-preview {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 16px;
}

.preview-item {
    position: relative;
    width: 120px;
    height: 120px;
    border-radius: var(--border-radius-md);
    overflow: hidden;
    box-shadow: var(--box-shadow);
    transition: background-color var(--transition-speed);
    border: 1px solid var(--border-color);
}

.preview-item:hover {
    background-color: #f8f8f8;
}

.preview-image, .preview-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.remove-media {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 26px;
    height: 26px;
    background-color: rgba(0, 0, 0, 0.6);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: white;
    font-size: 16px;
    border: none;
    transition: background-color var(--transition-speed);
}

.remove-media:hover {
    background-color: rgba(240, 40, 40, 0.8);
}

/* UPDATED Input Area */
.input-tools {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.input-wrapper {
    display: flex;
    align-items: center;
    background-color: var(--primary-light);
    border-radius: var(--border-radius-lg);
    padding: 12px 16px;
    transition: box-shadow var(--transition-speed);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--border-color);
    flex: 1;
    max-height: 50px;
}

.input-wrapper:focus-within {
    box-shadow: 0 0 0 3px rgba(98, 98, 98, 0.3);
}

.message-textarea {
    flex: 1;
    background: none;
    border: none;
    color: var(--text-primary);
    font-size: 1rem;
    resize: none;
    max-height: 100px;
    overflow-y: auto;
    padding: 0;
    outline: none;
    line-height: 1.5;
    transition: height var(--transition-speed);
    min-height: 24px;
}

.message-textarea::placeholder {
    color: var(--text-secondary);
    opacity: 0.7;
}

.input-actions {
    display: flex;
    align-items: center;
    margin-left: 12px;
}

.media-button {
    background: none;
    border: none;
    cursor: pointer;
    margin-right: 12px;
    color: var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: color var(--transition-speed);
    opacity: 0.9;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: var(--primary-light);
}

.media-button:hover {
    color: var(--primary-dark);
    opacity: 1;
    background-color: #e5e5e5;
}

.media-button svg {
    width: 20px;
    height: 20px;
    fill: currentColor;
}

.send-button {
    background: var(--luxury-gradient);
    color: white;
    border: none;
    border-radius: var(--border-radius-lg);
    width: 42px;
    height: 42px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: opacity var(--transition-speed);
    box-shadow: 0 3px 8px rgba(98, 98, 98, 0.3);
}

.send-button:hover:not(:disabled) {
    opacity: 0.9;
}

.send-button:disabled {
    background: #a6a6a6;
    opacity: 0.6;
    cursor: not-allowed;
}

.send-button svg {
    width: 20px;
    height: 20px;
    fill: currentColor;
}

.file-input {
    display: none;
}

/* Phone numbers and metadata */
.phone-number {
    display: block;
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-bottom: 4px;
}

/* Country Flag */
.country-flag {
    width: 18px;
    height: 14px;
    margin-left: 5px;
    vertical-align: middle;
    border-radius: 2px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    transition: opacity 0.3s ease;
    border: 1px solid var(--border-color);
}

.country-flag:hover {
    opacity: 0.8;
}

/* Follow Button */
.follow-btn {
    margin-left: 12px;
    background-color: transparent;
    color: var(--primary-color);
    border: 1px solid var(--primary-color);
    border-radius: var(--border-radius-lg);
    padding: 4px 12px;
    font-size: 0.8rem;
    font-weight: bold;
    cursor: pointer;
    transition: background-color var(--transition-speed);
}

.follow-btn:hover {
    background-color: rgba(98, 98, 98, 0.1);
}

.follow-btn.followed {
    background: var(--luxury-gradient);
    color: white;
}

/* Loading Animation - Subtle bounce */
.loading-dots {
    display: flex;
    justify-content: center;
    padding: 24px;
}

.loading-dot {
    width: 10px;
    height: 10px;
    margin: 0 5px;
    border-radius: 50%;
    background-color: var(--primary-color);
    animation: subtle-bounce 1.2s infinite ease-in-out;
}

.loading-dot:nth-child(1) {
    animation-delay: 0s;
}

.loading-dot:nth-child(2) {
    animation-delay: 0.2s;
}

.loading-dot:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes subtle-bounce {
    0%, 100% {
        transform: translateY(0);
        opacity: 0.7;
    }
    50% {
        transform: translateY(-5px);
        opacity: 1;
    }
}

.reply-wrapper {
    display: flex;
    background-color: var(--primary-light);
    border-radius: var(--border-radius-lg);
    padding: 10px 16px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    transition: background-color var(--transition-speed);
    border: 1px solid var(--border-color);
}

.reply-wrapper:focus-within {
    background-color: #e8e8e8;
}

.reply-textarea {
    flex: 1;
    background: none;
    border: none;
    color: var(--text-primary);
    font-size: 0.95rem;
    resize: none;
    padding: 0;
    outline: none;
    line-height: 1.4;
}

.reply-send {
    background: var(--luxury-gradient);
    color: white;
    border: none;
    border-radius: var(--border-radius-lg);
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    margin-left: 10px;
    transition: opacity var(--transition-speed);
    box-shadow: 0 2px 6px rgba(98, 98, 98, 0.2);
}

.reply-send:hover {
    opacity: 0.9;
}

/* Fix for blue outline on focus */
*:focus {
    outline: none;
}

/* Harvard animations - More subtle */
.harvard-logo {
    display: inline-block;
    margin-right: 8px;
    transition: opacity 0.3s ease;
}

/* Premium badge with updated color scheme */
.premium-badge {
    display: inline-block;
    padding: 3px 8px;
    background: var(--luxury-gradient);
    color: white;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: bold;
    margin-left: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    transition: opacity 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.premium-badge:hover {
    opacity: 0.9;
}

/* Borderlines for messages */
.message.incoming .message-content {
    border-left: 3px solid var(--primary-color);
}

.message.outgoing .message-content {
    border-right: 3px solid var(--primary-dark);
}

/* Media Queries for Responsiveness */
/* Tablet */
@media (max-width: 992px) {
    html {
        font-size: 15px;
    }
    
    .message-content {
        max-width: 400px;
    }
    
    .action-button {
        margin-right: 18px;
    }
}

/* Mobile Large */
@media (max-width: 768px) {
    html {
        font-size: 14px;
    }
    
    .profile-image {
        width: 36px;
        height: 36px;
        margin-right: 10px;
    }
    
    .message-content {
        max-width: 90%;
        padding: 10px 14px;
    }

    .user-name {
        font-size: 0.9rem;
    }

    .message-text {
        font-size: 0.95rem;
        line-height: 1.4;
    }

    .action-button {
        margin-right: 15px;
        font-size: 0.85rem;
    }

    .action-button svg {
        margin-right: 5px;
    }

    .input-wrapper {
        padding: 12px 14px;
    }

    .preview-item {
        width: 100px;
        height: 100px;
    }
    
    .send-button {
        width: 38px;
        height: 38px;
    }
    
    .message-image, .message-video {
        max-height: 300px;
    }
    
    .reply-input {
        padding: 10px 0 0 55px;
    }
    
    .message-time {
        font-size: 0.7rem;
    }
}

/* Mobile Small */
@media (max-width: 576px) {
    html {
        font-size: 14px;
    }
    
    .chat-container {
        padding: 10px 12px;
    }
    
    .profile-image {
        width: 32px;
        height: 32px;
        margin-right: 8px;
    }
    
    .message-content {
        max-width: 90%;
        padding: 8px 12px;
    }

    .user-name {
        font-size: 0.85rem;
        margin-bottom: 2px;
    }

    .message-text {
        margin-bottom: 4px;
        font-size: 0.9rem;
        line-height: 1.35;
    }

    .action-buttons {
        margin-top: 8px;
    }

    .action-button {
        margin-right: 14px;
        font-size: 0.8rem;
        padding: 4px;
    }

    .action-button svg {
        width: 16px;
        height: 16px;
        margin-right: 4px;
    }

    .input-container {
        padding: 10px 12px;
    }

    .input-wrapper {
        padding: 10px 14px;
    }

    .message-textarea {
        font-size: 0.95rem;
    }

    .preview-item {
        width: 80px;
        height: 80px;
    }
    
    .media-button {
        margin-right: 10px;
    }
    
    .media-button svg {
        width: 22px;
        height: 22px;
    }
    
    .send-button {
        width: 36px;
        height: 36px;
    }
    
    .message-image, .message-video {
        max-height: 250px;
    }
    
    .reply-input {
        padding: 8px 0 0 45px;
    }
    
    .reply-wrapper {
        padding: 8px 12px;
    }
    
    .reply-send {
        width: 32px;
        height: 32px;
    }
    
    .follow-btn {
        padding: 3px 8px;
        font-size: 0.7rem;
    }
    
    .message-time {
        font-size: 0.65rem;
    }
    
    .phone-number {
        font-size: 0.75rem;
    }
}

/* Extra Small Mobile */
@media (max-width: 375px) {
    .chat-container {
        padding: 8px;
    }
    
    .profile-image {
        width: 28px;
        height: 28px;
        margin-right: 6px;
    }
    
    .message-content {
        max-width: 95%;
        padding: 6px 10px;
    }
    
    .user-name {
        font-size: 0.8rem;
    }
    
    .message-text {
        font-size: 0.85rem;
    }
    
    .input-wrapper {
        padding: 8px 12px;
    }
    
    .message-textarea {
        font-size: 0.9rem;
    }
}

</style>

</head>
<body>
  <div class="chat-container" id="chatContainer">
    <div class="loading-dots" id="loadingIndicator">
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
    </div>
  </div>
  <div class="input-container">
    <div class="media-preview" id="mediaPreview"></div>
    <div class="input-wrapper">
      <textarea id="messageInput" class="message-textarea" placeholder="What's happening?" rows="1"></textarea>
      <div class="input-actions">
        <button class="media-button" id="imageButton">
          <svg viewBox="0 0 24 24">
            <path d="M19.75 2H4.25C3.01 2 2 3.01 2 4.25v15.5C2 20.99 3.01 22 4.25 22h15.5c1.24 0 2.25-1.01 2.25-2.25V4.25C22 3.01 20.99 2 19.75 2zM4.25 3.5h15.5c.413 0 .75.337.75.75v9.676l-3.858-3.858c-.14-.14-.33-.22-.53-.22h-.003c-.2 0-.393.08-.532.224l-4.317 4.384-1.813-1.806c-.14-.14-.33-.22-.53-.22-.193-.03-.395.08-.535.227L3.5 17.642V4.25c0-.413.337-.75.75-.75zm-.744 16.28l5.418-5.534 6.282 6.254H4.25c-.402 0-.727-.322-.744-.72zm16.244.72h-2.42l-5.007-4.987 3.792-3.85 4.385 4.384v3.703c0 .413-.337.75-.75.75z"></path>
            <circle cx="8.868" cy="8.309" r="1.542"></circle>
          </svg>
        </button>
        <button class="media-button" id="videoButton">
          <svg viewBox="0 0 24 24">
            <path d="M21 6.3c0-.7-.6-1.3-1.3-1.3H4.3C3.6 5 3 5.6 3 6.3v11.4c0 .7.6 1.3 1.3 1.3h15.4c.7 0 1.3-.6 1.3-1.3V6.3zm-2 0v11.4H5V6.3h14z"></path>
            <path d="M9.6 15l5.1-3-5.1-3v6z"></path>
          </svg>
        </button>
        <input type="file" id="imageInput" class="file-input" accept="image/*">
        <input type="file" id="videoInput" class="file-input" accept="video/*">
        <button id="sendButton" class="send-button" disabled>
          <svg viewBox="0 0 24 24">
            <path d="M2.252 6.456l19.476 5.825c.53.159.53.928 0 1.088L2.252 19.194c-.43.129-.81-.303-.53-.604l4.309-4.672c.45-.487.45-1.256 0-1.742L1.722 7.06c-.28-.302.1-.733.53-.604z"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

<script>
  (function() {
    // Wait until DOM is fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      const chatContainer = document.getElementById('chatContainer');
      if (!chatContainer) return;
      
      // Variables to track user scrolling behavior
      let userIsScrolling = false;
      let userScrollTimeout;
      let lastScrollTop = 0;
      
      // Detect when user is manually scrolling
      chatContainer.addEventListener('scroll', function() {
        userIsScrolling = true;
        lastScrollTop = chatContainer.scrollTop;
        
        // Reset the scrolling flag after user stops scrolling
        clearTimeout(userScrollTimeout);
        userScrollTimeout = setTimeout(function() {
          userIsScrolling = false;
        }, 1000);
      });
      
      // Function to check if user is near bottom
      function isNearBottom() {
        const threshold = 150; // pixels from bottom to consider "near bottom"
        const position = chatContainer.scrollHeight - chatContainer.scrollTop - chatContainer.clientHeight;
        return position < threshold;
      }
      
      // Smooth scroll function with easing
      function smoothScrollToBottom() {
        if (!chatContainer) return;
        
        // Don't interrupt if user is actively scrolling
        if (userIsScrolling) return;
        
        // Only scroll if user is already near the bottom
        if (!isNearBottom()) return;
        
        const startPosition = chatContainer.scrollTop;
        const endPosition = chatContainer.scrollHeight - chatContainer.clientHeight;
        const distance = endPosition - startPosition;
        
        // No need to animate if already at bottom or distance is tiny
        if (distance < 5) {
          chatContainer.scrollTop = endPosition;
          return;
        }
        
        // Use more gentle animation
        const duration = 600; // longer duration = smoother feel
        const startTime = performance.now();
        
        function easeOutCubic(t) {
          return 1 - Math.pow(1 - t, 3);
        }
        
        function animationStep(currentTime) {
          const elapsed = currentTime - startTime;
          
          if (elapsed < duration) {
            // Apply easing function for smoother motion
            const progress = easeOutCubic(elapsed / duration);
            
            // Skip animation if user started scrolling manually
            if (userIsScrolling) return;
            
            chatContainer.scrollTop = startPosition + distance * progress;
            requestAnimationFrame(animationStep);
          } else {
            chatContainer.scrollTop = endPosition;
          }
        }
        
        requestAnimationFrame(animationStep);
      }
      
      // Initial scroll to bottom (once when page loads)
      setTimeout(function() {
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }, 500);
      
      // Watch for new messages and scroll when appropriate
      const observer = new MutationObserver(function(mutations) {
        let newMessageAdded = false;
        
        mutations.forEach(function(mutation) {
          if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
            for (let i = 0; i < mutation.addedNodes.length; i++) {
              const node = mutation.addedNodes[i];
              if (node.classList && (node.classList.contains('message') ||
                  node.querySelector && node.querySelector('.message'))) {
                newMessageAdded = true;
                break;
              }
            }
          }
        });
        
        if (newMessageAdded) {
          // Use small timeout to ensure rendering is complete
          setTimeout(smoothScrollToBottom, 100);
        }
      });
      
      // Start observing the chat container
      observer.observe(chatContainer, {
        childList: true,
        subtree: true
      });
    });
  })();
</script>


<script>

(function() {
  // Enhanced Global Chat Theme Manager with Perfect Dim Theme Matching
  const GlobalChatThemeManager = {
    themeConfig: {
      light: {
        '--primary-color': '#626262',
        '--primary-light': '#f0f0f0',
        '--primary-dark': '#3a3a3a',
        '--text-primary': '#333',
        '--text-secondary': '#666',
        '--background-light': '#f9f9f9',
        '--background-white': '#ffffff',
        '--border-light': '#e0e0e0',
        '--border-color': '#dadada',
        '--box-shadow': '0 2px 10px rgba(0, 0, 0, 0.05)',
        '--luxury-gradient': 'linear-gradient(135deg, #0f0f0f 0%, #1c1c1c 15%, #3a3a3a 30%, #4d4d4d 45%, #626262 60%, #787878 75%, #8f8f8f 90%, #a6a6a6 100%)',
        '--message-hover': '#f8f8f8',
        '--outgoing-hover': '#e5e5e5',
        '--image-hover': 'brightness(1.05)',
        '--follow-button-text': '#ffffff' // White text for follow button in light theme
      },
      dim: {
        // Core Colors (modified to remove blue)
        '--primary-color': '#8899a6', // Changed from blue to gray
        '--primary-light': '#1e2732', // Card BG
        '--primary-dark': '#667787', // Darker gray instead of blue
        '--text-primary': '#ffffff', // White text
        '--text-secondary': '#8899a6', // Grayish text
        '--background-light': '#15202b', // Main BG
        '--background-white': '#1e2732', // Card BG
        '--border-light': '#38444d', // Borders
        '--border-color': '#38444d', // Same as above
        '--box-shadow': '0 2px 10px rgba(0, 0, 0, 0.15)',
        
        // Luxury Gradient (preserved)
        '--luxury-gradient': 'linear-gradient(135deg, #f8f8f8 0%, #e8e8e8 15%, #d8d8d8 30%, #c8c8c8 45%, #b8b8b8 60%, #a8a8a8 75%, #989898 90%, #888888 100%)',
        
        // Interactive States (updated to remove blue)
        '--hover': 'rgba(136, 153, 166, 0.1)', // Gray hover tint (10% opacity)
        '--message-hover': '#253341', // Message hover
        '--outgoing-hover': '#1e2d3d', // Darker hover for sent messages
        '--image-hover': 'brightness(1.08)', // Subtle media hover
        
        // Special Cases
        '--card-bg': '#1e2732', // Explicit card background
        '--follow-button-text': '#000000' // Black text for follow button in dim theme
      },
      dark: {
        '--primary-color': '#a6a6a6', // Lighter gray for better visibility on dark
        '--primary-light': '#000000', // Pure black
        '--primary-dark': '#4d4d4d', // Dark gray
        '--text-primary': '#ffffff', // Pure white
        '--text-secondary': '#8f8f8f', // Medium gray
        '--background-light': '#000000', // Pure black background
        '--background-white': '#080808', // Very dark gray for message boxes
        '--border-light': '#1a1a1a', // Dark border
        '--border-color': '#121212', // Even darker border
        '--box-shadow': '0 2px 10px rgba(0, 0, 0, 0.4)',
        '--luxury-gradient': 'linear-gradient(135deg, #f8f8f8 0%, #e8e8e8 15%, #d8d8d8 30%, #c8c8c8 45%, #b8b8b8 60%, #a8a8a8 75%, #989898 90%, #888888 100%)',
        '--message-hover': '#121212', // Slightly lighter than message box
        '--outgoing-hover': '#0a0a0a', // Darker hover for outgoing
        '--image-hover': 'brightness(1.2)', // Stronger hover effect
        '--follow-button-text': '#000000' // Black text for follow button in dark theme
      }
    },
    
    styleElementId: 'global-chat-theme-manager-styles',
    
    initialize: function() {
      this.createStyleElement();
      this.applyCurrentTheme();
      this.setupEventListeners();
    },
    
    createStyleElement: function() {
      const existingStyle = document.getElementById(this.styleElementId);
      if (existingStyle) existingStyle.remove();
      
      const styleElement = document.createElement('style');
      styleElement.id = this.styleElementId;
      styleElement.setAttribute('data-origin', 'global-chat-theme-manager');
      document.head.appendChild(styleElement);
    },
    
    applyCurrentTheme: function() {
      const themeName = localStorage.getItem('twitter-theme') || 'light';
      this.applyTheme(themeName);
    },
    
    applyTheme: function(themeName) {
      const validThemes = ['light', 'dim', 'dark'];
      const theme = validThemes.includes(themeName) ? themeName : 'light';
      const themeVars = this.themeConfig[theme] || this.themeConfig.light;
      const styleElement = document.getElementById(this.styleElementId);
      
      if (!styleElement) {
        this.createStyleElement();
        return this.applyTheme(theme);
      }
      
      let css = ':root {\n';
      Object.entries(themeVars).forEach(([key, value]) => {
        css += `  ${key}: ${value};\n`;
      });
      css += '}\n\n';
      
      // Enhanced hover and animation styles
      css += `
      /* Message hover effects */
      .message-content:hover {
        background-color: var(--message-hover) !important;
        transition: background-color 0.2s ease;
      }
      
      .message.outgoing .message-content:hover {
        background-color: var(--outgoing-hover) !important;
      }
      
      /* Image hover effects */
      .message-image:hover {
        filter: var(--image-hover);
        transition: filter 0.3s ease;
      }
      
      /* Profile image hover */
      .profile-image:hover {
        transform: scale(1.05);
        transition: transform 0.3s ease;
      }
      
      /* Action button hover */
      .action-button:hover {
        color: var(--primary-color);
        transition: color var(--transition-speed);
      }
      
      .action-button:hover svg {
        color: var(--primary-dark);
      }
      
      /* Media button hover */
      .media-button:hover {
        color: var(--primary-dark);
        opacity: 1;
        transition: color var(--transition-speed), opacity var(--transition-speed);
      }
      
      /* Send button hover */
      .send-button:hover:not(:disabled),
      .reply-send:hover {
        opacity: 0.9;
        transition: opacity var(--transition-speed);
      }
      
      /* Follow button styles */
      .follow-btn {
        color: var(--follow-button-text) !important;
      }
      
      /* Follow button hover */
      .follow-btn:hover {
        background-color: rgba(98, 98, 98, 0.1);
        transition: background-color var(--transition-speed);
      }
      
      /* Remove media button hover */
      .remove-media:hover {
        background-color: rgba(240, 40, 40, 0.8);
        transition: background-color var(--transition-speed);
      }
      
      /* Input focus effects */
      .input-wrapper:focus-within {
        box-shadow: 0 0 0 3px rgba(98, 98, 98, 0.3);
        transition: box-shadow var(--transition-speed);
      }
      
      /* Reply wrapper focus */
      .reply-wrapper:focus-within {
        background-color: #e8e8e8;
        transition: background-color var(--transition-speed);
      }
      `;
      
      styleElement.textContent = css;
    },
    
    setupEventListeners: function() {
      window.addEventListener('storage', (e) => {
        if (e.key === 'twitter-theme') {
          this.applyTheme(e.newValue || 'light');
        }
      });
      
      this.setupPeriodicCheck();
    },
    
    setupPeriodicCheck: function() {
      let lastKnownTheme = localStorage.getItem('twitter-theme') || 'light';
      setInterval(() => {
        const currentTheme = localStorage.getItem('twitter-theme');
        if (currentTheme !== lastKnownTheme) {
          lastKnownTheme = currentTheme || 'light';
          this.applyTheme(lastKnownTheme);
        }
      }, 3000);
    }
  };
  
  function initializeThemeManager() {
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        GlobalChatThemeManager.initialize();
      });
    } else {
      GlobalChatThemeManager.initialize();
    }
  }
  
  setTimeout(initializeThemeManager, 100);
})();

</script>

<script>

(function() {
  // Language Sync Manager - Optimized version
  const LanguageSyncManager = {
    originalLanguage: document.documentElement.lang || 'en',
    currentLanguage: null,
    isTranslating: false,
    translationTimeout: null,
    
    initialize: function() {
      // Create necessary elements
      this.createLoadingIndicator();
      this.createGoogleTranslateElement();
      
      // Check saved language preference
      const savedLanguage = localStorage.getItem('preferredLanguage');
      if (savedLanguage && savedLanguage !== this.originalLanguage) {
        this.currentLanguage = savedLanguage;
        this.showLoading();
        // Short delay to ensure DOM is ready
        setTimeout(() => this.loadGoogleTranslateScript(), 100);
      }
      
      // Setup event listeners
      this.setupEventListeners();
      
      // Add additional hiding mechanism
      this.setupTranslateElementHider();
      console.log('Language Sync Manager initialized');
    },
    
    createLoadingIndicator: function() {
      const loadingOverlay = document.createElement('div');
      loadingOverlay.className = 'language-loading-overlay';
      loadingOverlay.innerHTML = `
        <div class="language-loading-spinner">
          <div class="language-loading-dot"></div>
          <div class="language-loading-dot"></div>
          <div class="language-loading-dot"></div>
        </div>
      `;
      document.body.appendChild(loadingOverlay);
      
      // Add the styles with improved hiding selectors
      const style = document.createElement('style');
      style.textContent = `
        .language-loading-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(255, 255, 255, 0.7);
          z-index: 9999;
          display: flex;
          justify-content: center;
          align-items: center;
          opacity: 0;
          visibility: hidden;
          transition: opacity 0.2s ease;
        }
        
        .language-loading-overlay.active {
          opacity: 1;
          visibility: visible;
        }
        
        .language-loading-spinner {
          display: flex;
          gap: 5px;
        }
        
        .language-loading-dot {
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background-color: #4a90e2;
          animation: language-loading-bounce 1.4s infinite ease-in-out both;
        }
        
        .language-loading-dot:nth-child(1) {
          animation-delay: -0.32s;
        }
        
        .language-loading-dot:nth-child(2) {
          animation-delay: -0.16s;
        }
        
        @keyframes language-loading-bounce {
          0%, 80%, 100% {
            transform: scale(0);
          }
          40% {
            transform: scale(1);
          }
        }
        
        /* Comprehensive Google element hiding */
        .goog-te-banner-frame,
        .goog-te-balloon-frame,
        #goog-gt-tt,
        .goog-tooltip,
        .goog-tooltip:hover,
        .goog-text-highlight,
        .VIpgJd-ZVi9od-l4eHX-hSRGPd,
        .VIpgJd-ZVi9od-ORHb-OEVmcd,
        .VIpgJd-ZVi9od-SmfZ-OEVmcd-tJHJj,
        .goog-te-gadget,
        .goog-logo-link,
        .goog-te-combo,
        .skiptranslate,
        .goog-te-banner-frame,
        iframe[name="googleTranslateElementInitialIframe"],
        iframe.goog-te-menu-frame,
        iframe.VIpgJd-ZVi9od-SmfZ-OEVmcd-tJHJj,
        .VIpgJd-yAWNEb-L7lbkb,
        #goog-gt-,
        .goog-te-menu-value,
        div#goog-gt-,
        #goog-gt-tt.skiptranslate,
        .goog-te-spinner-pos,
        .goog-te-spinner,
        .goog-te-banner-frame.skiptranslate,
        .goog-te-sectional-gadget {
          display: none !important;
          visibility: hidden !important;
          opacity: 0 !important;
          height: 0 !important;
          width: 0 !important;
          border: none !important;
          position: absolute !important;
          top: -9999px !important;
          left: -9999px !important;
          pointer-events: none !important;
          max-height: 0 !important;
          max-width: 0 !important;
          transform: scale(0) !important;
        }
        
        body {
          top: 0 !important;
          position: static !important;
        }
        
        /* Additional fixes to prevent any translation UI */
        .VIpgJd-ZVi9od-aZ2wEe-wOHMyf,
        .VIpgJd-ZVi9od-aZ2wEe-OiiCO,
        .VIpgJd-ZVi9od-aZ2wEe {
          display: none !important;
          height: 0 !important;
        }
        
        /* Fix for top bar spacing issue */
        html[translated], 
        body[translated] {
          margin-top: 0 !important;
          padding-top: 0 !important;
        }
      `;
      
      document.head.appendChild(style);
    },
    
    createGoogleTranslateElement: function() {
      // Create hidden Google Translate element
      const translateElement = document.createElement('div');
      translateElement.id = 'google_translate_element';
      translateElement.style.cssText = 'position:absolute;top:-9999px;left:-9999px;width:0;height:0;visibility:hidden;opacity:0;pointer-events:none;overflow:hidden;';
      document.body.appendChild(translateElement);
    },
    
    setupTranslateElementHider: function() {
      // Continuous hiding of Google elements
      const hideGoogleElements = () => {
        // List of selectors that Google Translate might create
        const selectors = [
          '.goog-te-banner-frame',
          '.goog-te-menu-frame',
          '.goog-tooltip',
          '.skiptranslate',
          'iframe.goog-te-menu-frame',
          '#goog-gt-tt',
          '.VIpgJd-ZVi9od-l4eHX-hSRGPd',
          '.VIpgJd-ZVi9od-ORHb-OEVmcd',
          '.VIpgJd-ZVi9od-SmfZ-OEVmcd-tJHJj'
        ];
        
        selectors.forEach(selector => {
          const elements = document.querySelectorAll(selector);
          elements.forEach(el => {
            if (el && el.style) {
              el.style.display = 'none';
              el.style.visibility = 'hidden';
              el.style.opacity = '0';
              el.style.height = '0';
              el.style.width = '0';
              el.style.border = 'none';
              el.style.position = 'absolute';
              el.style.top = '-9999px';
              el.style.left = '-9999px';
              el.style.pointerEvents = 'none';
            }
          });
        });
        
        // Fix body positioning if Google modified it
        if (document.body.style.top && document.body.style.top !== '0px') {
          document.body.style.top = '0px';
          document.body.style.position = 'static';
        }
      };
      
      // Run immediately
      hideGoogleElements();
      
      // Then set up interval to keep hiding them
      setInterval(hideGoogleElements, 500);
      
      // Also hide on DOM changes
      const observer = new MutationObserver(hideGoogleElements);
      observer.observe(document.body, { 
        childList: true, 
        subtree: true 
      });
    },
    
    loadGoogleTranslateScript: function() {
      // If already loaded, apply translation directly
      if (window.google && window.google.translate) {
        this.applyTranslation();
        return;
      }
      
      // Define callback for Google Translate
      window.googleTranslateElementInit = () => {
        new google.translate.TranslateElement({
          pageLanguage: this.originalLanguage,
          autoDisplay: false,
          includedLanguages: '', // Load all languages for flexibility
          layout: google.translate.TranslateElement.InlineLayout.SIMPLE
        }, 'google_translate_element');
        
        // Apply translation immediately after init
        setTimeout(() => this.applyTranslation(), 300);
      };
      
      // Load Google Translate script
      const script = document.createElement('script');
      script.src = 'https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
      script.async = true;
      document.head.appendChild(script);
      
      // Set timeout to hide loading if translation takes too long
      this.translationTimeout = setTimeout(() => {
        if (this.isTranslating) {
          this.hideLoading();
        }
      }, 5000);
    },
    
    applyTranslation: function() {
      if (!this.currentLanguage || this.currentLanguage === this.originalLanguage) {
        this.hideLoading();
        return;
      }
      
      // Try multiple methods to apply translation
      
      // Method 1: Using the dropdown
      const selectElement = document.querySelector('.goog-te-combo');
      if (selectElement) {
        selectElement.value = this.currentLanguage;
        const event = new Event('change', { bubbles: true });
        selectElement.dispatchEvent(event);
      }
      
      // Method 2: Using cookies
      const domain = window.location.hostname;
      document.cookie = `googtrans=/auto/${this.currentLanguage}; domain=${domain}; path=/;`;
      document.cookie = `googtrans=/auto/${this.currentLanguage}; domain=.${domain}; path=/;`;
      
      // Method 3: Using direct API if available
      if (window.google && window.google.translate && window.google.translate.TranslateElement) {
        try {
          const te = google.translate.TranslateElement.getInstance();
          if (te) {
            te.selectLanguage(this.currentLanguage);
          }
        } catch (e) {
          console.log('Direct translation method failed, using alternatives');
        }
      }
      
      // Monitor DOM for translation changes
      this.monitorTranslationChanges();
    },
    
    monitorTranslationChanges: function() {
      // Check for translation immediately
      const checkTranslation = () => {
        // Various indicators that translation has occurred
        const isTranslated = 
          document.body.classList.contains('translated-ltr') || 
          document.body.classList.contains('translated-rtl') ||
          document.documentElement.classList.contains('translated-ltr') ||
          document.documentElement.classList.contains('translated-rtl') ||
          document.cookie.includes('googtrans') ||
          document.querySelector('.goog-te-banner-frame') !== null ||
          document.querySelector('.skiptranslate') !== null;
        
        if (isTranslated) {
          this.hideLoading();
          return true;
        }
        return false;
      };
      
      // If translation detected immediately
      if (checkTranslation()) return;
      
      // Set up a mutation observer to detect when translation happens
      const translationObserver = new MutationObserver((mutations) => {
        if (checkTranslation()) {
          translationObserver.disconnect();
        }
      });
      
      translationObserver.observe(document.documentElement, {
        attributes: true,
        childList: true,
        subtree: true,
        attributeFilter: ['class']
      });
      
      // Fallback: hide loading after 3 seconds anyway
      setTimeout(() => {
        this.hideLoading();
        translationObserver.disconnect();
      }, 3000);
    },
    
    resetToOriginal: function() {
      // Clear translation cookies
      const domain = window.location.hostname;
      document.cookie = `googtrans=; expires=Thu, 01 Jan 1970 00:00:00 UTC; domain=${domain}; path=/;`;
      document.cookie = `googtrans=; expires=Thu, 01 Jan 1970 00:00:00 UTC; domain=.${domain}; path=/;`;
      document.cookie = `googtrans=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
      
      // Force reload to clear translation (most reliable method)
      location.reload();
    },
    
    setupEventListeners: function() {
      // Listen for localStorage changes
      window.addEventListener('storage', (e) => {
        if (e.key === 'preferredLanguage') {
          const newLanguage = e.newValue;
          
          // Only process if language actually changed
          if (newLanguage !== this.currentLanguage) {
            this.currentLanguage = newLanguage;
            
            if (newLanguage && newLanguage !== this.originalLanguage) {
              this.showLoading();
              // If Google Translate already loaded, apply directly
              if (window.google && window.google.translate) {
                this.applyTranslation();
              } else {
                this.loadGoogleTranslateScript();
              }
            } else {
              this.resetToOriginal();
            }
          }
        }
      });
      
      // Listen for color preferences for loading dots
      window.addEventListener('storage', (e) => {
        if (e.key === 'color-value' && e.newValue) {
          const dots = document.querySelectorAll('.language-loading-dot');
          dots.forEach(dot => {
            dot.style.backgroundColor = e.newValue;
          });
        }
      });
      
      // Check for color preference immediately
      const savedColor = localStorage.getItem('color-value');
      if (savedColor) {
        const dots = document.querySelectorAll('.language-loading-dot');
        dots.forEach(dot => {
          dot.style.backgroundColor = savedColor;
        });
      }
      
      // Handle page visibility changes to manage translation UI
      document.addEventListener('visibilitychange', () => {
        if (!document.hidden && this.currentLanguage && this.currentLanguage !== this.originalLanguage) {
          this.setupTranslateElementHider();
        }
      });
      
      // Handle after page loads completely
      window.addEventListener('load', () => {
        // Re-hide elements after page is fully loaded
        setTimeout(() => this.setupTranslateElementHider(), 500);
      });
    },
    
    showLoading: function() {
      this.isTranslating = true;
      const overlay = document.querySelector('.language-loading-overlay');
      if (overlay) overlay.classList.add('active');
      
      // Clear any existing timeout
      if (this.translationTimeout) {
        clearTimeout(this.translationTimeout);
      }
    },
    
    hideLoading: function() {
      this.isTranslating = false;
      const overlay = document.querySelector('.language-loading-overlay');
      if (overlay) overlay.classList.remove('active');
      
      // Additional cleaning to hide Google elements
      setTimeout(() => this.setupTranslateElementHider(), 100);
      
      // Clear any existing timeout
      if (this.translationTimeout) {
        clearTimeout(this.translationTimeout);
        this.translationTimeout = null;
      }
    }
  };
  
  // Initialize immediately
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => LanguageSyncManager.initialize());
  } else {
    LanguageSyncManager.initialize();
  }
})();

</script>

<script type="module" src="chat.js"></script>
<script src="loadfollow.js"></script>
<script src="remove.js"></script>
<script src="reply.js"></script>
<script src="autoscroll.js"></script>
<script src="ad.js"></script>

<script src="viewprof.js"></script>
<script src="replyhighl.js"></script>
<script src="theme.js"></script>
<script src="link.js"></script>
<script src="check.js"></script>
<script src="sound.js"></script>
<script src="mark.js"></script>
<script src="share.js"></script>
<script src="comment.js"></script>






<script>
  // Font size synchronization script
  (function() {
    // Function to apply font size from localStorage
    function applyFontSize() {
      const size = localStorage.getItem('font-size') || '1';
      document.body.style.fontSize = size + 'rem';
      
      // Add scaling to different elements if needed
      const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
      const paragraphs = document.querySelectorAll('p');
      const buttons = document.querySelectorAll('button');
      const inputs = document.querySelectorAll('input');
      
      headings.forEach(heading => {
        const currentSize = window.getComputedStyle(heading).fontSize;
        const baseSize = parseFloat(currentSize) / 16; // convert to rem
        heading.style.fontSize = (baseSize * parseFloat(size)) + 'rem';
      });
      
      paragraphs.forEach(p => {
        p.style.fontSize = size + 'rem';
      });
      
      buttons.forEach(button => {
        button.style.fontSize = (parseFloat(size) * 0.9) + 'rem';
      });
      
      inputs.forEach(input => {
        input.style.fontSize = size + 'rem';
      });
    }
    
    // Apply immediately
    applyFontSize();
    
    // Listen for changes
    window.addEventListener('storage', function(event) {
      if (event.key === 'font-size') {
        applyFontSize();
      }
    });
    
    // Check every second for changes (backup method)
    setInterval(function() {
      const currentSize = document.body.style.fontSize;
      const savedSize = localStorage.getItem('font-size') || '1';
      
      if (currentSize !== savedSize + 'rem') {
        applyFontSize();
      }
    }, 1000);
  })();
</script>



<script>
  (function() {
  'use strict';
  
  document.addEventListener('DOMContentLoaded', function() {
    // Configuration - make these unique to our script
    const MAX_LENGTH = 60;
    const TEXT_CONTAINER_CLASS = 'text-container-js';
    const TOGGLE_BUTTON_CLASS = 'toggle-button-js';
    const EXPANDED_ATTR = 'data-js-expanded';
    
    // Style for our specific button
    const style = document.createElement('style');
    style.textContent = `
      .${TOGGLE_BUTTON_CLASS} {
          background: linear-gradient(90deg, rgba(74,144,226,0.2) 0%, rgba(74,144,226,0.1) 100%);
          border: none;
          border-radius: 12px;
          color: #4a90e2;
          cursor: pointer;
          font-size: 10px;
          margin-left: 5px;
          padding: 2px 6px;
          transition: all 0.2s ease;
      }
      
      .${TEXT_CONTAINER_CLASS} {
          display: inline;
      }
      
      /* Ensure our buttons work in the modal too */
      .full-message-modal .${TOGGLE_BUTTON_CLASS} {
          font-size: 12px;
          padding: 3px 8px;
      }
    `;
    document.head.appendChild(style);
    
    // Process all messages
    function initMessages() {
      const messageTexts = document.querySelectorAll('.message-text:not([data-js-processed])');
      
      messageTexts.forEach(el => {
        // Mark as processed to avoid duplicate processing
        el.setAttribute('data-js-processed', 'true');
        
        const text = el.textContent.trim();
        if (text.length <= MAX_LENGTH) return;
        
        // Wrap content in our own container
        const container = document.createElement('span');
        container.className = TEXT_CONTAINER_CLASS;
        
        // Create truncated version
        const shortText = text.substring(0, MAX_LENGTH) + '...';
        container.textContent = shortText;
        container.setAttribute(EXPANDED_ATTR, 'false');
        container.setAttribute('data-js-full-text', text);
        
        // Clear existing content and add our container
        el.textContent = '';
        el.appendChild(container);
        
        // Add our toggle button
        const btn = document.createElement('button');
        btn.className = TOGGLE_BUTTON_CLASS;
        btn.textContent = 'Show More';
        btn.onclick = function(e) {
          e.stopPropagation(); // Prevent triggering the full-screen modal
          toggleText(container, btn);
        };
        el.appendChild(btn);
      });
    }
    
    // Toggle between short/long text
    function toggleText(container, btn) {
      if (container.getAttribute(EXPANDED_ATTR) === 'true') {
        container.textContent = container.getAttribute('data-js-full-text').substring(0, MAX_LENGTH) + '...';
        btn.textContent = 'Show More';
        container.setAttribute(EXPANDED_ATTR, 'false');
      } else {
        container.textContent = container.getAttribute('data-js-full-text');
        btn.textContent = 'Show Less';
        container.setAttribute(EXPANDED_ATTR, 'true');
      }
    }
    
    // Initialize and watch for new messages
    initMessages();
    
    // Use a more specific observer that only looks for new messages
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(mutation => {
        if (mutation.addedNodes.length) {
          // Process both regular messages and modal messages
          const newMessages = document.querySelectorAll(
            '.message-text:not([data-js-processed]), .full-message-modal .message-text:not([data-js-processed])'
          );
          if (newMessages.length) {
            initMessages();
          }
        }
      });
    });
    
    // Observe both the main chat and any potential modals
    const chatContainer = document.getElementById('chatContainer');
    if (chatContainer) {
      observer.observe(chatContainer, {
        childList: true,
        subtree: true
      });
    }
    
    // Also observe the body for modals being added
    const modalObserver = new MutationObserver(function(mutations) {
      mutations.forEach(mutation => {
        mutation.addedNodes.forEach(node => {
          if (node.classList && node.classList.contains('full-message-modal')) {
            // When modal appears, process its text
            initMessages();
          }
        });
      });
    });
    
    modalObserver.observe(document.body, {
      childList: true,
      subtree: false
    });
  });
})();
</script>


<script>
// Self-executing function to avoid conflicts with global scope
(function() {
  // Configuration with unique identifiers
  const MEDIA_GRID_CLASS = 'gc-media-grid-v1';
  const MEDIA_ITEM_CLASS = 'gc-media-item-v1';
  const STYLE_ID = 'gc-media-grid-styles-v1';
  const MAX_VISIBLE_ITEMS = 4;
  
  // Store original showFullImage function if it exists
  const originalShowFullImage = window.showFullImage;
  
  // Add styles only once
  function addStyles() {
    if (!document.getElementById(STYLE_ID)) {
      const style = document.createElement('style');
      style.id = STYLE_ID;
      style.textContent = `
        .${MEDIA_GRID_CLASS} {
          display: grid;
          gap: 4px;
          margin-top: 8px;
          width: 100%;
          max-height: 500px;
          border-radius: 12px;
          overflow: hidden;
        }
        
        .${MEDIA_ITEM_CLASS} {
          position: relative;
          overflow: hidden;
          border: 1px solid rgba(0,0,0,0.1);
          background-color: #f5f5f5;
        }
        
        .${MEDIA_ITEM_CLASS} img, 
        .${MEDIA_ITEM_CLASS} video {
          width: 100%;
          height: 100%;
          object-fit: cover;
          display: block;
          transition: transform 0.3s ease;
        }
        
        .${MEDIA_ITEM_CLASS}:hover img,
        .${MEDIA_ITEM_CLASS}:hover video {
          transform: scale(1.03);
        }
        
        .${MEDIA_ITEM_CLASS} .overlay-count {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0,0,0,0.5);
          color: white;
          font-size: 24px;
          font-weight: bold;
          display: flex;
          justify-content: center;
          align-items: center;
          cursor: pointer;
        }
        
        /* Single media item */
        .${MEDIA_GRID_CLASS}[data-item-count="1"] {
          grid-template-columns: 1fr;
          aspect-ratio: 16/9;
          max-height: 400px;
        }
        
        /* Two media items */
        .${MEDIA_GRID_CLASS}[data-item-count="2"] {
          grid-template-columns: repeat(2, 1fr);
          aspect-ratio: 16/9;
        }
        
        /* Three media items */
        .${MEDIA_GRID_CLASS}[data-item-count="3"] {
          grid-template-columns: repeat(2, 1fr);
          grid-template-rows: 1fr 1fr;
          aspect-ratio: 16/10;
        }
        
        .${MEDIA_GRID_CLASS}[data-item-count="3"] .${MEDIA_ITEM_CLASS}:first-child {
          grid-row: span 2;
        }
        
        /* Four or more media items */
        .${MEDIA_GRID_CLASS}[data-item-count="4"],
        .${MEDIA_GRID_CLASS}[data-item-count="more"] {
          grid-template-columns: repeat(2, 1fr);
          grid-template-rows: repeat(2, 1fr);
          aspect-ratio: 16/14;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
          .${MEDIA_GRID_CLASS} {
            max-height: 400px;
          }
        }
        
        @media (max-width: 480px) {
          .${MEDIA_GRID_CLASS} {
            max-height: 300px;
          }
        }
      `;
      document.head.appendChild(style);
    }
  }
  
  // Process all media containers
  function initMediaGrids() {
    const mediaContainers = document.querySelectorAll('.media-container:not([data-gc-processed])');
    
    mediaContainers.forEach(container => {
      // Mark as processed
      container.setAttribute('data-gc-processed', 'true');
      
      const mediaItems = container.querySelectorAll('img, video');
      if (mediaItems.length === 0) return;
      
      // Create our grid container
      const grid = document.createElement('div');
      grid.className = MEDIA_GRID_CLASS;
      
      const itemCount = mediaItems.length;
      const displayCount = Math.min(itemCount, MAX_VISIBLE_ITEMS);
      
      grid.setAttribute('data-item-count', itemCount > MAX_VISIBLE_ITEMS ? 'more' : itemCount.toString());
      
      // Add each media item to the grid
      for (let i = 0; i < displayCount; i++) {
        const item = mediaItems[i];
        const gridItem = document.createElement('div');
        gridItem.className = MEDIA_ITEM_CLASS;
        
        // Clone the media element
        const mediaClone = item.cloneNode(true);
        
        // Preserve original click handlers and attributes
        if (item.onclick) {
          mediaClone.onclick = item.onclick;
        } else if (item.getAttribute('onclick')) {
          mediaClone.setAttribute('onclick', item.getAttribute('onclick'));
        }
        
        gridItem.appendChild(mediaClone);
        
        // Add "+" overlay to the last visible item if there are more than MAX_VISIBLE_ITEMS
        if (i === MAX_VISIBLE_ITEMS - 1 && itemCount > MAX_VISIBLE_ITEMS) {
          const overlay = document.createElement('div');
          overlay.className = 'overlay-count';
          overlay.textContent = `+${itemCount - MAX_VISIBLE_ITEMS}`;
          
          // When clicking the overlay, show all images
          overlay.addEventListener('click', function(e) {
            e.stopPropagation();
            showAllMedia(Array.from(mediaItems));
          });
          
          gridItem.appendChild(overlay);
        }
        
        grid.appendChild(gridItem);
      }
      
      // Replace the original container with our grid
      container.innerHTML = '';
      container.appendChild(grid);
    });
  }
  
  // Function to show all media in a full-screen gallery
  function showAllMedia(mediaItems) {
    // Use the original showFullImage function if it's for a single image
    if (mediaItems.length === 1 && mediaItems[0].tagName.toLowerCase() === 'img' && typeof originalShowFullImage === 'function') {
      originalShowFullImage(mediaItems[0].src);
      return;
    }
    
    // Create modal container
    const modal = document.createElement('div');
    modal.style.position = 'fixed';
    modal.style.top = '0';
    modal.style.left = '0';
    modal.style.width = '100%';
    modal.style.height = '100%';
    modal.style.backgroundColor = 'rgba(0, 0, 0, 0.9)';
    modal.style.display = 'flex';
    modal.style.flexDirection = 'column';
    modal.style.alignItems = 'center';
    modal.style.justifyContent = 'center';
    modal.style.zIndex = '1000';
    
    // Create close button
    const closeBtn = document.createElement('div');
    closeBtn.textContent = '×';
    closeBtn.style.position = 'absolute';
    closeBtn.style.top = '20px';
    closeBtn.style.right = '30px';
    closeBtn.style.color = 'white';
    closeBtn.style.fontSize = '40px';
    closeBtn.style.cursor = 'pointer';
    closeBtn.style.zIndex = '1001';
    closeBtn.onclick = () => document.body.removeChild(modal);
    
    // Create gallery container
    const gallery = document.createElement('div');
    gallery.style.display = 'flex';
    gallery.style.flexWrap = 'wrap';
    gallery.style.justifyContent = 'center';
    gallery.style.alignItems = 'center';
    gallery.style.gap = '10px';
    gallery.style.maxWidth = '90%';
    gallery.style.maxHeight = '90%';
    gallery.style.overflowY = 'auto';
    gallery.style.padding = '20px';
    
    // Add all media items to gallery
    mediaItems.forEach(item => {
      if (item.tagName.toLowerCase() === 'video') {
        const video = document.createElement('video');
        video.src = item.src;
        video.controls = true;
        video.style.maxWidth = '100%';
        video.style.maxHeight = '80vh';
        video.style.margin = '10px';
        video.style.objectFit = 'contain';
        video.style.borderRadius = '8px';
        video.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
        gallery.appendChild(video);
      } else {
        const img = document.createElement('img');
        img.src = item.src;
        img.style.maxWidth = '100%';
        img.style.maxHeight = '80vh';
        img.style.margin = '10px';
        img.style.objectFit = 'contain';
        img.style.borderRadius = '8px';
        img.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
        gallery.appendChild(img);
      }
    });
    
    modal.appendChild(closeBtn);
    modal.appendChild(gallery);
    document.body.appendChild(modal);
    
    // Close modal when clicking outside the content
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        document.body.removeChild(modal);
      }
    });
  }
  
  // Function to set up observers
  function setupObservers() {
    // Create an observer to detect new messages
    const observer = new MutationObserver(function(mutations) {
      let hasNewNodes = false;
      
      mutations.forEach(mutation => {
        if (mutation.addedNodes.length) {
          hasNewNodes = true;
        }
      });
      
      if (hasNewNodes) {
        initMediaGrids();
      }
    });
    
    // Start observing the chat container for changes
    const chatContainer = document.getElementById('chatContainer');
    if (chatContainer) {
      observer.observe(chatContainer, {
        childList: true,
        subtree: true
      });
    }
  }
  
  // Main init function
  function init() {
    // Add styles
    addStyles();
    
    // Process existing media
    initMediaGrids();
    
    // Set up observers
    setupObservers();
    
    // Monitor for dynamically added modal content
    document.body.addEventListener('DOMNodeInserted', function(e) {
      if (e.target.nodeType === 1) { // Element node
        if (e.target.querySelector && e.target.querySelector('.media-container')) {
          setTimeout(initMediaGrids, 50);
        }
      }
    });
  }
  
  // Run initialization when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>



<script>
  (function() {
    function adjustActionButtonsLayout() {
      document.querySelectorAll('.action-buttons').forEach(container => {
        // Calculate exact width needed
        const buttons = container.querySelectorAll('.action-button');
        const totalIcons = buttons.length;
        const containerWidth = container.parentElement.clientWidth;
        const gapSize = 6; // pixels between icons
        const maxButtonWidth = (containerWidth - ((totalIcons - 1) * gapSize)) / totalIcons;
        
        // Apply dynamic sizing
        container.style.display = 'flex';
        container.style.flexWrap = 'nowrap';
        container.style.width = '100%';
        container.style.gap = `${gapSize}px`;
        container.style.overflow = 'visible';
        
        buttons.forEach(button => {
          button.style.minWidth = '0'; // Allow shrinking
          button.style.maxWidth = `${maxButtonWidth}px`;
          button.style.flex = '1 1 auto'; // Flexible but equal
          button.style.marginRight = '0';
          button.style.whiteSpace = 'nowrap';
          button.style.textOverflow = 'ellipsis';
          button.style.overflow = 'hidden';
        });
        
        // Optimize icons
        container.querySelectorAll('svg').forEach(svg => {
          svg.style.minWidth = '16px';
          svg.style.maxWidth = '16px';
          svg.style.marginRight = '4px';
        });
      });
    }
    
    // Run immediately and on all updates
    const run = () => {
      adjustActionButtonsLayout();
      window.requestAnimationFrame(run); // Continuous perfection
    };
    run();
    
    // Also trigger on resize/mutations
    window.addEventListener('resize', adjustActionButtonsLayout);
    new MutationObserver(adjustActionButtonsLayout)
      .observe(document.body, { subtree: true, childList: true });
  })();
</script>



<script>
(function() {
  // Configuration options
  const config = {
    animationDuration: '1.5s',
    // These variables will now be taken from CSS, with fallbacks in case they are not set.
    backgroundColor: 'var(--comment-bg, #253341)',
    highlightColor: 'var(--comment-border, #38444d)',
    skeletonCount: 3,  // Number of skeleton items to show
    containerSelector: '.reply-section, [id^="reply-messages-"]',
    loadingTextSelectors: ['.loading-replies', '.no-replies'],
    minimumDisplayTime: 11000  // Minimum time in milliseconds to show skeleton
  };

  // Create and inject CSS for skeleton animations using CSS variables for colors.
  function injectStyles() {
    const css = `
      @keyframes skeletonPulse {
        0% { background-position: -200px 0; }
        100% { background-position: calc(200px + 100%) 0; }
      }

      .skeleton-item {
        display: flex;
        padding: 12px 16px;
        margin-bottom: 12px;
        border-bottom: 1px solid ${config.highlightColor};
        animation-duration: ${config.animationDuration};
      }

      .skeleton-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        margin-right: 12px;
        background: linear-gradient(90deg, ${config.backgroundColor} 8%, ${config.highlightColor} 18%, ${config.backgroundColor} 33%);
        background-size: 200% 100%;
        animation: skeletonPulse ${config.animationDuration} ease-in-out infinite;
      }

      .skeleton-content {
        flex: 1;
      }

      .skeleton-name {
        height: 14px;
        width: 120px;
        margin-bottom: 10px;
        border-radius: 4px;
        background: linear-gradient(90deg, ${config.backgroundColor} 8%, ${config.highlightColor} 18%, ${config.backgroundColor} 33%);
        background-size: 200% 100%;
        animation: skeletonPulse ${config.animationDuration} ease-in-out infinite;
      }

      .skeleton-text {
        height: 10px;
        border-radius: 4px;
        margin-bottom: 8px;
        background: linear-gradient(90deg, ${config.backgroundColor} 8%, ${config.highlightColor} 18%, ${config.backgroundColor} 33%);
        background-size: 200% 100%;
        animation: skeletonPulse ${config.animationDuration} ease-in-out infinite;
      }

      .skeleton-text:last-child {
        width: 80%;
      }
    `;
    const styleElement = document.createElement('style');
    styleElement.textContent = css;
    document.head.appendChild(styleElement);
  }

  // Create skeleton UI element
  function createSkeletonElement() {
    const skeletonItem = document.createElement('div');
    skeletonItem.className = 'skeleton-item';

    const avatar = document.createElement('div');
    avatar.className = 'skeleton-avatar';

    const content = document.createElement('div');
    content.className = 'skeleton-content';

    const name = document.createElement('div');
    name.className = 'skeleton-name';

    const text1 = document.createElement('div');
    text1.className = 'skeleton-text';
    text1.style.width = '95%';

    const text2 = document.createElement('div');
    text2.className = 'skeleton-text';
    text2.style.width = '60%';

    content.appendChild(name);
    content.appendChild(text1);
    content.appendChild(text2);

    skeletonItem.appendChild(avatar);
    skeletonItem.appendChild(content);

    return skeletonItem;
  }

  // Add skeleton items to a container and return a cleanup function.
  function addSkeletonToContainer(container) {
    // Hide any loading text
    config.loadingTextSelectors.forEach(selector => {
      const loadingText = container.querySelector(selector);
      if (loadingText) {
        loadingText.style.display = 'none';
      }
    });

    const fragment = document.createDocumentFragment();
    for (let i = 0; i < config.skeletonCount; i++) {
      fragment.appendChild(createSkeletonElement());
    }
    container.appendChild(fragment);

    const startTime = Date.now();

    return function cleanupSkeleton() {
      const elapsedTime = Date.now() - startTime;
      if (elapsedTime >= config.minimumDisplayTime) {
        performCleanup();
      } else {
        setTimeout(performCleanup, config.minimumDisplayTime - elapsedTime);
      }
      function performCleanup() {
        const skeletons = container.querySelectorAll('.skeleton-item');
        skeletons.forEach(skeleton => {
          if (skeleton.parentNode === container) {
            container.removeChild(skeleton);
          }
        });
        config.loadingTextSelectors.forEach(selector => {
          const loadingText = container.querySelector(selector);
          if (loadingText) {
            loadingText.style.display = '';
          }
        });
      }
    };
  }

  // Initialize observers and patch functions to add skeleton loaders.
  function init() {
    injectStyles();

    const activeSkeletons = new Map();

    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        mutation.addedNodes.forEach(node => {
          if (node.nodeType === Node.ELEMENT_NODE) {
            if (node.classList && node.classList.contains('reply-section')) {
              const repliesContainer = node.querySelector('[id^="reply-messages-"]');
              if (repliesContainer) {
                const cleanup = addSkeletonToContainer(repliesContainer);
                activeSkeletons.set(repliesContainer, {
                  cleanup: cleanup,
                  contentLoaded: false,
                  startTime: Date.now()
                });
                const contentObserver = new MutationObserver(contentMutations => {
                  contentMutations.forEach(contentMutation => {
                    if (contentMutation.addedNodes.length > 0) {
                      const hasRealContent = Array.from(contentMutation.addedNodes).some(addedNode => {
                        return addedNode.nodeType === Node.ELEMENT_NODE &&
                               !addedNode.classList.contains('skeleton-item') &&
                               !addedNode.classList.contains('loading-replies') &&
                               !addedNode.classList.contains('no-replies');
                      });
                      if (hasRealContent && activeSkeletons.has(repliesContainer)) {
                        const skeletonInfo = activeSkeletons.get(repliesContainer);
                        skeletonInfo.contentLoaded = true;
                        const elapsedTime = Date.now() - skeletonInfo.startTime;
                        const remainingTime = Math.max(0, config.minimumDisplayTime - elapsedTime);
                        if (remainingTime > 0) {
                          setTimeout(() => {
                            if (activeSkeletons.has(repliesContainer)) {
                              const info = activeSkeletons.get(repliesContainer);
                              info.cleanup();
                              activeSkeletons.delete(repliesContainer);
                            }
                          }, remainingTime);
                        } else {
                          skeletonInfo.cleanup();
                          activeSkeletons.delete(repliesContainer);
                        }
                        contentObserver.disconnect();
                      }
                    }
                  });
                });
                contentObserver.observe(repliesContainer, { childList: true });
              }
            }
            const repliesContainers = node.querySelectorAll('[id^="reply-messages-"]');
            repliesContainers.forEach(container => {
              const isEmpty = !container.childElementCount ||
                              (container.childElementCount === 1 &&
                              (container.querySelector('.loading-replies') ||
                               container.querySelector('.no-replies')));
              if (isEmpty && !activeSkeletons.has(container)) {
                const cleanup = addSkeletonToContainer(container);
                activeSkeletons.set(container, {
                  cleanup: cleanup,
                  contentLoaded: false,
                  startTime: Date.now()
                });
              }
            });
          }
        });
        mutation.removedNodes.forEach(node => {
          if (node.nodeType === Node.ELEMENT_NODE) {
            if (node.classList && node.classList.contains('reply-section')) {
              const repliesContainer = node.querySelector('[id^="reply-messages-"]');
              if (repliesContainer && activeSkeletons.has(repliesContainer)) {
                activeSkeletons.delete(repliesContainer);
              }
            }
          }
        });
      });
    });

    observer.observe(document.body, {
      childList: true,
      subtree: true
    });

    // Patch the toggleReplySection function to add skeleton loading.
    if (window.toggleReplySection) {
      const originalToggleReplySection = window.toggleReplySection;
      window.toggleReplySection = function(messageId) {
        originalToggleReplySection(messageId);
        setTimeout(() => {
          const repliesContainer = document.getElementById(`reply-messages-${messageId}`);
          if (repliesContainer && !activeSkeletons.has(repliesContainer)) {
            const isEmpty = !repliesContainer.childElementCount ||
                           (repliesContainer.childElementCount === 1 &&
                            (repliesContainer.querySelector('.loading-replies') ||
                             repliesContainer.querySelector('.no-replies')));
            if (isEmpty) {
              const cleanup = addSkeletonToContainer(repliesContainer);
              activeSkeletons.set(repliesContainer, {
                cleanup: cleanup,
                contentLoaded: false,
                startTime: Date.now()
              });
            }
          }
        }, 50);
      };
    }

    // Patch the loadReplies function to add skeleton loading.
    if (window.loadReplies) {
      const originalLoadReplies = window.loadReplies;
      window.loadReplies = function(parentMessageId) {
        const repliesContainer = document.getElementById(`reply-messages-${parentMessageId}`);
        if (repliesContainer && !activeSkeletons.has(repliesContainer)) {
          const cleanup = addSkeletonToContainer(repliesContainer);
          activeSkeletons.set(repliesContainer, {
            cleanup: cleanup,
            contentLoaded: false,
            startTime: Date.now()
          });
        }
        originalLoadReplies(parentMessageId);
      };
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
<script>
  (function() {
    // CommentThemeManager: applies theme settings to the reply/comment section,
    // including the reply input container ("rapper") around the input area.
    const CommentThemeManager = {
      // Define theme variables for each mode (light, dim, dark)
      themeConfig: {
        light: {
          '--comment-bg': '#ffffff',
          '--comment-text': '#333333',
          '--comment-border': '#e0e0e0'
        },
        dim: {
          '--comment-bg': '#1e2732',
          '--comment-text': '#ffffff',
          '--comment-border': '#38444d'
        },
        dark: {
          '--comment-bg': '#080808',
          '--comment-text': '#ffffff',
          '--comment-border': '#121212'
        }
      },
      styleElementId: 'comment-theme-manager-styles',
      
      initialize: function() {
        this.createStyleElement();
        this.applyCurrentTheme();
        this.setupEventListeners();
      },
      
      createStyleElement: function() {
        const existingStyle = document.getElementById(this.styleElementId);
        if (existingStyle) existingStyle.remove();
        
        const styleElement = document.createElement('style');
        styleElement.id = this.styleElementId;
        styleElement.setAttribute('data-origin', 'comment-theme-manager');
        document.head.appendChild(styleElement);
      },
      
      applyCurrentTheme: function() {
        const themeName = localStorage.getItem('twitter-theme') || 'light';
        this.applyTheme(themeName);
      },
      
      applyTheme: function(themeName) {
        const validThemes = ['light', 'dim', 'dark'];
        const theme = validThemes.includes(themeName) ? themeName : 'light';
        const themeVars = this.themeConfig[theme] || this.themeConfig.light;
        let css = ':root {\n';
        Object.entries(themeVars).forEach(([key, value]) => {
          css += `  ${key}: ${value};\n`;
        });
        css += '}\n\n';
        
        // CSS rules to target the reply/comment section and its input container.
        css += `
        /* Reply/Comment Section Styling */
        .reply-section {
          background-color: var(--comment-bg) !important;
          color: var(--comment-text) !important;
          border-top: 1px solid var(--comment-border) !important;
        }
        .reply-section h3,
        .reply-section .reply-header {
          color: var(--comment-text) !important;
        }
        /* Style the reply input area */
        .reply-section .reply-input {
          background-color: var(--comment-bg) !important;
          color: var(--comment-text) !important;
          border: 1px solid var(--comment-border) !important;
        }
        /* Style the wrapper around the reply input (input container) */
        .reply-section .reply-input-container {
          background-color: var(--comment-bg) !important;
          border: 1px solid var(--comment-border) !important;
        }
        /* Leave the send icon unchanged */
        .reply-section .reply-send-btn svg {
          fill: #1da1f2 !important;
        }
      `;
        
        const styleElement = document.getElementById(this.styleElementId);
        if (styleElement) {
          styleElement.textContent = css;
        }
      },
      
      setupEventListeners: function() {
        // Listen for changes in localStorage for immediate theme updates.
        window.addEventListener('storage', (e) => {
          if (e.key === 'twitter-theme') {
            this.applyTheme(e.newValue || 'light');
          }
        });
        
        // Periodic check to catch theme changes.
        let lastKnownTheme = localStorage.getItem('twitter-theme') || 'light';
        setInterval(() => {
          const currentTheme = localStorage.getItem('twitter-theme') || 'light';
          if (currentTheme !== lastKnownTheme) {
            lastKnownTheme = currentTheme;
            this.applyTheme(currentTheme);
          }
        }, 3000);
      }
    };
    
    // Initialize when DOM is ready.
    function initCommentThemeManager() {
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          CommentThemeManager.initialize();
        });
      } else {
        CommentThemeManager.initialize();
      }
    }
    
    // Small delay to ensure other scripts have loaded.
    setTimeout(initCommentThemeManager, 100);
  })();
</script>
<script>
  
// Function to group consecutive messages from the same user
function groupConsecutiveMessages() {
  // Get all message elements
  const messages = document.querySelectorAll('.message');
  let currentUserId = null;
  let lastMessageElement = null;

  messages.forEach((messageElement, index) => {
    // Extract the user ID from the message
    const userId = messageElement.querySelector('.follow-btn')?.getAttribute('data-user-id');
    
    // If this message is from the same user as the previous one
    if (userId && userId === currentUserId) {
      // Hide the profile image, user info and action buttons
      const profileImage = messageElement.querySelector('.profile-image');
      const messageHeader = messageElement.querySelector('.message-header');
      const actionButtons = messageElement.querySelector('.action-buttons');
      
      if (profileImage) profileImage.style.visibility = 'hidden';
      if (messageHeader) messageHeader.style.display = 'none';
      if (actionButtons) actionButtons.style.display = 'none';
      
      // Add a class to indicate it's a consecutive message
      messageElement.classList.add('consecutive-message');
      
      // Reduce the padding/margin to make it appear grouped
      messageElement.style.paddingTop = '4px';
      messageElement.style.borderBottom = 'none';
      
      // If it's the last message in a group, add a small bottom margin
      if (index === messages.length - 1 || 
          messages[index + 1].querySelector('.follow-btn')?.getAttribute('data-user-id') !== userId) {
        messageElement.style.marginBottom = '8px';
        // Removed the border styling that was making things ugly
        messageElement.style.paddingBottom = '8px';
      }
      
      // If it's not the first message in a group, reduce top margin
      if (lastMessageElement && lastMessageElement.classList.contains('consecutive-message')) {
        messageElement.style.marginTop = '-6px';
      }
    } else {
      // This is the first message from a user or a message from a different user
      // Reset the current user ID
      currentUserId = userId;
      
      // Add some extra spacing if this message follows a group
      if (lastMessageElement && lastMessageElement.classList.contains('consecutive-message')) {
        messageElement.style.marginTop = '16px';
      }
    }
    
    lastMessageElement = messageElement;
  });
}

// Watch for new messages being added to the chat
const chatObserver = new MutationObserver((mutations) => {
  // Check if new messages were added
  const hasNewMessages = mutations.some(mutation => 
    Array.from(mutation.addedNodes).some(node => 
      node.nodeType === 1 && node.classList.contains('message')
    )
  );
  
  if (hasNewMessages) {
    // Regroup all messages
    groupConsecutiveMessages();
  }
});

// Start observing the chat container
document.addEventListener('DOMContentLoaded', () => {
  const chatContainer = document.getElementById('chatContainer');
  if (chatContainer) {
    chatObserver.observe(chatContainer, { childList: true });
    
    // Also run once on page load for existing messages
    setTimeout(groupConsecutiveMessages, 1000);
  }
});

// Ensure the observer is started even if content loads dynamically
const checkForChatContainer = setInterval(() => {
  const chatContainer = document.getElementById('chatContainer');
  if (chatContainer) {
    chatObserver.observe(chatContainer, { childList: true });
    clearInterval(checkForChatContainer);
    
    // Run the grouping function for existing messages
    groupConsecutiveMessages();
  }
}, 500);

// Apply the grouping function whenever new messages are loaded
document.addEventListener('scroll', () => {
  // Debounce the function to prevent performance issues
  clearTimeout(window.scrollDebounce);
  window.scrollDebounce = setTimeout(groupConsecutiveMessages, 200);
});

</script>



<script>
// Ultimate Date Headers with Enhanced Timestamps for Professional Chat
(function() {
  // Configuration - Customizable gradient
  const HEADER_GRADIENT = 'linear-gradient(135deg, rgba(98,98,98,0.8) 0%, rgba(72,72,72,0.9) 100%)';
  
  // Enhanced timestamp formatter that works with the actual chat platform
  function enhancedFormatTimestamp(timestamp) {
    const messageDate = new Date(timestamp);
    const now = new Date();
    
    // Format time as HH:MM
    const hours = messageDate.getHours();
    const minutes = messageDate.getMinutes().toString().padStart(2, '0');
    const timeString = `${hours}:${minutes}`;
    
    // Check if it's today
    if (messageDate.toDateString() === now.toDateString()) {
      return `Today at ${timeString}`;
    }
    
    // Check if it's yesterday
    const yesterday = new Date(now);
    yesterday.setDate(now.getDate() - 1);
    if (messageDate.toDateString() === yesterday.toDateString()) {
      return `Yesterday at ${timeString}`;
    }
    
    // Check if it's within the last week
    const oneWeekAgo = new Date(now);
    oneWeekAgo.setDate(now.getDate() - 7);
    if (messageDate > oneWeekAgo) {
      // Get day of week
      const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
      const dayOfWeek = days[messageDate.getDay()];
      return `${dayOfWeek} at ${timeString}`;
    }
    
    // Otherwise show full date
    const month = messageDate.toLocaleString('default', { month: 'short' });
    const day = messageDate.getDate();
    return `${month} ${day} at ${timeString}`;
  }
  
  // Function to update all message timestamps in the interface
  function updateAllTimestamps() {
    const timeElements = document.querySelectorAll('.message-time');
    timeElements.forEach(element => {
      // Extract timestamp from data attribute if available
      const messageElement = element.closest('.message');
      if (messageElement) {
        const messageId = messageElement.getAttribute('data-message-id');
        // Try to find the timestamp from local storage
        try {
          const localMessages = localStorage.getItem('localMessages');
          if (localMessages) {
            const messages = JSON.parse(localMessages);
            const message = messages.find(m => m.id === messageId);
            if (message && message.timestamp) {
              element.textContent = enhancedFormatTimestamp(message.timestamp);
            }
          }
        } catch (error) {
          console.error('Error updating timestamps:', error);
        }
      }
    });
    
    // Also update reply timestamps
    const replyTimeElements = document.querySelectorAll('.reply-time');
    replyTimeElements.forEach(element => {
      // Similar logic for replies could be implemented here
    });
  }
  
  // Override the platform's timestamp formatter
  if (window.formatTimestamp) {
    window.originalFormatTimestamp = window.formatTimestamp;
  }
  window.formatTimestamp = enhancedFormatTimestamp;
  
  // Date headers functionality
  function initDateHeaders() {
    const chat = document.querySelector('.chat-container, #chatContainer, .message-list');
    if (!chat) {
      console.log('Chat container not found, retrying in 500ms');
      setTimeout(initDateHeaders, 500);
      return;
    }
    
    // Clear old headers first
    removeExistingHeaders();
    
    // Process all messages
    const messages = Array.from(chat.querySelectorAll('.message, .chat-message'));
    if (!messages.length) return;
    
    let lastDateKey = null;
    const processedDates = new Set();
    
    messages.forEach(message => {
      const timestamp = getMessageTimestamp(message);
      if (!timestamp) return;
      
      const dateKey = getDateKey(timestamp);
      if (dateKey !== lastDateKey && !processedDates.has(dateKey)) {
        const header = createHeaderElement(getDisplayText(timestamp));
        message.parentNode.insertBefore(header, message);
        
        processedDates.add(dateKey);
        lastDateKey = dateKey;
      }
    });
  }
  
  function getMessageTimestamp(message) {
    try {
      // Try getting timestamp from localStorage first (your preferred method)
      const messageId = message.getAttribute('data-message-id');
      if (messageId) {
        try {
          const localMessages = localStorage.getItem('localMessages');
          if (localMessages) {
            const messages = JSON.parse(localMessages);
            const messageObj = messages.find(m => m.id === messageId);
            if (messageObj && messageObj.timestamp) {
              return new Date(messageObj.timestamp);
            }
          }
        } catch (e) {
          console.error('Error accessing localStorage:', e);
        }
      }
      
      // Fallback methods
      // 1. Check for direct timestamp data
      if (message.dataset.timestamp) {
        return new Date(parseInt(message.dataset.timestamp) || message.dataset.timestamp);
      }
      
      // 2. Check time element data
      const timeElement = message.querySelector('.message-time, .timestamp');
      if (timeElement?.dataset.timestamp) {
        return new Date(parseInt(timeElement.dataset.timestamp) || timeElement.dataset.timestamp);
      }
      
      // 3. Parse from visible time text as last resort
      if (timeElement?.textContent) {
        return parseTimeText(timeElement.textContent.trim());
      }
      
      return null;
    } catch (e) {
      console.error('Failed to parse timestamp:', e);
      return null;
    }
  }
  
  function parseTimeText(timeText) {
    // Handle various timestamp text formats
    
    // Format: "Today at 10:30"
    if (timeText.includes('Today at')) {
      const time = timeText.split('at')[1].trim();
      const [hours, minutes] = time.split(':').map(Number);
      const now = new Date();
      return new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
    }
    
    // Format: "Yesterday at 10:30"
    if (timeText.includes('Yesterday at')) {
      const time = timeText.split('at')[1].trim();
      const [hours, minutes] = time.split(':').map(Number);
      const now = new Date();
      now.setDate(now.getDate() - 1);
      return new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
    }
    
    // Format: "Monday at 10:30" (day of week)
    const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
    for (const day of days) {
      if (timeText.includes(`${day} at`)) {
        const time = timeText.split('at')[1].trim();
        const [hours, minutes] = time.split(':').map(Number);
        
        const now = new Date();
        const currentDay = now.getDay(); // 0-6
        const targetDay = days.indexOf(day); // 0-6
        
        let daysToSubtract = currentDay - targetDay;
        if (daysToSubtract < 0) daysToSubtract += 7;
        
        now.setDate(now.getDate() - daysToSubtract);
        return new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
      }
    }
    
    // Format: "HH:MM" (assume today)
    if (/^\d{1,2}:\d{2}(?: [AP]M)?$/.test(timeText)) {
      const now = new Date();
      let [hours, minutesPart] = timeText.split(':');
      let minutes = parseInt(minutesPart);
      
      hours = parseInt(hours);
      
      // Handle AM/PM if present
      if (minutesPart.includes('PM') && hours < 12) {
        hours += 12;
      } else if (minutesPart.includes('AM') && hours === 12) {
        hours = 0;
      }
      
      return new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
    }
    
    // Last resort: Try direct parse
    return new Date(timeText);
  }
  
  function getDateKey(date) {
    return `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
  }
  
  function getDisplayText(date) {
    const now = new Date();
    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    const yesterday = new Date(today);
    yesterday.setDate(yesterday.getDate() - 1);
    
    const messageDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());
    const dayDiff = Math.floor((today - messageDate) / (1000 * 60 * 60 * 24));
    
    if (dayDiff === 0) return "Today";
    if (dayDiff === 1) return "Yesterday";
    if (dayDiff < 7) return date.toLocaleDateString(undefined, { weekday: 'long' });
    if (messageDate.getFullYear() === today.getFullYear()) {
      return date.toLocaleDateString(undefined, { month: 'long', day: 'numeric' });
    }
    return date.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
  }
  
  function createHeaderElement(text) {
    const header = document.createElement('div');
    header.className = 'date-header';
    
    const label = document.createElement('div');
    label.className = 'date-label';
    label.textContent = text;
    
    // Glass morphism styling
    label.style.display = 'inline-block';
    label.style.padding = '6px 18px';
    label.style.borderRadius = '20px';
    label.style.fontSize = '13px';
    label.style.fontWeight = '500';
    label.style.color = '#fff';
    label.style.textShadow = '0 1px 2px rgba(0,0,0,0.2)';
    label.style.background = HEADER_GRADIENT;
    label.style.border = '1px solid rgba(255,255,255,0.15)';
    label.style.boxShadow = '0 2px 8px rgba(0,0,0,0.15)';
    label.style.backdropFilter = 'blur(0px)'; // Ensure it's not blurry
    
    header.appendChild(label);
    return header;
  }
  
  function removeExistingHeaders() {
    document.querySelectorAll('.date-header').forEach(el => el.remove());
  }
  
  function setupMutationObserver() {
    const observer = new MutationObserver(mutations => {
      if (mutations.some(m => m.addedNodes.length > 0)) {
        setTimeout(() => {
          initDateHeaders();
          updateAllTimestamps();
        }, 50);
      }
    });
    
    const chat = document.querySelector('.chat-container, #chatContainer, .message-list');
    if (chat) {
      observer.observe(chat, { childList: true, subtree: true });
    } else {
      setTimeout(setupMutationObserver, 500);
    }
  }
  
  function addGlobalStyles() {
    if (document.getElementById('date-header-styles')) return;
    
    const style = document.createElement('style');
    style.id = 'date-header-styles';
    style.textContent = `
      .date-header {
        text-align: center;
        margin: 16px 0;
        position: relative;
        z-index: 10;
      }
      .date-header:first-child {
        margin-top: 8px;
      }
    `;
    document.head.appendChild(style);
  }
  
  // Initialize everything
  function init() {
    addGlobalStyles();
    
    function initialRun() {
      initDateHeaders();
      updateAllTimestamps();
      setupMutationObserver();
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        setTimeout(initialRun, 300);
      });
    } else {
      setTimeout(initialRun, 300);
    }
    
    // Periodically refresh timestamps and headers
    setInterval(() => {
      updateAllTimestamps();
      initDateHeaders();
    }, 60000);
  }
  
  init();
})();
</script>
<script>
  // Pagination Solution - Add this to a separate JavaScript file
(function() {
  // Configuration
  const MESSAGES_PER_PAGE = 20;
  const SCROLL_THRESHOLD = 200; // pixels from top to trigger loading more
  
  // State
  let currentPage = 1;
  let isLoading = false;
  let allMessagesLoaded = false;
  let messageCache = [];
  
  // DOM references
  let chatContainer;
  
  // Initialize pagination
  function initPagination() {
    chatContainer = document.getElementById('chatContainer');
    if (!chatContainer) {
      console.error('Chat container not found');
      return;
    }
    
    // Add scroll event to load more messages
    chatContainer.addEventListener('scroll', handleScroll);
    
    // Override the original message loading function
    overrideMessageLoading();
    
    // Add loading indicator
    createLoadingIndicator();
    
    // Initialize with first page
    loadInitialMessages();
  }
  
  // Create loading indicator for pagination
  function createLoadingIndicator() {
    const loadingIndicator = document.createElement('div');
    loadingIndicator.id = 'paginationLoading';
    loadingIndicator.className = 'pagination-loading';
    loadingIndicator.innerHTML = 'Loading older messages...';
    loadingIndicator.style.padding = '10px';
    loadingIndicator.style.textAlign = 'center';
    loadingIndicator.style.color = '#8899a6';
    loadingIndicator.style.display = 'none';
    
    // Insert at the top of chat container
    if (chatContainer.firstChild) {
      chatContainer.insertBefore(loadingIndicator, chatContainer.firstChild);
    } else {
      chatContainer.appendChild(loadingIndicator);
    }
  }
  
  // Handle scroll event to load more messages
  function handleScroll() {
    if (isLoading || allMessagesLoaded) return;
    
    // If scrolled near the top, load previous messages
    if (chatContainer.scrollTop < SCROLL_THRESHOLD) {
      loadPreviousMessages();
    }
  }
  
  // Load initial messages (most recent)
  function loadInitialMessages() {
    isLoading = true;
    
    try {
      // Get messages from localStorage
      const storedMessages = localStorage.getItem('localMessages');
      if (storedMessages) {
        messageCache = JSON.parse(storedMessages);
        
        // Sort by timestamp (newest first)
        messageCache.sort((a, b) => b.timestamp - a.timestamp);
        
        // Render first page
        renderMessagesPage(1);
      }
      
      // Also listen for real-time messages
      // This doesn't need to change as new messages should appear regardless of pagination
    } catch (error) {
      console.error('Error loading initial messages:', error);
    }
    
    isLoading = false;
  }
  
  // Load previous (older) messages
  function loadPreviousMessages() {
    if (isLoading || allMessagesLoaded) return;
    
    isLoading = true;
    showLoadingIndicator(true);
    
    // Remember scroll position
    const scrollHeight = chatContainer.scrollHeight;
    const scrollPosition = chatContainer.scrollTop;
    
    // Load next page
    currentPage++;
    const hasMoreMessages = renderMessagesPage(currentPage);
    
    if (!hasMoreMessages) {
      allMessagesLoaded = true;
      showLoadingIndicator(false);
    }
    
    // Restore scroll position
    setTimeout(() => {
      const newScrollHeight = chatContainer.scrollHeight;
      chatContainer.scrollTop = scrollPosition + (newScrollHeight - scrollHeight);
      isLoading = false;
      showLoadingIndicator(false);
    }, 100);
  }
  
  // Render a specific page of messages
  function renderMessagesPage(page) {
    const startIndex = (page - 1) * MESSAGES_PER_PAGE;
    const endIndex = startIndex + MESSAGES_PER_PAGE;
    const messagesToRender = messageCache.slice(startIndex, endIndex);
    
    if (messagesToRender.length === 0) {
      return false;
    }
    
    // If this is a new page (not first page), we add messages to the top
    if (page > 1) {
      let fragment = document.createDocumentFragment();
      
      // Create message elements in reverse order (oldest first)
      // to maintain chronological order when inserting
      for (let i = messagesToRender.length - 1; i >= 0; i--) {
        const message = messagesToRender[i];
        // Skip if message is already displayed
        if (!document.querySelector(`[data-message-id="${message.id}"]`)) {
          const messageElement = createMessageElementOptimized(message);
          fragment.appendChild(messageElement);
        }
      }
      
      // Insert at the top (after loading indicator)
      const loadingIndicator = document.getElementById('paginationLoading');
      if (loadingIndicator && loadingIndicator.nextSibling) {
        chatContainer.insertBefore(fragment, loadingIndicator.nextSibling);
      } else {
        chatContainer.prepend(fragment);
      }
    } else {
      // For first page, just render at the bottom
      messagesToRender.forEach(message => {
        // Skip if message is already displayed
        if (!document.querySelector(`[data-message-id="${message.id}"]`)) {
          const messageElement = createMessageElementOptimized(message);
          chatContainer.appendChild(messageElement);
        }
      });
      
      // Scroll to bottom for first page
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    return messagesToRender.length === MESSAGES_PER_PAGE;
  }
  
  // Create optimized message element (simplified version of original)
  function createMessageElementOptimized(message) {
    // Reference the original createMessageElement function if possible
    if (typeof window.createMessageElement === 'function') {
      return window.createMessageElement(message, message.id);
    }
    
    // Fallback implementation if original function is not accessible
    const messageElement = document.createElement('div');
    messageElement.classList.add('message');
    messageElement.setAttribute('data-message-id', message.id);
    
    // Simplified message rendering - expand this as needed
    messageElement.innerHTML = `
      <img src="${message.photoURL}" class="profile-image" alt="Profile">
      <div class="message-content">
        <div class="message-header">
          <span class="user-name">${message.name}</span>
          <span class="message-time">${formatTimestamp(message.timestamp)}</span>
        </div>
        <div class="message-text">${message.text || ''}</div>
        ${renderMessageMedia(message)}
      </div>
    `;
    
    return messageElement;
  }
  
  // Helper to render message media
  function renderMessageMedia(message) {
    if (!message.media || message.media.length === 0) return '';
    
    let mediaHTML = '<div class="media-container">';
    message.media.forEach(media => {
      if (media && media.url) {
        if (media.type === 'image') {
          mediaHTML += `<img src="${media.url}" class="message-image" onclick="showFullImage('${media.url}')">`;
        } else if (media.type === 'video') {
          mediaHTML += `<video src="${media.url}" class="message-video" controls></video>`;
        }
      }
    });
    mediaHTML += '</div>';
    return mediaHTML;
  }
  
  // Format timestamp helper
  function formatTimestamp(timestamp) {
    const date = new Date(timestamp);
    const hours = date.getHours();
    const minutes = date.getMinutes().toString().padStart(2, '0');
    return `${hours}:${minutes}`;
  }
  
  // Show/hide loading indicator
  function showLoadingIndicator(show) {
    const indicator = document.getElementById('paginationLoading');
    if (indicator) {
      indicator.style.display = show ? 'block' : 'none';
    }
  }
  
  // Override original message loading to work with pagination
  function overrideMessageLoading() {
    // Save reference to original functions if needed
    if (typeof window.loadLocalMessages === 'function') {
      const originalLoadLocalMessages = window.loadLocalMessages;
      
      // Override with paginated version
      window.loadLocalMessages = function() {
        // Don't do anything here, our pagination handles it
        console.log('Pagination active: loadLocalMessages intercepted');
        // Let original function load data but not render
        try {
          originalLoadLocalMessages();
        } catch (e) {
          console.error('Error in original loadLocalMessages:', e);
        }
      };
    }
    
    // Similarly override other message rendering functions if needed
  }
  
  // Initialize when DOM is ready
  function onDOMReady(callback) {
    if (document.readyState !== 'loading') {
      callback();
    } else {
      document.addEventListener('DOMContentLoaded', callback);
    }
  }
  
  // Start initialization
  onDOMReady(initPagination);
})();
</script>

<script>

// Self-executing function to avoid conflicts with existing code
(function() {
  // Wait for DOM to be fully loaded
  function enhanceChat() {
    // Track processed messages to avoid duplicates
    const processedMessages = new Set();
    
    // Process all messages
    function processMessages() {
      document.querySelectorAll('.message').forEach(message => {
        // Skip if already processed
        const messageId = message.getAttribute('data-message-id');
        if (!messageId || processedMessages.has(messageId)) return;
        processedMessages.add(messageId);
        
        // Get profile picture
        const profileImg = message.querySelector('.profile-image');
        if (!profileImg) return;
        
        // Determine if this is user's message (outgoing)
        const followBtn = message.querySelector('.follow-btn');
        const isUserMessage = followBtn && followBtn.style.display === 'none';
        
        // Get message content element
        const messageContent = message.querySelector('.message-content');
        if (!messageContent) return;
        
        // Extract background color from profile image
        if (profileImg.src.startsWith('data:image')) {
          // Extract color from data URL
          try {
            // Create a temp canvas to get the color
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = new Image();
            img.src = profileImg.src;
            
            // Once image loads, get its color
            img.onload = function() {
              canvas.width = 1;
              canvas.height = 1;
              ctx.drawImage(img, 0, 0, 1, 1);
              const pixelData = ctx.getImageData(0, 0, 1, 1).data;
              const color = `rgb(${pixelData[0]}, ${pixelData[1]}, ${pixelData[2]})`;
              
              // Apply border based on message type
              if (isUserMessage) {
                // User's message - border on right
                messageContent.style.borderLeft = '1px solid var(--border-color)';
                messageContent.style.borderRight = `3px solid ${color}`;
              } else {
                // Others' message - border on left
                messageContent.style.borderRight = '1px solid var(--border-color)';
                messageContent.style.borderLeft = `3px solid ${color}`;
              }
            };
          } catch (e) {
            // Fallback to default color if extraction fails
            applyDefaultBorder(messageContent, isUserMessage);
          }
        } else {
          // For external images, use default color
          applyDefaultBorder(messageContent, isUserMessage);
        }
      });
    }
    
    // Apply default border when color extraction fails
    function applyDefaultBorder(messageContent, isUserMessage) {
      if (isUserMessage) {
        messageContent.style.borderLeft = '1px solid var(--border-color)';
        messageContent.style.borderRight = '3px solid #626262';
      } else {
        messageContent.style.borderRight = '1px solid var(--border-color)';
        messageContent.style.borderLeft = '3px solid #626262';
      }
    }
    
    // Process existing messages
    processMessages();
    
    // Set up observer with low priority
    const observer = new MutationObserver(mutations => {
      // Use requestAnimationFrame to avoid blocking the main thread
      requestAnimationFrame(() => {
        let hasNewMessages = false;
        
        // Check if any new messages were added
        mutations.forEach(mutation => {
          if (mutation.type === 'childList') {
            mutation.addedNodes.forEach(node => {
              if (node.nodeType === 1 && node.classList.contains('message')) {
                hasNewMessages = true;
              }
            });
          }
        });
        
        // Only process if there are new messages
        if (hasNewMessages) {
          processMessages();
        }
      });
    });
    
    // Start observing with a configuration that minimizes work
    const chatContainer = document.getElementById('chatContainer');
    if (chatContainer) {
      observer.observe(chatContainer, { 
        childList: true, 
        subtree: false // Don't watch entire subtree for better performance
      });
    }
  }
  
  // Run after a short delay to ensure chat is loaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => setTimeout(enhanceChat, 300));
  } else {
    setTimeout(enhanceChat, 300);
  }
})();

</script>

<script>
  (() => {
  // Function to apply right-side styling to user's own messages
  function styleMyMessages() {
    // Get all messages that haven't been processed yet
    const messages = document.querySelectorAll('.message:not([data-processed])');
    
    messages.forEach(message => {
      // Mark as processed to avoid reprocessing
      message.setAttribute('data-processed', 'true');
      
      // Find follow button - if hidden, this is the current user's message
      const followBtn = message.querySelector('.follow-btn');
      if (followBtn && followBtn.style.display === 'none') {
        // Store message ID in localStorage for persistence
        const messageId = message.getAttribute('data-message-id');
        if (messageId) {
          localStorage.setItem(`my-message-${messageId}`, 'true');
        }
        
        // Apply user message styling
        applyMyMessageStyle(message);
        
        // Only hide flags on the current user's messages
        const flag = message.querySelector('.country-flag');
        if (flag) {
          flag.style.display = 'none';
        }
      } else {
        // Check if this message was previously identified as user's message
        const messageId = message.getAttribute('data-message-id');
        if (messageId && localStorage.getItem(`my-message-${messageId}`) === 'true') {
          applyMyMessageStyle(message);
          
          // Hide flag for previously identified own messages
          const flag = message.querySelector('.country-flag');
          if (flag) {
            flag.style.display = 'none';
          }
        }
      }
    });
  }
  
  // Apply styling to messages from the current user
  function applyMyMessageStyle(message) {
    // Right-align the message
    message.style.flexDirection = 'row-reverse';
    
    // Hide profile image for your own messages
    const profileImage = message.querySelector('.profile-image');
    if (profileImage) {
      profileImage.style.display = 'none';
    }
    
    // Hide username for your own messages
    const userName = message.querySelector('.user-name');
    if (userName) {
      userName.style.display = 'none';
    }
    
    // Right-align message content
    const messageContent = message.querySelector('.message-content');
    if (messageContent) {
      messageContent.style.alignItems = 'flex-end';
    }
    
    // Move action buttons to match right alignment
    const actionButtons = message.querySelector('.action-buttons');
    if (actionButtons) {
      actionButtons.style.justifyContent = 'flex-start';
      actionButtons.style.flexDirection = 'row-reverse';
    }
  }
  
  // Set up observer to detect when new messages are added
  function setupObserver() {
    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        if (mutation.addedNodes.length) {
          // Use requestAnimationFrame to optimize performance
          requestAnimationFrame(() => {
            styleMyMessages();
          });
        }
      });
    });
    
    const chatContainer = document.getElementById('chatContainer');
    if (chatContainer) {
      observer.observe(chatContainer, { childList: true, subtree: true });
      // Process existing messages on startup
      styleMyMessages();
    }
  }
  
  // Throttle function to limit how often a function can run
  function throttle(func, limit) {
    let inThrottle;
    return function() {
      const args = arguments;
      const context = this;
      if (!inThrottle) {
        func.apply(context, args);
        inThrottle = true;
        setTimeout(() => inThrottle = false, limit);
      }
    };
  }
  
  // For scroll events, use throttling to improve performance
  const throttledStyleMyMessages = throttle(styleMyMessages, 100);
  
  // Initialize observers based on document readiness
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', setupObserver);
  } else {
    setupObserver();
  }
  
  // Handle when chat container finishes loading (loading indicator disappears)
  const loadingIndicator = document.getElementById('loadingIndicator');
  if (loadingIndicator) {
    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        if (mutation.target === loadingIndicator && loadingIndicator.style.display === 'none') {
          // Use setTimeout with 0 delay to push to next event loop cycle
          setTimeout(styleMyMessages, 0);
        }
      });
    });
    observer.observe(loadingIndicator, { attributes: true, attributeFilter: ['style'] });
  }
  
  // Handle previously loaded messages when scrolling
  const chatContainer = document.getElementById('chatContainer');
  if (chatContainer) {
    chatContainer.addEventListener('scroll', throttledStyleMyMessages);
  }
})();
</script>