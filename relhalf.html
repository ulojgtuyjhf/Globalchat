
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="stylesheet" href="login.css">
    <link rel="icon" type="image/jpg" href="/storage/emulated/0/Pictures/Screenshot/Screenshot_20250331-185745.jpg">
  
    <title>Social Media Interface</title>
     

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

/* Prevent scrolling on main container */
html, body {
    overflow: hidden;
    height: 100%;
    width: 100%;
}

body {
    background-color: #fff;
    color: #0f1419;
    height: 100vh;
    overflow: hidden;
}

/* Hide scrollbar for Chrome, Safari and Opera */
::-webkit-scrollbar {
    width: 0px;
    background: transparent;
}

/* Hide scrollbar for IE, Edge and Firefox */
* {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
}

.container {
    display: flex;
    height: 100vh;
    width: 100%;
}

/* Left sidebar styles */
.sidebar {
    width:320px;
    padding: 0 12px;
    display: flex;
    flex-direction: column;
    border-right: 1px solid #eff3f4;
    height: 100%;
    flex-shrink: 0;
    transition: width 0.3s ease;
    z-index: 10;
}

/* Logo styles with improved responsiveness */
.logo-container {
    margin: 12px 0;
    padding: 8px 12px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    transition: all 0.3s ease;
}

.logo {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    color: transparent;
    font-weight: bold;
    font-size: 28px;
    cursor: pointer;
    transition: all 0.3s ease;
    outline: none;
    margin-left: 6px;
    position: relative;
}

/* Creating the circular gradient border */
.logo::before {
    content: '';
    position: absolute;
    top: -8px;
    left: -1px;
    right: -20px;
    bottom: -8px;
    border-radius: 50%;
    background: linear-gradient(135deg, #0f0f0f 0%, #1c1c1c 15%, #3a3a3a 30%, #4d4d4d 45%, #626262 60%, #787878 75%, #8f8f8f 90%, #a6a6a6 100%);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    border: 8px solid transparent;
    z-index: 1;
    padding: 2px;
    transition: all 0.3s ease;
}

/* Logo text with gradient */
.logo::after {
    content: 'â„’';
    position: relative;
    z-index: 2;
    background: linear-gradient(135deg, #0f0f0f 0%, #1c1c1c 15%, #3a3a3a 30%, #4d4d4d 45%, #626262 60%, #787878 75%, #8f8f8f 90%, #a6a6a6 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    font-size: 28px;
    font-weight: 700;
    letter-spacing: -1px;
    transition: all 0.3s ease;
}

.logo:hover,
.logo:focus {
    filter: brightness(1.05);
}

/* Remove blue focus outline from all clickable elements */
.menu-item:focus,
.post-btn:focus {
    outline: none;
}

.menu {
    display: flex;
    flex-direction: column;
    margin-top: 8px;
}

.menu-item {
    display: flex;
    align-items: center;
    padding: 12px;
    border-radius: 50px;
    margin-bottom: 10px;
    color: #0f1419;
    text-decoration: none;
    font-size: 18px;
    font-weight: 400;
    cursor: pointer;
    transition: background-color 0.2s ease;
    outline: none;
    width: 90%;
    margin-left: 6px;
}

/* Fixed hover animation to persist until finger/mouse is removed */
.menu-item:hover {
    background-color: rgba(128, 128, 128, 0.1);
}

.menu-item.active {
    font-weight: 700;
    color: #4d4d4d;
}

.menu-item svg {
    margin-right: 20px;
    width: 24px;
    height: 24px;
    flex-shrink: 0;
}

.menu-item.active svg {
    color: #4d4d4d;
    fill: #4d4d4d;
}

/* Updated post button with new gradient */
.post-btn {
    background: linear-gradient(135deg, #0f0f0f 0%, #1c1c1c 15%, #3a3a3a 30%, #4d4d4d 45%, #626262 60%, #787878 75%, #8f8f8f 90%, #a6a6a6 100%);
    color: white;
    border: none;
    border-radius: 50px;
    padding: 15px 0;
    font-size: 16px;
    font-weight: 700;
    margin: 15px 0;
    cursor: pointer;
    transition: filter 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    outline: none;
    width: 90%;
    margin-left: 6px;
}

.post-btn:hover,
.post-btn:focus {
    background: linear-gradient(135deg, #0f0f0f 0%, #1c1c1c 15%, #3a3a3a 30%, #4d4d4d 45%, #626262 60%, #787878 75%, #8f8f8f 90%, #a6a6a6 100%);
    filter: brightness(1.05);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

/* Content sections */
.main-content-wrapper {
    flex-grow: 1;
    display: flex;
    height: 100%;
    overflow: hidden;
}

.content-section {
    position: relative;
    height: 100%;
    overflow: hidden;
}

.content {
    flex-grow: 1;
    min-width: 0;
    height: 100%;
    border-right: 1px solid #eff3f4;
    padding: 0;
    transition: width 0.3s ease;
}

.widgets {
    width: 350px;
    height: 100%;
    padding: 0;
    transition: width 0.3s ease, opacity 0.3s ease;
}

.section-container {
    width: 100%;
    height: 100%;
    display: none;
    position: relative;
}

.section-container.active {
    display: block;
}

/* Updated iframe styles for perfect fit */
.section-container iframe {
    width: 100%;
    height: 100%;
    border: none;
    display: block;
    position: absolute;
    top: 0;
    left: 0;
}

/* Improved WhatsApp-style loading animation with bounce effect */
.loader {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 2;
    display: none;
    width: 70px;
    height: 20px;
    text-align: center;
}

.loader-dot {
    width: 8px;
    height: 8px;
    margin: 0 3px;
    display: inline-block;
    border-radius: 50%;
    background-color: #4d4d4d;
    opacity: 0.6;
}

/* WhatsApp typing-style animation with bounce */
.loader-dot:nth-child(1) {
    animation: dot-bounce 1.4s infinite 0s;
}

.loader-dot:nth-child(2) {
    animation: dot-bounce 1.4s infinite 0.2s;
}

.loader-dot:nth-child(3) {
    animation: dot-bounce 1.4s infinite 0.4s;
}

@keyframes dot-bounce {
    0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.6;
    }
    30% {
        transform: translateY(-6px);
        opacity: 1;
    }
}

/* Tweet compose modal */
.tweet-compose-modal {
    backdrop-filter: blur(5px);
}

.tweet-compose-content {
    border: 1px solid rgba(128, 128, 128, 0.2);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
}

.tweet-compose-close:hover {
    background-color: rgba(128, 128, 128, 0.1);
    color: #4d4d4d;
}

/* Theme variations */
body.dark {
    background-color: #000000;
    color: #ffffff;
}

body.dark .logo {
    background: #000;
}

body.dark .sidebar,
body.dark .content {
    border-right-color: #2f3336;
}

body.dark .menu-item {
    color: #ffffff;
}

body.dark .menu-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

body.dim {
    background-color: #15202b;
    color: #f7f9f9;
}

body.dim .logo {
    background: #15202b;
}

body.dim .sidebar,
body.dim .content {
    border-right-color: #38444d;
}

body.dim .menu-item {
    color: #f7f9f9;
}

body.dim .menu-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

/* Responsive styles */
@media (max-width: 1200px) {
    .widgets {
        width: 290px;
    }
}

@media (max-width: 1024px) {
    .widgets {
        width: 250px;
    }
}

@media (max-width: 850px) {
    .sidebar {
        width: 80px;
        padding: 0 8px;
    }
    
    .logo-container {
        display: flex;
        justify-content: center;
        padding: 10px 0;
    }
    
    .logo {
        margin-left: 0;
        width: 42px;
        height: 42px;
    }
    
    .logo::before {
        top: -6px;
        left: -1px;
        right: -18px;
        bottom: -6px;
        border: 6px solid transparent;
    }
    
    .logo::after {
        font-size: 24px;
    }
    
    .menu-item {
        width: 50px;
        height: 50px;
        margin-left: auto;
        margin-right: auto;
        justify-content: center;
        padding: 0;
        display: flex;
        align-items: center;
    }
    
    .menu-item svg {
        margin-right: 0;
    }
    
    .sidebar .menu-item span {
        display: none;
    }
    
    .sidebar .post-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 15px auto;
    }
    
    .sidebar .post-btn::after {
        content: "+";
        font-size: 24px;
    }
    
    .sidebar .post-btn span {
        display: none;
    }
    
    .content {
        flex-grow: 1;
    }
    
    .widgets {
        width: 220px;
    }
}

@media (max-width: 700px) {
    .widgets {
        width: 0;
        opacity: 0;
        overflow: hidden;
    }
}

@media (max-width: 500px) {
    .sidebar {
        width: 60px;
        padding: 0 5px;
    }
    
    .menu-item {
        width: 45px;
        height: 45px;
    }
    
    .menu-item svg {
        width: 22px;
        height: 22px;
    }
    
    .sidebar .post-btn {
        width: 45px;
        height: 45px;
    }
    
    .logo {
        width: 36px;
        height: 36px;
    }
    
    .logo::before {
        top: -5px;
        left: -1px;
        right: -16px;
        bottom: -5px;
        border: 5px solid transparent;
    }
    
    .logo::after {
        font-size: 20px;
    }
    
    .loader {
        width: 60px;
        height: 16px;
    }
    
    .loader-dot {
        width: 6px;
        height: 6px;
        margin: 0 3px;
    }
}

@media (max-width: 350px) {
    .sidebar {
        width: 50px;
        padding: 0 2px;
    }
    
    .menu-item {
        width: 40px;
        height: 40px;
    }
    
    .menu-item svg {
        width: 20px;
        height: 20px;
    }
    
    .sidebar .post-btn {
        width: 40px;
        height: 40px;
    }
    
    .logo {
        width: 32px;
        height: 32px;
    }
    
    .logo::before {
        top: -4px;
        left: -1px;
        right: -14px;
        bottom: -4px;
        border: 4px solid transparent;
    }
    
    .logo::after {
        font-size: 18px;
    }
}
</style>

</head>
<body>
    <div class="container">
        <!-- Left sidebar (menu) -->
        <div class="sidebar">
            <!-- Logo -->
            <div class="logo-container">
                <div class="logo" id="home-logo">
                    â„’
                </div>
            </div>
            
            <nav class="menu">
                <a href="#" class="menu-item active" data-section="home-section">
                 <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 511 511.832"><path fill-rule="nonzero" d="M43.084 468.748h116.942V364.721c0-25.882 10.609-49.45 27.679-66.528l.082-.081c17.077-17.07 40.645-27.679 66.527-27.679 25.844 0 49.412 10.617 66.519 27.687l.082.081c17.092 17.151 27.686 40.697 27.686 66.52v104.027h119.315V253.009L255.846 51.151 43.084 253.768v214.98zm138.484 43.084H29.337c-8.09 0-15.428-3.3-20.732-8.605C3.3 497.923 0 490.585 0 482.495V244.611c.059-5.681 2.298-11.346 6.733-15.568L241.038 5.915c8.236-7.846 21.284-7.927 29.616 0l232.514 221.323c4.782 3.957 7.832 9.931 7.832 16.614v238.643c0 7.964-3.316 15.391-8.642 20.717-5.253 5.253-12.591 8.62-20.695 8.62H327.059c-11.891 0-21.542-9.651-21.542-21.542V364.721c0-14.109-5.739-26.913-14.978-36.145l-.081-.081c-9.231-9.238-22.036-14.978-36.144-14.978-14.087 0-26.913 5.762-36.189 15.015-9.253 9.276-15.014 22.102-15.014 36.189V490.29c0 11.891-9.652 21.542-21.543 21.542z"/></svg>
                    <span>home</span>
                </a>
                <a href="#" class="menu-item" data-section="explore-section"><?xml version="1.0" encoding="utf-8"?><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 122.88 122.88" style="enable-background:new 0 0 122.88 122.88" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M61.44,0c33.93,0,61.44,27.51,61.44,61.44s-27.51,61.44-61.44,61.44S0,95.37,0,61.44S27.51,0,61.44,0L61.44,0z M83.31,65.24c3.13-2.02,3.12-4.27,0-6.06L50.98,40.6c-2.55-1.6-5.21-0.66-5.14,2.67l0.1,37.55c0.22,3.61,2.28,4.6,5.32,2.93 L83.31,65.24L83.31,65.24z M61.44,12.48c27.04,0,48.96,21.92,48.96,48.96c0,27.04-21.92,48.96-48.96,48.96S12.48,88.48,12.48,61.44 C12.48,34.4,34.4,12.48,61.44,12.48L61.44,12.48z"/></g></svg>

                    <span>updates</span>
                </a>
                <a href="#" class="menu-item" data-section="notifications-section">
                    <?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 329.799" fill="currentColor">
  <path fill-rule="nonzero" d="M63.64 0h256.865c34.817 0 63.641 28.993 63.641 63.772v2.937l109.278-48.398c6.684-2.941 14.494.095 17.436 6.778a13.198 13.198 0 011.123 5.329l.017 268.98c0 7.315-5.932 13.247-13.247 13.247-2.305 0-4.47-.591-6.357-1.623l-108.25-50.035v5.04c0 34.59-29.018 63.772-63.641 63.772H63.64c-34.821 0-63.64-28.98-63.64-63.772V63.772C0 28.794 28.629 0 63.64 0zm321.431 95.235v137.057l100.435 46.42V50.753L385.071 95.235zm-64.566-68.741H63.64c-20.562 0-37.41 16.679-37.41 37.278v202.255c0 20.417 17.03 37.279 37.41 37.279h256.865c20.187 0 37.411-17.064 37.411-37.279V63.772c0-20.409-17.034-37.278-37.411-37.278z" />
</svg>
                    <span>facetime call</span>
                </a>
                <a href="#" class="menu-item" data-section="messages-section">
                    <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 122.97 122.88"><title>instagram-comment</title><path d="M61.44,0a61.46,61.46,0,0,1,54.91,89l6.44,25.74a5.83,5.83,0,0,1-7.25,7L91.62,115A61.43,61.43,0,1,1,61.44,0ZM96.63,26.25a49.78,49.78,0,1,0-9,77.52A5.83,5.83,0,0,1,92.4,103L109,107.77l-4.5-18a5.86,5.86,0,0,1,.51-4.34,49.06,49.06,0,0,0,4.62-11.58,50,50,0,0,0-13-47.62Z"/></svg>
                    <span>users</span>
                </a>
                <a href="#" class="menu-item" data-section="bookmarks-section">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M4 4.5C4 3.12 5.119 2 6.5 2h11C18.881 2 20 3.12 20 4.5v18.44l-8-5.71-8 5.71V4.5zM6.5 4c-.276 0-.5.22-.5.5v14.56l6-4.29 6 4.29V4.5c0-.28-.224-.5-.5-.5h-11z"></path>
                    </svg>
                    <span>Bookmarks</span>
                </a>
                <a href="#" class="menu-item" data-section="profile-section">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M5.651 19h12.698c-.337-1.8-1.023-3.21-1.945-4.19C15.318 13.65 13.838 13 12 13s-3.317.65-4.404 1.81c-.922.98-1.608 2.39-1.945 4.19zm.486-5.56C7.627 11.85 9.648 11 12 11s4.373.85 5.863 2.44c1.477 1.58 2.366 3.8 2.632 6.46l.11 1.1H3.395l.11-1.1c.266-2.66 1.155-4.88 2.632-6.46zM12 4c-1.105 0-2 .9-2 2s.895 2 2 2 2-.9 2-2-.895-2-2-2zM8 6c0-2.21 1.791-4 4-4s4 1.79 4 4-1.791 4-4 4-4-1.79-4-4z"></path>
                    </svg>
                    <span>Profile</span>
                </a>
            </nav>
            <button class="post-btn">
                <span>more</span>
            </button>
        </div>

        <div class="main-content-wrapper">
            <!-- Middle section (dynamic content) -->
            <div class="content content-section">
                <!-- All sections are preloaded but hidden -->
                <div id="home-section" class="section-container active">
                    <iframe src="globalchat.html" frameborder="0" width="100%" height="100%"></iframe>
                </div>
                <div id="explore-section" class="section-container">
                    <iframe src="search.html" frameborder="0" width="100%" height="100%"></iframe>
                </div>
                <div id="notifications-section" class="section-container">
                    <iframe src="localst.html" frameborder="0" width="100%" height="100%"></iframe>
                </div>
                <div id="messages-section" class="section-container">
                    <iframe src="fed.html" frameborder="0" width="100%" height="100%"></iframe>
                </div>
                <div id="bookmarks-section" class="section-container">
                    <iframe src="bookmarks.html" frameborder="0" width="100%" height="100%"></iframe>
                </div>
                <div id="profile-section" class="section-container">
                    <iframe src="profileview.html" frameborder="0" width="100%" height="100%"></iframe>
                </div>
                
                <!-- New WhatsApp-style loader -->
                <div class="loader" id="content-loader">
                    <div class="loader-dot"></div>
                    <div class="loader-dot"></div>
                    <div class="loader-dot"></div>
                </div>
            </div>

            <!-- Right widgets section -->
            
        </div>
    </div>

    <script>


(function() {
    // Execute when DOM is ready or immediately if already loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeApplication);
    } else {
        initializeApplication();
    }
    
    function initializeApplication() {
        // Core elements cache
        const menuItems = document.querySelectorAll('.menu-item');
        const sections = document.querySelectorAll('.section-container');
        const contentLoader = document.getElementById('content-loader');
        const widgetsLoader = document.getElementById('widgets-loader');
        const logo = document.getElementById('home-logo');
        const widgetsFrame = document.getElementById('widgets-frame');
        const content = document.querySelector('.content');
        const widgets = document.querySelector('.widgets');
        
        // Application state
        const state = {
            currentSection: document.querySelector('.section-container.active')?.id || 'home-section',
            loadedSections: {},
            loadedWidgets: {},
            isTransitioning: false
        };
        
        // Section to widget mapping
        const widgetContentMap = {
            'home-section': 'fed.html',
            'explore-section': 'trending.html',
            'notifications-section': 'notifications.html',
            'messages-section': 'suggestions.html',
            'bookmarks-section': 'bookmarks-widget.html',
            'profile-section': 'profile-widget.html'
        };
        
        // PROFILE PRELOADING: Load profile immediately for authentication
        function preloadProfileForAuth() {
            const profileSection = document.getElementById('profile-section');
            const profileFrame = profileSection ? profileSection.querySelector('iframe') : null;
            
            if (profileFrame && profileFrame.src) {
                // Create a hidden clone for fast authentication
                const authFrame = document.createElement('iframe');
                authFrame.src = profileFrame.src;
                authFrame.id = 'auth-frame';
                authFrame.style.position = 'absolute';
                authFrame.style.width = '1px';
                authFrame.style.height = '1px';
                authFrame.style.opacity = '0';
                authFrame.style.pointerEvents = 'none';
                authFrame.style.visibility = 'hidden';
                
                // Add to DOM immediately
                document.body.appendChild(authFrame);
                
                // Mark as loaded
                state.loadedSections['profile-section'] = true;
                
                console.log("Profile authentication preloaded for faster chat operation");
            }
        }
        
        // Initialize only the visible section at startup
        if (state.currentSection) {
            state.loadedSections[state.currentSection] = true;
            
            // Get corresponding widget for current section
            const widgetSrc = widgetContentMap[state.currentSection];
            if (widgetSrc) {
                state.loadedWidgets[widgetSrc] = true;
            }
        }
        
        // Load an iframe's content with advanced error handling
        function loadFrameContent(iframe, isWidget, callback) {
            if (!iframe || !iframe.src) return;
            
            const loader = isWidget ? widgetsLoader : contentLoader;
            loader.style.display = 'flex';
            
            // Track loading state
            let isLoaded = false;
            
            // Handle successful load
            function handleLoadSuccess() {
                if (isLoaded) return; // Prevent duplicate executions
                isLoaded = true;
                
                try {
                    // Apply scrollbar styles to iframe content
                    const doc = iframe.contentDocument || iframe.contentWindow.document;
                    const style = doc.createElement('style');
                    style.textContent = `
                        ::-webkit-scrollbar { display: none !important; }
                        * { scrollbar-width: none !important; -ms-overflow-style: none !important; }
                        html, body { overflow-x: hidden !important; }
                    `;
                    doc.head.appendChild(style);
                } catch (e) {
                    // Silent fail for cross-origin frames
                    console.debug('Cannot access iframe content due to same-origin policy');
                }
                
                // Hide loader with transition
                setTimeout(() => {
                    loader.style.opacity = '0';
                    setTimeout(() => {
                        loader.style.display = 'none';
                        loader.style.opacity = '1';
                    }, 150);
                }, 100);
                
                // Clean up event listeners
                cleanupListeners();
                
                // Execute callback if provided
                if (typeof callback === 'function') callback(true);
            }
            
            // Handle load failure
            function handleLoadError() {
                if (isLoaded) return;
                isLoaded = true;
                
                console.warn(`Failed to load iframe content: ${iframe.src}`);
                loader.style.display = 'none';
                
                // Clean up event listeners
                cleanupListeners();
                
                // Execute callback with error status
                if (typeof callback === 'function') callback(false);
            }
            
            // Clean up event listeners
            function cleanupListeners() {
                iframe.removeEventListener('load', handleLoadSuccess);
                iframe.removeEventListener('error', handleLoadError);
                clearTimeout(timeoutId);
            }
            
            // Set up loading timeout (8 seconds)
            const timeoutId = setTimeout(() => {
                if (!isLoaded) {
                    console.warn(`Iframe load timeout: ${iframe.src}`);
                    loader.style.display = 'none';
                    cleanupListeners();
                    
                    // Execute callback with timeout status
                    if (typeof callback === 'function') callback(false);
                }
            }, 8000);
            
            // Check if iframe is already loaded
            if (iframe.contentDocument && iframe.contentDocument.readyState === 'complete') {
                handleLoadSuccess();
            } else {
                // Set up event handlers
                iframe.addEventListener('load', handleLoadSuccess);
                iframe.addEventListener('error', handleLoadError);
            }
        }
        
        // Handle responsive layout based on screen width
        function adjustResponsiveLayout() {
            const width = window.innerWidth;
            
            if (width <= 700) {
                widgets.style.width = '0';
                widgets.style.opacity = '0';
            } else if (width <= 850) {
                widgets.style.width = '220px';
                widgets.style.opacity = '1';
            } else if (width <= 1024) {
                widgets.style.width = '250px';
                widgets.style.opacity = '1';
            } else if (width <= 1200) {
                widgets.style.width = '290px';
                widgets.style.opacity = '1';
            } else {
                widgets.style.width = '350px';
                widgets.style.opacity = '1';
            }
        }
        
        // Switch to a section with lazy loading and transition effects
        function switchToSection(sectionId) {
            // Prevent switching to the same section or during transitions
            if (state.currentSection === sectionId || state.isTransitioning) {
                return;
            }
            
            // Set transitioning state to prevent rapid clicking
            state.isTransitioning = true;
            
            // Show appropriate loader
            contentLoader.style.display = 'flex';
            
            // Update UI: remove active class from all sections and menu items
            sections.forEach(section => section.classList.remove('active'));
            menuItems.forEach(item => item.classList.remove('active'));
            
            // Update active menu item
            const activeMenuItem = document.querySelector(`.menu-item[data-section="${sectionId}"]`);
            if (activeMenuItem) {
                activeMenuItem.classList.add('active');
            }
            
            // Get target section
            const targetSection = document.getElementById(sectionId);
            if (!targetSection) {
                console.error(`Section not found: ${sectionId}`);
                state.isTransitioning = false;
                contentLoader.style.display = 'none';
                return;
            }
            
            // Update state
            state.currentSection = sectionId;
            
            // Load section content if not already loaded
            if (!state.loadedSections[sectionId]) {
                const iframe = targetSection.querySelector('iframe');
                
                // Mark as loaded before actual loading to prevent duplicate loads
                state.loadedSections[sectionId] = true;
                
                // Load the iframe content
                loadFrameContent(iframe, false, (success) => {
                    if (!success) {
                        console.error(`Failed to load section: ${sectionId}`);
                    }
                    
                    // Activate section after a short delay for smoother transition
                    setTimeout(() => {
                        targetSection.classList.add('active');
                        state.isTransitioning = false;
                    }, 100);
                });
            } else {
                // Content already loaded, just show the section
                contentLoader.style.display = 'none';
                targetSection.classList.add('active');
                
                // End transition state after animation completes
                setTimeout(() => {
                    state.isTransitioning = false;
                }, 300);
            }
            
            // Handle widget content
            updateWidgetForSection(sectionId);
        }
        
        // Update widget content based on current section
        function updateWidgetForSection(sectionId) {
            const widgetSrc = widgetContentMap[sectionId];
            if (!widgetSrc) return;
            
            widgetsLoader.style.display = 'flex';
            
            // Check if this widget has been loaded before
            if (!state.loadedWidgets[widgetSrc]) {
                // First time loading this widget
                state.loadedWidgets[widgetSrc] = true;
                widgetsFrame.src = widgetSrc;
                
                loadFrameContent(widgetsFrame, true, (success) => {
                    if (!success) {
                        console.warn(`Failed to load widget: ${widgetSrc}`);
                    }
                });
            } else {
                // Widget was loaded before, just switch to it
                if (widgetsFrame.src.indexOf(widgetSrc) === -1) {
                    widgetsFrame.src = widgetSrc;
                }
                
                // Hide loader after a short delay for smoother transition
                setTimeout(() => {
                    widgetsLoader.style.display = 'none';
                }, 250);
            }
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Menu item click handling
            menuItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = item.getAttribute('data-section');
                    
                    // Use requestAnimationFrame for smoother UI updates
                    requestAnimationFrame(() => {
                        switchToSection(sectionId);
                    });
                });
            });
            
            // Logo click returns to home
            logo.addEventListener('click', () => {
                switchToSection('home-section');
            });
            
            // Optimize window resize handling with debounce
            let resizeTimer;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(adjustResponsiveLayout, 100);
            }, { passive: true });
            
            // Handle browser back/forward buttons
            window.addEventListener('popstate', (e) => {
                if (e.state && e.state.section) {
                    switchToSection(e.state.section);
                }
            });
            
            // Post button handling
            const postBtn = document.querySelector('.post-btn');
            if (postBtn) {
                postBtn.addEventListener('click', () => {
                    // Handle post button click (e.g., open compose modal)
                    console.log('Post button clicked');
                    // Implementation would go here
                });
            }
        }
        
        // Add optimized global styling
        function injectPerformanceStyles() {
            const style = document.createElement('style');
            style.textContent = `
                /* Optimize transitions */
                .section-container {
                    transition: opacity 0.25s ease;
                    will-change: opacity;
                }
                .section-container:not(.active) {
                    opacity: 0;
                    pointer-events: none;
                    visibility: hidden;
                    position: absolute;
                }
                .section-container.active {
                    opacity: 1;
                    visibility: visible;
                    position: relative;
                }
                
                /* Loader animations */
                .loader {
                    z-index: 100;
                    transition: opacity 0.15s ease;
                }
                
                /* Performance optimizations */
                .menu-item, .post-btn, .logo {
                    will-change: transform, background-color;
                    transform: translateZ(0);
                }
                
                /* Prevent layout shifts */
                .content, .widgets {
                    contain: layout style;
                }
                
                /* Hidden auth frame */
                #auth-frame {
                    position: absolute;
                    top: -9999px;
                    left: -9999px;
                    width: 1px;
                    height: 1px;
                    opacity: 0;
                    pointer-events: none;
                    z-index: -999;
                }
            `;
            document.head.appendChild(style);
        }
        
        // Initialize application
        function initializeApp() {
            // Set up UI optimizations
            injectPerformanceStyles();
            
            // CRITICAL: Preload profile authentication immediately
            preloadProfileForAuth();
            
            // Set up event handling
            setupEventListeners();
            
            // Set initial responsive layout
            adjustResponsiveLayout();
            
            // Remove any lingering loaders on page load
            window.addEventListener('load', () => {
                setTimeout(() => {
                    contentLoader.style.display = 'none';
                    widgetsLoader.style.display = 'none';
                }, 500);
            });
            
            // Initialize history state
            if (history.state === null) {
                history.replaceState({ section: state.currentSection }, '');
            }
            
            console.log('Application initialized successfully');
        }
        
        // Start the application
        initializeApp();
    }
})();

    </script>




<script>

(function() {
  // Wait for DOM to be fully loaded before executing
  document.addEventListener('DOMContentLoaded', function() {
    // Use a unique identifier for this functionality
    const postMenuManager = {
      init: function() {
        // Retrieve the post button from the sidebar
        const postBtn = document.querySelector('.post-btn');
        if (!postBtn) return;
        
        this.postBtn = postBtn;
        this.optionsVisible = false;
        this.createOptionsContainer();
        this.createModals();
        this.setupEventListeners();
        this.updateThemeVariables();
      },
      
      createOptionsContainer: function() {
        // Create the container for the option buttons
        const optionsContainer = document.createElement('div');
        optionsContainer.className = 'neural-post-options-container';
        optionsContainer.style.cssText = `
          position: absolute;
          background: var(--options-bg, #fff);
          border: 1px solid var(--options-border, rgba(0, 0, 0, 0.1));
          border-radius: 16px;
          box-shadow: 0 4px 12px var(--options-shadow, rgba(0, 0, 0, 0.15));
          overflow: hidden;
          opacity: 0;
          transform: translateY(10px);
          visibility: hidden;
          transition: all 0.2s cubic-bezier(0.2, 0, 0.2, 1);
          z-index: 100;
          display: flex;
          flex-direction: column;
        `;
        
        // Create "Post" option
        const postOption = document.createElement('button');
        postOption.className = 'neural-post-option neural-post-btn-option';
        postOption.style.cssText = `
          padding: 16px;
          display: flex;
          align-items: center;
          gap: 12px;
          cursor: pointer;
          background-color: inherit;
          font-weight: 600;
          color: var(--options-text, #0f1419);
          border: none;
          transition: background 0.2s ease;
          font-size: 15px;
        `;
        postOption.innerHTML = `
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M23 3c-6.62-.1-10.38 2.421-13 5.76C7.38 5.42 3.62 2.9 0 3v2c3.62-.1 7.38 2.1 10 4.76C12.62 7.1 16.38 4.9 20 5v2c-3.62.1-7.38 2.1-10 4.76c-2.62-2.66-6.38-4.86-10-4.76v2c3.62-.1 7.38 2.1 10 4.76c-2.62 2.66-6.38 4.86-10 4.76v2c6.62-.1 10.38-2.421 13-5.76c2.62 3.34 6.38 5.66 10 5.76v-2c-3.62.1-7.38-2.1-10-4.76c2.62-2.66 6.38-4.86 10-4.76V3z"/>
          </svg>
          <span>Post</span>
        `;
        
        // Create "Appearance" option
        const appearanceOption = document.createElement('button');
        appearanceOption.className = 'neural-post-option neural-appearance-btn-option';
        appearanceOption.style.cssText = `
          padding: 16px;
          display: flex;
          align-items: center;
          gap: 12px;
          cursor: pointer;
          background-color: inherit;
          font-weight: 600;
          color: var(--options-text, #0f1419);
          border: none;
          transition: background 0.2s ease;
          font-size: 15px;
        `;
        appearanceOption.innerHTML = `
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zm0-18c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9L7.1 5.69C8.45 4.63 10.15 4 12 4zM5.69 7.1L16.9 18.31C15.55 19.37 13.85 20 12 20c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9z"/>
          </svg>
          <span>Appearance</span>
        `;
        
        // Append options and add hover effects
        optionsContainer.appendChild(postOption);
        
        // Add divider
        const divider = document.createElement('div');
        divider.style.cssText = `
          height: 1px;
          background: var(--options-divider, rgba(0, 0, 0, 0.1));
          width: 100%;
          margin: 0;
        `;
        optionsContainer.appendChild(divider);
        optionsContainer.appendChild(appearanceOption);
        
        // Add hover effects
        [postOption, appearanceOption].forEach(option => {
          option.addEventListener('mouseenter', () => {
            option.style.backgroundColor = 'var(--options-hover, rgba(0, 0, 0, 0.05))';
          });
          option.addEventListener('mouseleave', () => {
            option.style.backgroundColor = 'inherit';
          });
        });
        
        // Insert the options container into the DOM
        document.body.appendChild(optionsContainer);
        
        // Store references
        this.optionsContainer = optionsContainer;
        this.postOption = postOption;
        this.appearanceOption = appearanceOption;
        
        // Set up click handlers
        postOption.addEventListener('click', (e) => {
          e.stopPropagation();
          this.openPostModal();
        });
        
        appearanceOption.addEventListener('click', (e) => {
          e.stopPropagation();
          this.openAppearanceModal();
        });
      },
      
      updateOptionsPosition: function() {
        const btnRect = this.postBtn.getBoundingClientRect();
        const containerRect = this.optionsContainer.getBoundingClientRect();
        
        // Position above the post button
        this.optionsContainer.style.bottom = `${window.innerHeight - btnRect.top + 5}px`;
        this.optionsContainer.style.left = `${btnRect.left + (btnRect.width/2) - (containerRect.width/2)}px`;
        
        // Make sure it stays within viewport
        const rect = this.optionsContainer.getBoundingClientRect();
        if (rect.left < 10) {
          this.optionsContainer.style.left = '10px';
        } else if (rect.right > window.innerWidth - 10) {
          this.optionsContainer.style.left = `${window.innerWidth - rect.width - 10}px`;
        }
      },
      
      createModals: function() {
        // Create Post Modal
        const postModal = document.createElement('div');
        postModal.className = 'neural-tweet-compose-modal';
        postModal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.4);
          display: none;
          justify-content: flex-end;
          align-items: center;
          z-index: 1000;
          opacity: 0;
          transition: opacity 0.3s ease;
        `;
        
        const postModalContent = document.createElement('div');
        postModalContent.className = 'neural-tweet-compose-content';
        postModalContent.style.cssText = `
          background: var(--modal-bg, #fff);
          border-radius: 16px 0 0 16px;
          width: 600px;
          max-width: 90%;
          height: 100%;
          overflow: hidden;
          position: relative;
          transform: translateX(100%);
          transition: transform 0.3s cubic-bezier(0.2, 0, 0, 1);
          box-shadow: -5px 0 20px rgba(0, 0, 0, 0.15);
          display: flex;
          flex-direction: column;
        `;
        
        const postHeader = this.createModalHeader(() => this.closePostModal());
        const postContentArea = document.createElement('div');
        postContentArea.style.cssText = `
          flex: 1;
          position: relative;
        `;
        
        // Create the three-dot loading animation
        const postLoader = document.createElement('div');
        postLoader.className = 'neural-tweet-compose-loader';
        postLoader.style.cssText = `
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100%;
          padding: 20px;
        `;
        postLoader.innerHTML = `
          <div style="display: flex; gap: 8px;">
            <span class="loading-dot" style="
              width: 10px;
              height: 10px;
              background-color: var(--loader-color, #1d9bf0);
              border-radius: 50%;
              display: inline-block;
              animation: pulse 1.4s infinite ease-in-out;
              animation-delay: 0s;
            "></span>
            <span class="loading-dot" style="
              width: 10px;
              height: 10px;
              background-color: var(--loader-color, #1d9bf0);
              border-radius: 50%;
              display: inline-block;
              animation: pulse 1.4s infinite ease-in-out;
              animation-delay: 0.2s;
            "></span>
            <span class="loading-dot" style="
              width: 10px;
              height: 10px;
              background-color: var(--loader-color, #1d9bf0);
              border-radius: 50%;
              display: inline-block;
              animation: pulse 1.4s infinite ease-in-out;
              animation-delay: 0.4s;
            "></span>
          </div>
        `;
        
        // Add pulse animation
        const styleSheet = document.createElement('style');
        styleSheet.textContent = `
          @keyframes pulse {
            0%, 80%, 100% { 
              transform: scale(0.6);
              opacity: 0.6;
            }
            40% { 
              transform: scale(1);
              opacity: 1;
            }
          }
        `;
        document.head.appendChild(styleSheet);
        
        const postIframeContainer = document.createElement('div');
        postIframeContainer.className = 'neural-tweet-compose-iframe';
        postIframeContainer.style.cssText = `
          width: 100%;
          height: calc(100% - 53px);
          display: none;
          position: relative;
        `;
        
        const postIframe = document.createElement('iframe');
        postIframe.src = 'upload.html';
        postIframe.style.cssText = `
          width: 100%;
          height: 100%;
          border: none;
        `;
        
        postIframeContainer.appendChild(postIframe);
        postContentArea.appendChild(postLoader);
        postContentArea.appendChild(postIframeContainer);
        postModalContent.appendChild(postHeader);
        postModalContent.appendChild(postContentArea);
        postModal.appendChild(postModalContent);
        document.body.appendChild(postModal);
        
        // Create the Appearance Modal
        const appearanceModal = document.createElement('div');
        appearanceModal.className = 'neural-appearance-modal';
        appearanceModal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.4);
          display: none;
          justify-content: center;
          align-items: center;
          z-index: 1000;
          opacity: 0;
          transition: opacity 0.3s ease;
        `;
        
        const appearanceModalContent = document.createElement('div');
        appearanceModalContent.className = 'neural-appearance-content';
        appearanceModalContent.style.cssText = `
          background: var(--modal-bg, #fff);
          border-radius: 16px;
          width: 600px;
          max-width: 90%;
          max-height: 90vh;
          overflow: hidden;
          position: relative;
          transform: translateY(20px);
          transition: transform 0.3s cubic-bezier(0.2, 0, 0, 1);
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
          display: flex;
          flex-direction: column;
        `;
        
        const appearanceHeader = this.createModalHeader(() => this.closeAppearanceModal());
        const appearanceContentArea = document.createElement('div');
        appearanceContentArea.style.cssText = `
          flex: 1;
          position: relative;
        `;
        
        // Create the three-dot loading animation
        const appearanceLoader = document.createElement('div');
        appearanceLoader.className = 'neural-appearance-loader';
        appearanceLoader.style.cssText = `
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100%;
          padding: 20px;
        `;
        appearanceLoader.innerHTML = `
          <div style="display: flex; gap: 8px;">
            <span class="loading-dot" style="
              width: 10px;
              height: 10px;
              background-color: var(--loader-color, #1d9bf0);
              border-radius: 50%;
              display: inline-block;
              animation: pulse 1.4s infinite ease-in-out;
              animation-delay: 0s;
            "></span>
            <span class="loading-dot" style="
              width: 10px;
              height: 10px;
              background-color: var(--loader-color, #1d9bf0);
              border-radius: 50%;
              display: inline-block;
              animation: pulse 1.4s infinite ease-in-out;
              animation-delay: 0.2s;
            "></span>
            <span class="loading-dot" style="
              width: 10px;
              height: 10px;
              background-color: var(--loader-color, #1d9bf0);
              border-radius: 50%;
              display: inline-block;
              animation: pulse 1.4s infinite ease-in-out;
              animation-delay: 0.4s;
            "></span>
          </div>
        `;
        
        const appearanceIframeContainer = document.createElement('div');
        appearanceIframeContainer.className = 'neural-appearance-iframe';
        appearanceIframeContainer.style.cssText = `
          width: 100%;
          height: 500px;
          display: none;
          position: relative;
        `;
        
        const appearanceIframe = document.createElement('iframe');
        appearanceIframe.src = 'chats.html';
        appearanceIframe.style.cssText = `
          width: 100%;
          height: 100%;
          border: none;
        `;
        
        appearanceIframeContainer.appendChild(appearanceIframe);
        appearanceContentArea.appendChild(appearanceLoader);
        appearanceContentArea.appendChild(appearanceIframeContainer);
        appearanceModalContent.appendChild(appearanceHeader);
        appearanceModalContent.appendChild(appearanceContentArea);
        appearanceModal.appendChild(appearanceModalContent);
        document.body.appendChild(appearanceModal);
        
        // Store references
        this.postModal = postModal;
        this.postModalContent = postModalContent;
        this.postLoader = postLoader;
        this.postIframeContainer = postIframeContainer;
        this.appearanceModal = appearanceModal;
        this.appearanceModalContent = appearanceModalContent;
        this.appearanceLoader = appearanceLoader;
        this.appearanceIframeContainer = appearanceIframeContainer;
        
        // Set up modal click handlers
        postModal.addEventListener('click', (e) => {
          if (e.target === postModal) this.closePostModal();
        });
        
        appearanceModal.addEventListener('click', (e) => {
          if (e.target === appearanceModal) this.closeAppearanceModal();
        });
      },
      
      createModalHeader: function(closeCallback) {
        const header = document.createElement('div');
        header.style.cssText = `
          width: 100%;
          height: 53px;
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 0 16px;
          border-bottom: 1px solid var(--modal-border, rgba(0, 0, 0, 0.1));
          background: var(--modal-header-bg, #fff);
        `;
        
        const closeBtn = document.createElement('button');
        closeBtn.innerHTML = `
          <svg width="24" height="24" viewBox="0 0 24 24" fill="var(--modal-close, #536471)">
            <path d="M10.59 12L4.54 5.96l1.42-1.42L12 10.59l6.04-6.05 1.42 1.42L13.41 12l6.05 6.04-1.42 1.42L12 13.41l-6.04 6.05-1.42-1.42L10.59 12z"/>
          </svg>
        `;
        closeBtn.style.cssText = `
          background: transparent;
          border: none;
          cursor: pointer;
          padding: 8px;
          border-radius: 50%;
          transition: background 0.2s ease;
        `;
        closeBtn.addEventListener('mouseenter', () => {
          closeBtn.style.backgroundColor = 'var(--modal-close-hover, rgba(0, 0, 0, 0.05))';
        });
        closeBtn.addEventListener('mouseleave', () => {
          closeBtn.style.backgroundColor = 'transparent';
        });
        closeBtn.addEventListener('click', closeCallback);
        header.appendChild(closeBtn);
        
        return header;
      },
      
      toggleOptions: function() {
        this.updateOptionsPosition();
        
        if (this.optionsVisible) {
          // Close animation
          this.optionsContainer.style.opacity = '0';
          this.optionsContainer.style.transform = 'translateY(10px)';
          setTimeout(() => {
            this.optionsContainer.style.visibility = 'hidden';
          }, 200);
        } else {
          // Show container and update position
          this.optionsContainer.style.visibility = 'visible';
          
          // Force layout recalculation to get accurate dimensions
          void this.optionsContainer.offsetWidth;
          
          // Update position again now that it's visible and has dimensions
          this.updateOptionsPosition();
          
          // Open animation
          this.optionsContainer.style.opacity = '1'; 
          this.optionsContainer.style.transform = 'translateY(0)';
        }
        
        this.optionsVisible = !this.optionsVisible;
      },
      
      openPostModal: function() {
        document.body.style.overflow = 'hidden';
        this.postModal.style.display = 'flex';
        void this.postModal.offsetWidth; // Force reflow
        this.postModal.style.opacity = '1';
        this.postModalContent.style.transform = 'translateX(0)';
        
        // Show loader initially
        this.postLoader.style.display = 'flex';
        this.postIframeContainer.style.display = 'none';
        
        // Hide options
        this.optionsContainer.style.opacity = '0';
        this.optionsContainer.style.visibility = 'hidden';
        this.optionsContainer.style.transform = 'translateY(10px)';
        this.optionsVisible = false;
        
        // Simulate loading (in real app, this would be when iframe loads)
        setTimeout(() => {
          this.postLoader.style.display = 'none';
          this.postIframeContainer.style.display = 'block';
        }, 1500);
      },
      
      closePostModal: function() {
        this.postModal.style.opacity = '0';
        this.postModalContent.style.transform = 'translateX(100%)';
        setTimeout(() => {
          this.postModal.style.display = 'none';
          document.body.style.overflow = '';
          
          // Reset for next open
          this.postLoader.style.display = 'flex';
          this.postIframeContainer.style.display = 'none';
        }, 300);
      },
      
      openAppearanceModal: function() {
        document.body.style.overflow = 'hidden';
        this.appearanceModal.style.display = 'flex';
        void this.appearanceModal.offsetWidth; // Force reflow
        this.appearanceModal.style.opacity = '1';
        this.appearanceModalContent.style.transform = 'translateY(0)';
        
        // Show loader initially
        this.appearanceLoader.style.display = 'flex';
        this.appearanceIframeContainer.style.display = 'none';
        
        // Hide options
        this.optionsContainer.style.opacity = '0';
        this.optionsContainer.style.visibility = 'hidden';
        this.optionsContainer.style.transform = 'translateY(10px)';
        this.optionsVisible = false;
        
        // Simulate loading (in real app, this would be when iframe loads)
        setTimeout(() => {
          this.appearanceLoader.style.display = 'none';
          this.appearanceIframeContainer.style.display = 'block';
        }, 1500);
      },
      
      closeAppearanceModal: function() {
        this.appearanceModal.style.opacity = '0';
        this.appearanceModalContent.style.transform = 'translateY(20px)';
        setTimeout(() => {
          this.appearanceModal.style.display = 'none';
          document.body.style.overflow = '';
          
          // Reset for next open
          this.appearanceLoader.style.display = 'flex';
          this.appearanceIframeContainer.style.display = 'none';
        }, 300);
      },
      
      setupEventListeners: function() {
        // Toggle options on post button click
        this.postBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          this.toggleOptions();
        });
        
        // Close options when clicking outside
        document.addEventListener('click', (e) => {
          if (this.optionsVisible && 
              !this.optionsContainer.contains(e.target) && 
              e.target !== this.postBtn) {
            this.optionsContainer.style.opacity = '0';
            this.optionsContainer.style.visibility = 'hidden';
            this.optionsContainer.style.transform = 'translateY(10px)';
            this.optionsVisible = false;
          }
        });
        
        // Close any open modals/options on Escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            if (this.postModal.style.display === 'flex') this.closePostModal();
            if (this.appearanceModal.style.display === 'flex') this.closeAppearanceModal();
            if (this.optionsVisible) {
              this.optionsContainer.style.opacity = '0';
              this.optionsContainer.style.visibility = 'hidden';
              this.optionsContainer.style.transform = 'translateY(10px)';
              this.optionsVisible = false;
            }
          }
        });
        
        // Update positioning on resize
        window.addEventListener('resize', () => {
          if (this.optionsVisible) {
            this.updateOptionsPosition();
          }
        });
        
        // Watch for theme changes
        const observer = new MutationObserver((mutations) => {
          mutations.forEach((mutation) => {
            if (mutation.attributeName === 'class') {
              this.updateThemeVariables();
            }
          });
        });
        
        observer.observe(document.body, {
          attributes: true,
          attributeFilter: ['class']
        });
      },
      
      updateThemeVariables: function() {
        const isDark = document.body.classList.contains('dark');
        const isDim = document.body.classList.contains('dim');
        
        if (isDark) {
          // Dark theme variables
          document.documentElement.style.setProperty('--options-bg', '#000');
          document.documentElement.style.setProperty('--options-border', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--options-shadow', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--options-text', '#fff');
          document.documentElement.style.setProperty('--options-hover', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--options-divider', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--modal-bg', '#000');
          document.documentElement.style.setProperty('--modal-border', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--modal-header-bg', '#000');
          document.documentElement.style.setProperty('--modal-close', '#71767b');
          document.documentElement.style.setProperty('--modal-close-hover', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--loader-color', '#1d9bf0');
        } else if (isDim) {
          // Dim theme variables
          document.documentElement.style.setProperty('--options-bg', '#15202b');
          document.documentElement.style.setProperty('--options-border', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--options-shadow', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--options-text', '#f7f9f9');
          document.documentElement.style.setProperty('--options-hover', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--options-divider', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--modal-bg', '#15202b');
          document.documentElement.style.setProperty('--modal-border', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--modal-header-bg', '#15202b');
          document.documentElement.style.setProperty('--modal-close', '#8b98a5');
          document.documentElement.style.setProperty('--modal-close-hover', 'rgba(255, 255, 255, 0.1)');
          document.documentElement.style.setProperty('--loader-color', '#1d9bf0');
        } else {
          // Light theme variables (default)
          document.documentElement.style.setProperty('--options-bg', '#fff');
          document.documentElement.style.setProperty('--options-border', 'rgba(0, 0, 0, 0.1)');
          document.documentElement.style.setProperty('--options-shadow', 'rgba(0, 0, 0, 0.15)');
          document.documentElement.style.setProperty('--options-text', '#0f1419');
          document.documentElement.style.setProperty('--options-hover', 'rgba(0, 0, 0, 0.05)');
          document.documentElement.style.setProperty('--options-divider', 'rgba(0, 0, 0, 0.1)');
          document.documentElement.style.setProperty('--modal-bg', '#fff');
          document.documentElement.style.setProperty('--modal-border', 'rgba(0, 0, 0, 0.1)');
          document.documentElement.style.setProperty('--modal-header-bg', '#fff');
          document.documentElement.style.setProperty('--modal-close', '#536471');
          document.documentElement.style.setProperty('--modal-close-hover', 'rgba(0, 0, 0, 0.05)');
          document.documentElement.style.setProperty('--loader-color', '#1d9bf0');
        }
      }
    };
    
    // Initialize the post menu manager
    postMenuManager.init();
  });
})();

</script>




<script>
  // Font size synchronization script
  (function() {
    // Function to apply font size from localStorage
    function applyFontSize() {
      const size = localStorage.getItem('font-size') || '1';
      document.body.style.fontSize = size + 'rem';
      
      // Add scaling to different elements if needed
      const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
      const paragraphs = document.querySelectorAll('p');
      const buttons = document.querySelectorAll('button');
      const inputs = document.querySelectorAll('input');
      
      headings.forEach(heading => {
        const currentSize = window.getComputedStyle(heading).fontSize;
        const baseSize = parseFloat(currentSize) / 16; // convert to rem
        heading.style.fontSize = (baseSize * parseFloat(size)) + 'rem';
      });
      
      paragraphs.forEach(p => {
        p.style.fontSize = size + 'rem';
      });
      
      buttons.forEach(button => {
        button.style.fontSize = (parseFloat(size) * 0.9) + 'rem';
      });
      
      inputs.forEach(input => {
        input.style.fontSize = size + 'rem';
      });
    }
    
    // Apply immediately
    applyFontSize();
    
    // Listen for changes
    window.addEventListener('storage', function(event) {
      if (event.key === 'font-size') {
        applyFontSize();
      }
    });
    
    // Check every second for changes (backup method)
    setInterval(function() {
      const currentSize = document.body.style.fontSize;
      const savedSize = localStorage.getItem('font-size') || '1';
      
      if (currentSize !== savedSize + 'rem') {
        applyFontSize();
      }
    }, 1000);
  })();
</script>
<script>
  (function() {
  // Wait for DOM to be fully loaded
  document.addEventListener('DOMContentLoaded', function() {
    // Get the logo element
    const logo = document.getElementById('home-logo');
    if (!logo) return;
    
    // Variables to track drag state
    let isDragging = false;
    let startX, startY;
    
    // Function to handle navigation
    function navigateToHome() {
      if (!isDragging) { // Only navigate if not dragging
        window.location.href = 'half.html';
      }
    }
    
    // Click handler
    logo.addEventListener('click', navigateToHome);
    
    // Touch start handler
    logo.addEventListener('touchstart', function(e) {
      isDragging = false;
      startX = e.touches[0].clientX;
      startY = e.touches[0].clientY;
    }, { passive: true });
    
    // Touch move handler - detect if dragging
    logo.addEventListener('touchmove', function(e) {
      if (!startX || !startY) return;
      
      const diffX = Math.abs(e.touches[0].clientX - startX);
      const diffY = Math.abs(e.touches[0].clientY - startY);
      
      // Consider it dragging if moved more than 10px in any direction
      if (diffX > 10 || diffY > 10) {
        isDragging = true;
      }
    }, { passive: true });
    
    // Touch end handler
    logo.addEventListener('touchend', function(e) {
      if (!isDragging) {
        navigateToHome();
      }
      isDragging = false;
      startX = startY = null;
    }, { passive: true });
    
    // Mouse down handler
    logo.addEventListener('mousedown', function(e) {
      isDragging = false;
      startX = e.clientX;
      startY = e.clientY;
    });
    
    // Mouse move handler - detect if dragging
    logo.addEventListener('mousemove', function(e) {
      if (!startX || !startY) return;
      
      const diffX = Math.abs(e.clientX - startX);
      const diffY = Math.abs(e.clientY - startY);
      
      // Consider it dragging if moved more than 5px in any direction
      if (diffX > 5 || diffY > 5) {
        isDragging = true;
      }
    });
    
    // Mouse up handler
    logo.addEventListener('mouseup', function(e) {
      if (!isDragging) {
        navigateToHome();
      }
      isDragging = false;
      startX = startY = null;
    });
    
    // Make logo draggable as a link
    logo.setAttribute('draggable', 'true');
    
    // Drag start handler - create a drag image with the URL
    logo.addEventListener('dragstart', function(e) {
      const fullUrl = window.location.origin + '/half.html';
      e.dataTransfer.setData('text/uri-list', fullUrl);
      e.dataTransfer.setData('text/plain', fullUrl);
      
      // Create a drag image (optional)
      const dragImg = new Image();
      dragImg.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 48 48"><circle cx="24" cy="24" r="24" fill="%235A9BD5"/><text x="24" y="32" font-family="Arial" font-size="24" text-anchor="middle" fill="white">N</text></svg>';
      e.dataTransfer.setDragImage(dragImg, 0, 0);
    });
    
    // Prevent conflict with other drag operations
    logo.addEventListener('dragend', function() {
      isDragging = false;
    });
  });
})();
</script>
<script>
  (function() {
    // RelHalf Theme Integration - Final Version
    const RelHalfThemeIntegrator = {
      // Style element ID
      styleElementId: 'relhalf-theme-integrator-styles',
      
      // Initialize integration
      initialize: function() {
        this.createStyleElement();
        this.applyCurrentTheme();
        this.setupEventListeners();
        console.log('RelHalf Theme Integrator initialized');
      },
      
      // Create dedicated style element
      createStyleElement: function() {
        const existingStyle = document.getElementById(this.styleElementId);
        if (existingStyle) {
          existingStyle.remove();
        }
        
        const styleElement = document.createElement('style');
        styleElement.id = this.styleElementId;
        styleElement.setAttribute('data-origin', 'relhalf-theme-integrator');
        document.head.appendChild(styleElement);
      },
      
      // Apply current theme from localStorage
      applyCurrentTheme: function() {
        const themeName = localStorage.getItem('twitter-theme') || 'light';
        this.applyTheme(themeName);
      },
      
      // Apply specified theme with careful logo handling
      applyTheme: function(themeName) {
        // Default to light theme if invalid theme name
        const validThemes = ['light', 'dim', 'dark'];
        const theme = validThemes.includes(themeName) ? themeName : 'light';
        
        // Get style element
        const styleElement = document.getElementById(this.styleElementId);
        if (!styleElement) {
          this.createStyleElement();
          return this.applyTheme(theme); // Retry after creating style element
        }
        
        // Theme-specific CSS with careful logo handling
        const themeCSS = {
          light: `
            /* Light theme - original styling */
            body { background-color: #ffffff; color: #0f1419; }
            .sidebar { border-right-color: #eff3f4; }
            .content { border-right-color: #eff3f4; }
            .menu-item { color: #0f1419; }
            .menu-item:hover { background-color: rgba(128, 128, 128, 0.1); }
            .menu-item.active { color: #4d4d4d; font-weight: 700; }
            
            /* Original black post button */
            .post-btn { 
              background: linear-gradient(135deg, #0f0f0f 0%, #1c1c1c 15%, #3a3a3a 30%, #4d4d4d 45%, #626262 60%, #787878 75%, #8f8f8f 90%, #a6a6a6 100%);
              color: white;
            }
            
            /* Ensure SVGs stay visible */
            .menu-item svg,
            .menu-item.active svg {
              color: currentColor;
              fill: currentColor;
            }
          `,
          dim: `
            /* Dim theme - modified for visibility */
            body { background-color: #15202b; color: #f7f9f9; }
            .sidebar { border-right-color: #38444d; }
            .content { border-right-color: #38444d; }
            .menu-item { color: #f7f9f9; }
            .menu-item:hover { background-color: rgba(255, 255, 255, 0.1); }
            .menu-item.active { color: #a6a6a6; font-weight: 700; }
            
            /* White post button for dim theme */
            .post-btn { 
              background: linear-gradient(135deg, #ffffff 0%, #e6e6e6 15%, #cccccc 30%, #b3b3b3 45%, #999999 60%, #808080 75%, #666666 90%, #4d4d4d 100%);
              color: black;
            }
            
            /* White gradient border for logo in dim theme */
            .logo::before {
              background: linear-gradient(135deg, #ffffff 0%, #e6e6e6 15%, #cccccc 30%, #b3b3b3 45%, #999999 60%, #808080 75%, #666666 90%, #4d4d4d 100%) !important;
            }
            
            /* Ensure SVGs stay bright */
            .menu-item svg,
            .menu-item.active svg {
              color: #f7f9f9 !important;
              fill: #f7f9f9 !important;
            }
          `,
          dark: `
            /* Dark theme - modified for visibility */
            body { background-color: #000000; color: #ffffff; }
            .sidebar { border-right-color: #2f3336; }
            .content { border-right-color: #2f3336; }
            .menu-item { color: #ffffff; }
            .menu-item:hover { background-color: rgba(255, 255, 255, 0.1); }
            .menu-item.active { color: #a6a6a6; font-weight: 700; }
            
            /* White post button for dark theme */
            .post-btn { 
              background: linear-gradient(135deg, #ffffff 0%, #e6e6e6 15%, #cccccc 30%, #b3b3b3 45%, #999999 60%, #808080 75%, #666666 90%, #4d4d4d 100%);
              color: black;
            }
            
            /* White gradient border for logo in dark theme */
            .logo::before {
              background: linear-gradient(135deg, #ffffff 0%, #e6e6e6 15%, #cccccc 30%, #b3b3b3 45%, #999999 60%, #808080 75%, #666666 90%, #4d4d4d 100%) !important;
            }
            
            /* Ensure SVGs stay bright */
            .menu-item svg,
            .menu-item.active svg {
              color: #ffffff !important;
              fill: #ffffff !important;
            }
          `
        };
        
        // Set the CSS content
        styleElement.textContent = themeCSS[theme];
        
        // Update body class for theme
        document.body.className = theme;
        
        console.log('RelHalf Theme Integrator: Applied theme', theme);
      },
      
      // Set up event listeners
      setupEventListeners: function() {
        // Listen for localStorage changes (theme)
        window.addEventListener('storage', (e) => {
          if (e.key === 'twitter-theme') {
            this.applyTheme(e.newValue || 'light');
          }
        });
        
        // Listen for custom events from GlobalChatThemeManager
        window.addEventListener('themeChanged', (e) => {
          if (e.detail && e.detail.theme) {
            this.applyTheme(e.detail.theme);
          }
        });
      }
    };
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        RelHalfThemeIntegrator.initialize();
      });
    } else {
      RelHalfThemeIntegrator.initialize();
    }
  })();
</script>
</body>
</html>
